[0m18:14:39.353141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217FAFCF2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217F7326810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217F7239F70>]}


============================== 18:14:39.356226 | 6c18355c-4cd3-4f3e-bc1e-29fa49f602ab ==============================
[0m18:14:39.356226 [info ] [MainThread]: Running with dbt=1.8.8
[0m18:14:39.357176 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\alvaro\\Desktop\\sumup_assignment\\merchant_data_project\\logs', 'profiles_dir': 'C:\\Users\\alvaro\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:14:39.371271 [info ] [MainThread]: dbt version: 1.8.8
[0m18:14:39.372143 [info ] [MainThread]: python version: 3.12.7
[0m18:14:39.372143 [info ] [MainThread]: python path: C:\Users\alvaro\Desktop\sumup_assignment\dbt-sumup\Scripts\python.exe
[0m18:14:39.373145 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m18:14:39.448745 [info ] [MainThread]: Using profiles dir at C:\Users\alvaro\.dbt
[0m18:14:39.449760 [info ] [MainThread]: Using profiles.yml file at C:\Users\alvaro\.dbt\profiles.yml
[0m18:14:39.449760 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\alvaro\Desktop\sumup_assignment\merchant_data_project\dbt_project.yml
[0m18:14:39.450658 [info ] [MainThread]: adapter type: postgres
[0m18:14:39.451727 [info ] [MainThread]: adapter version: 1.8.2
[0m18:14:39.518826 [info ] [MainThread]: Configuration:
[0m18:14:39.519742 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:14:39.519742 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:14:39.520741 [info ] [MainThread]: Required dependencies:
[0m18:14:39.521774 [debug] [MainThread]: Executing "git --help"
[0m18:14:39.549338 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:14:39.549338 [debug] [MainThread]: STDERR: "b''"
[0m18:14:39.549338 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:14:39.550360 [info ] [MainThread]: Connection:
[0m18:14:39.551354 [info ] [MainThread]:   host: localhost
[0m18:14:39.551354 [info ] [MainThread]:   port: 5432
[0m18:14:39.552346 [info ] [MainThread]:   user: postgres
[0m18:14:39.552346 [info ] [MainThread]:   database: merchant_data
[0m18:14:39.553354 [info ] [MainThread]:   schema: public
[0m18:14:39.553354 [info ] [MainThread]:   connect_timeout: 10
[0m18:14:39.553354 [info ] [MainThread]:   role: None
[0m18:14:39.554354 [info ] [MainThread]:   search_path: None
[0m18:14:39.554354 [info ] [MainThread]:   keepalives_idle: 0
[0m18:14:39.554354 [info ] [MainThread]:   sslmode: None
[0m18:14:39.555358 [info ] [MainThread]:   sslcert: None
[0m18:14:39.555358 [info ] [MainThread]:   sslkey: None
[0m18:14:39.555358 [info ] [MainThread]:   sslrootcert: None
[0m18:14:39.555358 [info ] [MainThread]:   application_name: dbt
[0m18:14:39.556354 [info ] [MainThread]:   retries: 1
[0m18:14:39.556354 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:14:39.557378 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m18:14:39.600355 [debug] [MainThread]: Using postgres connection "debug"
[0m18:14:39.600355 [debug] [MainThread]: On debug: select 1 as id
[0m18:14:39.600355 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:14:39.632978 [debug] [MainThread]: SQL status: SELECT 1 in 0.032 seconds
[0m18:14:39.633978 [debug] [MainThread]: On debug: Close
[0m18:14:39.633978 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:14:39.634982 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:14:39.635978 [debug] [MainThread]: Command `dbt debug` succeeded at 18:14:39.635978 after 0.37 seconds
[0m18:14:39.635978 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:14:39.636978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217F9F777A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217FABEBFB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217FAB878C0>]}
[0m18:14:39.636978 [debug] [MainThread]: Flushing usage events
[0m18:34:29.278290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158B2E38770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158B77783B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158B41F2060>]}


============================== 18:34:29.281233 | 30f87f10-a88b-4f6d-b992-9e0a495f8121 ==============================
[0m18:34:29.281233 [info ] [MainThread]: Running with dbt=1.8.8
[0m18:34:29.282233 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alvaro\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\alvaro\\Desktop\\sumup_assignment\\merchant_data_project\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m18:34:29.293233 [info ] [MainThread]: dbt version: 1.8.8
[0m18:34:29.294234 [info ] [MainThread]: python version: 3.12.7
[0m18:34:29.294234 [info ] [MainThread]: python path: C:\Users\alvaro\Desktop\sumup_assignment\dbt-sumup\Scripts\python.exe
[0m18:34:29.295240 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m18:34:29.371003 [info ] [MainThread]: Using profiles dir at C:\Users\alvaro\.dbt
[0m18:34:29.371909 [info ] [MainThread]: Using profiles.yml file at C:\Users\alvaro\.dbt\profiles.yml
[0m18:34:29.371909 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\alvaro\Desktop\sumup_assignment\merchant_data_project\dbt_project.yml
[0m18:34:29.372909 [info ] [MainThread]: adapter type: postgres
[0m18:34:29.372909 [info ] [MainThread]: adapter version: 1.8.2
[0m18:34:29.443058 [info ] [MainThread]: Configuration:
[0m18:34:29.443994 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:34:29.443994 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:34:29.444958 [info ] [MainThread]: Required dependencies:
[0m18:34:29.445967 [debug] [MainThread]: Executing "git --help"
[0m18:34:29.474540 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:34:29.475480 [debug] [MainThread]: STDERR: "b''"
[0m18:34:29.475480 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:34:29.476488 [info ] [MainThread]: Connection:
[0m18:34:29.476488 [info ] [MainThread]:   host: localhost
[0m18:34:29.477477 [info ] [MainThread]:   port: 5432
[0m18:34:29.477477 [info ] [MainThread]:   user: postgres
[0m18:34:29.478477 [info ] [MainThread]:   database: merchant_data
[0m18:34:29.478477 [info ] [MainThread]:   schema: public
[0m18:34:29.478477 [info ] [MainThread]:   connect_timeout: 10
[0m18:34:29.479479 [info ] [MainThread]:   role: None
[0m18:34:29.479479 [info ] [MainThread]:   search_path: None
[0m18:34:29.480477 [info ] [MainThread]:   keepalives_idle: 0
[0m18:34:29.480477 [info ] [MainThread]:   sslmode: None
[0m18:34:29.480477 [info ] [MainThread]:   sslcert: None
[0m18:34:29.481478 [info ] [MainThread]:   sslkey: None
[0m18:34:29.481478 [info ] [MainThread]:   sslrootcert: None
[0m18:34:29.482475 [info ] [MainThread]:   application_name: dbt
[0m18:34:29.482475 [info ] [MainThread]:   retries: 1
[0m18:34:29.483477 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:34:29.483477 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m18:34:29.528578 [debug] [MainThread]: Using postgres connection "debug"
[0m18:34:29.528578 [debug] [MainThread]: On debug: select 1 as id
[0m18:34:29.529561 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:34:29.564025 [debug] [MainThread]: SQL status: SELECT 1 in 0.035 seconds
[0m18:34:29.565024 [debug] [MainThread]: On debug: Close
[0m18:34:29.565024 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:34:29.566024 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:34:29.568006 [debug] [MainThread]: Command `dbt debug` succeeded at 18:34:29.567005 after 0.38 seconds
[0m18:34:29.568006 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:34:29.568006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158B7584830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158B7587B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158B6DD1070>]}
[0m18:34:29.569007 [debug] [MainThread]: Flushing usage events
[0m22:43:48.593341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277F73FAE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277F976EB70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277F976F0B0>]}


============================== 22:43:48.603347 | 7f5eea36-e6c9-4e40-bb19-934c85245825 ==============================
[0m22:43:48.603347 [info ] [MainThread]: Running with dbt=1.8.8
[0m22:43:48.604344 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alvaro\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\alvaro\\Desktop\\sumup_assignment\\merchant_data_project\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:43:48.902955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f5eea36-e6c9-4e40-bb19-934c85245825', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277F930C800>]}
[0m22:43:48.946663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f5eea36-e6c9-4e40-bb19-934c85245825', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277F9AC5700>]}
[0m22:43:48.955764 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:43:48.964756 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m22:43:49.030765 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m22:43:49.031688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7f5eea36-e6c9-4e40-bb19-934c85245825', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277FB4E5130>]}
[0m22:43:50.333762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f5eea36-e6c9-4e40-bb19-934c85245825', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277FB5CAD80>]}
[0m22:43:50.528431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f5eea36-e6c9-4e40-bb19-934c85245825', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277F9FA0920>]}
[0m22:43:50.529858 [info ] [MainThread]: Found 2 models, 4 data tests, 423 macros
[0m22:43:50.529858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f5eea36-e6c9-4e40-bb19-934c85245825', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277FB9E8830>]}
[0m22:43:50.531863 [info ] [MainThread]: 
[0m22:43:50.532870 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:43:50.536886 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merchant_data'
[0m22:43:52.234153 [debug] [ThreadPool]: Using postgres connection "list_merchant_data"
[0m22:43:52.234153 [debug] [ThreadPool]: On list_merchant_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "list_merchant_data"} */

    select distinct nspname from pg_namespace
  
[0m22:43:52.235140 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:43:52.271257 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.037 seconds
[0m22:43:52.272309 [debug] [ThreadPool]: On list_merchant_data: Close
[0m22:43:52.274220 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merchant_data_public'
[0m22:43:52.280221 [debug] [ThreadPool]: Using postgres connection "list_merchant_data_public"
[0m22:43:52.280221 [debug] [ThreadPool]: On list_merchant_data_public: BEGIN
[0m22:43:52.281220 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:43:52.314718 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m22:43:52.315805 [debug] [ThreadPool]: Using postgres connection "list_merchant_data_public"
[0m22:43:52.315805 [debug] [ThreadPool]: On list_merchant_data_public: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "list_merchant_data_public"} */
select
      'merchant_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'merchant_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'merchant_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:43:52.321717 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.006 seconds
[0m22:43:52.322743 [debug] [ThreadPool]: On list_merchant_data_public: ROLLBACK
[0m22:43:52.323719 [debug] [ThreadPool]: On list_merchant_data_public: Close
[0m22:43:52.327717 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:52.328805 [debug] [MainThread]: On master: BEGIN
[0m22:43:52.328805 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:43:52.361184 [debug] [MainThread]: SQL status: BEGIN in 0.032 seconds
[0m22:43:52.361184 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:52.362261 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:43:52.369430 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m22:43:52.370513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f5eea36-e6c9-4e40-bb19-934c85245825', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277FB423FE0>]}
[0m22:43:52.370513 [debug] [MainThread]: On master: ROLLBACK
[0m22:43:52.371519 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:52.371519 [debug] [MainThread]: On master: BEGIN
[0m22:43:52.372431 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:43:52.372431 [debug] [MainThread]: On master: COMMIT
[0m22:43:52.372431 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:52.372431 [debug] [MainThread]: On master: COMMIT
[0m22:43:52.373529 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:43:52.373529 [debug] [MainThread]: On master: Close
[0m22:43:52.374442 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:43:52.374442 [info ] [MainThread]: 
[0m22:43:52.379432 [debug] [Thread-1 (]: Began running node model.merchant_data_project.my_first_dbt_model
[0m22:43:52.380431 [info ] [Thread-1 (]: 1 of 2 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m22:43:52.381432 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.merchant_data_project.my_first_dbt_model'
[0m22:43:52.381432 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.my_first_dbt_model
[0m22:43:52.388432 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.my_first_dbt_model"
[0m22:43:52.390434 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.my_first_dbt_model
[0m22:43:52.422438 [debug] [Thread-1 (]: Writing runtime sql for node "model.merchant_data_project.my_first_dbt_model"
[0m22:43:52.424526 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.my_first_dbt_model"
[0m22:43:52.425531 [debug] [Thread-1 (]: On model.merchant_data_project.my_first_dbt_model: BEGIN
[0m22:43:52.426537 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:43:52.460049 [debug] [Thread-1 (]: SQL status: BEGIN in 0.033 seconds
[0m22:43:52.460049 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.my_first_dbt_model"
[0m22:43:52.460049 [debug] [Thread-1 (]: On model.merchant_data_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.my_first_dbt_model"} */

  
    

  create  table "merchant_data"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m22:43:52.464051 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m22:43:52.469167 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.my_first_dbt_model"
[0m22:43:52.469167 [debug] [Thread-1 (]: On model.merchant_data_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.my_first_dbt_model"} */
alter table "merchant_data"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m22:43:52.470151 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:43:52.519137 [debug] [Thread-1 (]: On model.merchant_data_project.my_first_dbt_model: COMMIT
[0m22:43:52.519137 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.my_first_dbt_model"
[0m22:43:52.519137 [debug] [Thread-1 (]: On model.merchant_data_project.my_first_dbt_model: COMMIT
[0m22:43:52.521090 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m22:43:52.526132 [debug] [Thread-1 (]: Applying DROP to: "merchant_data"."public"."my_first_dbt_model__dbt_backup"
[0m22:43:52.529169 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.my_first_dbt_model"
[0m22:43:52.530137 [debug] [Thread-1 (]: On model.merchant_data_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.my_first_dbt_model"} */
drop table if exists "merchant_data"."public"."my_first_dbt_model__dbt_backup" cascade
[0m22:43:52.530137 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m22:43:52.532128 [debug] [Thread-1 (]: On model.merchant_data_project.my_first_dbt_model: Close
[0m22:43:52.533050 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f5eea36-e6c9-4e40-bb19-934c85245825', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277FBF49A00>]}
[0m22:43:52.534050 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.15s]
[0m22:43:52.535049 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.my_first_dbt_model
[0m22:43:52.535049 [debug] [Thread-1 (]: Began running node model.merchant_data_project.my_second_dbt_model
[0m22:43:52.536071 [info ] [Thread-1 (]: 2 of 2 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m22:43:52.536071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.merchant_data_project.my_first_dbt_model, now model.merchant_data_project.my_second_dbt_model)
[0m22:43:52.537091 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.my_second_dbt_model
[0m22:43:52.539194 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.my_second_dbt_model"
[0m22:43:52.540086 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.my_second_dbt_model
[0m22:43:52.555235 [debug] [Thread-1 (]: Writing runtime sql for node "model.merchant_data_project.my_second_dbt_model"
[0m22:43:52.556236 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.my_second_dbt_model"
[0m22:43:52.557240 [debug] [Thread-1 (]: On model.merchant_data_project.my_second_dbt_model: BEGIN
[0m22:43:52.557240 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:43:52.591231 [debug] [Thread-1 (]: SQL status: BEGIN in 0.034 seconds
[0m22:43:52.591231 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.my_second_dbt_model"
[0m22:43:52.591231 [debug] [Thread-1 (]: On model.merchant_data_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.my_second_dbt_model"} */

  create view "merchant_data"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "merchant_data"."public"."my_first_dbt_model"
where id = 1
  );
[0m22:43:52.597236 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m22:43:52.600231 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.my_second_dbt_model"
[0m22:43:52.600231 [debug] [Thread-1 (]: On model.merchant_data_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.my_second_dbt_model"} */
alter table "merchant_data"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m22:43:52.601273 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:43:52.602236 [debug] [Thread-1 (]: On model.merchant_data_project.my_second_dbt_model: COMMIT
[0m22:43:52.602236 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.my_second_dbt_model"
[0m22:43:52.602236 [debug] [Thread-1 (]: On model.merchant_data_project.my_second_dbt_model: COMMIT
[0m22:43:52.605232 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m22:43:52.606316 [debug] [Thread-1 (]: Applying DROP to: "merchant_data"."public"."my_second_dbt_model__dbt_backup"
[0m22:43:52.608322 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.my_second_dbt_model"
[0m22:43:52.609321 [debug] [Thread-1 (]: On model.merchant_data_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.my_second_dbt_model"} */
drop view if exists "merchant_data"."public"."my_second_dbt_model__dbt_backup" cascade
[0m22:43:52.609321 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:43:52.611317 [debug] [Thread-1 (]: On model.merchant_data_project.my_second_dbt_model: Close
[0m22:43:52.611317 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f5eea36-e6c9-4e40-bb19-934c85245825', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277FABCD070>]}
[0m22:43:52.612231 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.08s]
[0m22:43:52.613246 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.my_second_dbt_model
[0m22:43:52.614248 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:52.614248 [debug] [MainThread]: On master: BEGIN
[0m22:43:52.615295 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:43:52.755328 [debug] [MainThread]: SQL status: BEGIN in 0.140 seconds
[0m22:43:52.755328 [debug] [MainThread]: On master: COMMIT
[0m22:43:52.755328 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:52.756435 [debug] [MainThread]: On master: COMMIT
[0m22:43:52.756435 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:43:52.756435 [debug] [MainThread]: On master: Close
[0m22:43:52.757320 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:43:52.757320 [debug] [MainThread]: Connection 'list_merchant_data' was properly closed.
[0m22:43:52.757320 [debug] [MainThread]: Connection 'list_merchant_data_public' was properly closed.
[0m22:43:52.757320 [debug] [MainThread]: Connection 'model.merchant_data_project.my_second_dbt_model' was properly closed.
[0m22:43:52.758320 [info ] [MainThread]: 
[0m22:43:52.758320 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 2.23 seconds (2.23s).
[0m22:43:52.759810 [debug] [MainThread]: Command end result
[0m22:43:52.788156 [info ] [MainThread]: 
[0m22:43:52.788156 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:43:52.789149 [info ] [MainThread]: 
[0m22:43:52.790152 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:43:52.791247 [debug] [MainThread]: Command `dbt run` succeeded at 22:43:52.791247 after 4.29 seconds
[0m22:43:52.791247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277FA262930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277FAD92270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277FAD90B00>]}
[0m22:43:52.792216 [debug] [MainThread]: Flushing usage events
[0m07:11:56.262743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000139204A2930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013921C1ABD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001391D13BAA0>]}


============================== 07:11:56.265760 | 9d45c724-6acd-4b94-b088-3e03f29776e5 ==============================
[0m07:11:56.265760 [info ] [MainThread]: Running with dbt=1.8.8
[0m07:11:56.266760 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alvaro\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\alvaro\\Desktop\\sumup_assignment\\merchant_data_project\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m07:11:56.294127 [info ] [MainThread]: dbt version: 1.8.8
[0m07:11:56.295167 [info ] [MainThread]: python version: 3.12.7
[0m07:11:56.296130 [info ] [MainThread]: python path: C:\Users\alvaro\Desktop\sumup_assignment\dbt-sumup\Scripts\python.exe
[0m07:11:56.296130 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m07:11:56.419612 [info ] [MainThread]: Using profiles dir at C:\Users\alvaro\.dbt
[0m07:11:56.420611 [info ] [MainThread]: Using profiles.yml file at C:\Users\alvaro\.dbt\profiles.yml
[0m07:11:56.420611 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\alvaro\Desktop\sumup_assignment\merchant_data_project\dbt_project.yml
[0m07:11:56.421954 [info ] [MainThread]: adapter type: postgres
[0m07:11:56.421954 [info ] [MainThread]: adapter version: 1.8.2
[0m07:11:56.546447 [info ] [MainThread]: Configuration:
[0m07:11:56.547465 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m07:11:56.547465 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m07:11:56.548788 [info ] [MainThread]: Required dependencies:
[0m07:11:56.548788 [debug] [MainThread]: Executing "git --help"
[0m07:11:56.584820 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m07:11:56.584820 [debug] [MainThread]: STDERR: "b''"
[0m07:11:56.585941 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m07:11:56.587347 [info ] [MainThread]: Connection:
[0m07:11:56.587347 [info ] [MainThread]:   host: localhost
[0m07:11:56.588354 [info ] [MainThread]:   port: 5432
[0m07:11:56.588354 [info ] [MainThread]:   user: postgres
[0m07:11:56.588354 [info ] [MainThread]:   database: merchant_data
[0m07:11:56.589848 [info ] [MainThread]:   schema: public
[0m07:11:56.589848 [info ] [MainThread]:   connect_timeout: 10
[0m07:11:56.589848 [info ] [MainThread]:   role: None
[0m07:11:56.591247 [info ] [MainThread]:   search_path: None
[0m07:11:56.591247 [info ] [MainThread]:   keepalives_idle: 0
[0m07:11:56.591247 [info ] [MainThread]:   sslmode: None
[0m07:11:56.592658 [info ] [MainThread]:   sslcert: None
[0m07:11:56.593164 [info ] [MainThread]:   sslkey: None
[0m07:11:56.593164 [info ] [MainThread]:   sslrootcert: None
[0m07:11:56.593164 [info ] [MainThread]:   application_name: dbt
[0m07:11:56.594575 [info ] [MainThread]:   retries: 1
[0m07:11:56.595581 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:11:56.595581 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m07:11:56.673294 [debug] [MainThread]: Using postgres connection "debug"
[0m07:11:56.674543 [debug] [MainThread]: On debug: select 1 as id
[0m07:11:56.674543 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:11:56.721496 [debug] [MainThread]: SQL status: SELECT 1 in 0.047 seconds
[0m07:11:56.723006 [debug] [MainThread]: On debug: Close
[0m07:11:56.723006 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m07:11:56.724474 [info ] [MainThread]: [32mAll checks passed![0m
[0m07:11:56.725481 [debug] [MainThread]: Command `dbt debug` succeeded at 07:11:56.725481 after 0.57 seconds
[0m07:11:56.726905 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m07:11:56.726905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013922280EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000139222B5550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013921FF83B0>]}
[0m07:11:56.726905 [debug] [MainThread]: Flushing usage events
[0m07:11:56.731658 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m18:36:37.602299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002647C5F30E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002647F2D2C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002647F2D0B00>]}


============================== 18:36:37.605301 | 668c52d1-ae4c-418a-bd43-16217608a90c ==============================
[0m18:36:37.605301 [info ] [MainThread]: Running with dbt=1.8.8
[0m18:36:37.606301 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alvaro\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\alvaro\\Desktop\\sumup_assignment\\merchant_data_project\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:36:37.618322 [info ] [MainThread]: dbt version: 1.8.8
[0m18:36:37.618322 [info ] [MainThread]: python version: 3.12.7
[0m18:36:37.619301 [info ] [MainThread]: python path: C:\Users\alvaro\Desktop\sumup_assignment\dbt-sumup\Scripts\python.exe
[0m18:36:37.619301 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m18:36:37.710957 [info ] [MainThread]: Using profiles dir at C:\Users\alvaro\.dbt
[0m18:36:37.712046 [info ] [MainThread]: Using profiles.yml file at C:\Users\alvaro\.dbt\profiles.yml
[0m18:36:37.712952 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\alvaro\Desktop\sumup_assignment\merchant_data_project\dbt_project.yml
[0m18:36:37.713953 [info ] [MainThread]: adapter type: postgres
[0m18:36:37.713953 [info ] [MainThread]: adapter version: 1.8.2
[0m18:36:37.802637 [info ] [MainThread]: Configuration:
[0m18:36:37.803513 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:36:37.804513 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:36:37.804513 [info ] [MainThread]: Required dependencies:
[0m18:36:37.805515 [debug] [MainThread]: Executing "git --help"
[0m18:36:37.834834 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:36:37.834834 [debug] [MainThread]: STDERR: "b''"
[0m18:36:37.834834 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:36:37.835929 [info ] [MainThread]: Connection:
[0m18:36:37.836835 [info ] [MainThread]:   host: localhost
[0m18:36:37.836835 [info ] [MainThread]:   port: 5432
[0m18:36:37.837831 [info ] [MainThread]:   user: postgres
[0m18:36:37.837831 [info ] [MainThread]:   database: merchant_data
[0m18:36:37.837831 [info ] [MainThread]:   schema: public
[0m18:36:37.838832 [info ] [MainThread]:   connect_timeout: 10
[0m18:36:37.838832 [info ] [MainThread]:   role: None
[0m18:36:37.839840 [info ] [MainThread]:   search_path: None
[0m18:36:37.839840 [info ] [MainThread]:   keepalives_idle: 0
[0m18:36:37.839840 [info ] [MainThread]:   sslmode: None
[0m18:36:37.840838 [info ] [MainThread]:   sslcert: None
[0m18:36:37.840838 [info ] [MainThread]:   sslkey: None
[0m18:36:37.840838 [info ] [MainThread]:   sslrootcert: None
[0m18:36:37.841838 [info ] [MainThread]:   application_name: dbt
[0m18:36:37.841838 [info ] [MainThread]:   retries: 1
[0m18:36:37.842840 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:36:37.842840 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m18:36:37.886346 [debug] [MainThread]: Using postgres connection "debug"
[0m18:36:37.887347 [debug] [MainThread]: On debug: select 1 as id
[0m18:36:37.887347 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:36:38.024432 [debug] [MainThread]: SQL status: SELECT 1 in 0.137 seconds
[0m18:36:38.025433 [debug] [MainThread]: On debug: Close
[0m18:36:38.026452 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:36:38.026452 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:36:38.027434 [debug] [MainThread]: Command `dbt debug` succeeded at 18:36:38.027434 after 0.52 seconds
[0m18:36:38.028432 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:36:38.028432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002647C5F30E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002640017D520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002647FB47530>]}
[0m18:36:38.028432 [debug] [MainThread]: Flushing usage events
[0m18:53:04.030869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221504B7C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022154044B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022154047860>]}


============================== 18:53:04.038964 | 20c7eaea-f121-42e9-b3f4-a86f95343450 ==============================
[0m18:53:04.038964 [info ] [MainThread]: Running with dbt=1.8.8
[0m18:53:04.039958 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\alvaro\\.dbt', 'log_path': 'C:\\Users\\alvaro\\Desktop\\sumup_assignment\\merchant_data_project\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select account_statuses', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:53:04.300647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20c7eaea-f121-42e9-b3f4-a86f95343450', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221541CCFE0>]}
[0m18:53:04.343391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '20c7eaea-f121-42e9-b3f4-a86f95343450', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221527C0C80>]}
[0m18:53:04.348484 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:53:04.356641 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m18:53:04.403822 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m18:53:04.403822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '20c7eaea-f121-42e9-b3f4-a86f95343450', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221548CB560>]}
[0m18:53:05.571683 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.merchant_data_project.account_statuses' (models\staging\account_statuses.sql) depends on a source named 'merchant_data.account_status' which was not found
[0m18:53:05.573666 [debug] [MainThread]: Command `dbt run` failed at 18:53:05.572675 after 1.65 seconds
[0m18:53:05.573666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221541A0F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022154972A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022154C14470>]}
[0m18:53:05.573666 [debug] [MainThread]: Flushing usage events
[0m18:54:08.079226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADFFA8A0F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD83068590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD83068440>]}


============================== 18:54:08.082852 | c784f2a1-48d1-40bd-a8ad-5ba064c6a28a ==============================
[0m18:54:08.082852 [info ] [MainThread]: Running with dbt=1.8.8
[0m18:54:08.083857 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alvaro\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\alvaro\\Desktop\\sumup_assignment\\merchant_data_project\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select account_statuses', 'send_anonymous_usage_stats': 'True'}
[0m18:54:08.237802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c784f2a1-48d1-40bd-a8ad-5ba064c6a28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD82BFC200>]}
[0m18:54:08.277582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c784f2a1-48d1-40bd-a8ad-5ba064c6a28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD840C6450>]}
[0m18:54:08.278602 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:54:08.284595 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m18:54:08.330157 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m18:54:08.331069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c784f2a1-48d1-40bd-a8ad-5ba064c6a28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD840C5FA0>]}
[0m18:54:08.960967 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.merchant_data_project.account_statuses' (models\staging\account_statuses.sql) depends on a source named 'merchant_data.merchant_status' which was not found
[0m18:54:08.962975 [debug] [MainThread]: Command `dbt run` failed at 18:54:08.962975 after 1.00 seconds
[0m18:54:08.962975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD83AA11F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD84072480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD84537B60>]}
[0m18:54:08.963956 [debug] [MainThread]: Flushing usage events
[0m18:54:24.710831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DA0247920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D9E5404D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D9FE87FB0>]}


============================== 18:54:24.713859 | 44180a02-4c79-44f2-9b91-174b61fd5b13 ==============================
[0m18:54:24.713859 [info ] [MainThread]: Running with dbt=1.8.8
[0m18:54:24.714836 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alvaro\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\alvaro\\Desktop\\sumup_assignment\\merchant_data_project\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select account_statuses.sql', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:54:24.870487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '44180a02-4c79-44f2-9b91-174b61fd5b13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D9F74B530>]}
[0m18:54:24.912587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '44180a02-4c79-44f2-9b91-174b61fd5b13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D9F17BC80>]}
[0m18:54:24.913497 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:54:24.919495 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m18:54:24.965100 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m18:54:24.966092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '44180a02-4c79-44f2-9b91-174b61fd5b13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D9F6D02C0>]}
[0m18:54:25.601736 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.merchant_data_project.account_statuses' (models\staging\account_statuses.sql) depends on a source named 'merchant_data.merchant_status' which was not found
[0m18:54:25.602822 [debug] [MainThread]: Command `dbt run` failed at 18:54:25.602822 after 0.98 seconds
[0m18:54:25.602822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D9F6D0AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DA0244EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DA055FE60>]}
[0m18:54:25.602822 [debug] [MainThread]: Flushing usage events
[0m19:05:21.293039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A58C3CD340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A58BFC5730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A58A0B4C20>]}


============================== 19:05:21.297074 | 17bb3ef2-07d1-45ac-ac9b-cf642bc8ade0 ==============================
[0m19:05:21.297074 [info ] [MainThread]: Running with dbt=1.8.8
[0m19:05:21.297074 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\alvaro\\.dbt', 'log_path': 'C:\\Users\\alvaro\\Desktop\\sumup_assignment\\merchant_data_project\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select account_statuses.sql', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:05:21.452426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17bb3ef2-07d1-45ac-ac9b-cf642bc8ade0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A58C4EDB50>]}
[0m19:05:21.494419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17bb3ef2-07d1-45ac-ac9b-cf642bc8ade0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A58C5C1F10>]}
[0m19:05:21.495425 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:05:21.501434 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m19:05:21.546124 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m19:05:21.547123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '17bb3ef2-07d1-45ac-ac9b-cf642bc8ade0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A58B7D03E0>]}
[0m19:05:22.272606 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.merchant_data_project.account_statuses' (models\staging\account_statuses.sql) depends on a source named 'merchant_data.merchant_status' which was not found
[0m19:05:22.273624 [debug] [MainThread]: Command `dbt run` failed at 19:05:22.273624 after 1.07 seconds
[0m19:05:22.274690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A58BF84500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A58CD68950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A58C815430>]}
[0m19:05:22.274690 [debug] [MainThread]: Flushing usage events
[0m19:06:41.545098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240A686AFF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240A686B4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240A6869160>]}


============================== 19:06:41.548097 | 9f7f8346-aa68-4f36-865a-f1270e920154 ==============================
[0m19:06:41.548097 [info ] [MainThread]: Running with dbt=1.8.8
[0m19:06:41.549077 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alvaro\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\alvaro\\Desktop\\sumup_assignment\\merchant_data_project\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select account_statuses.sql', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:06:41.738722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f7f8346-aa68-4f36-865a-f1270e920154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240A75CCB00>]}
[0m19:06:41.791476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9f7f8346-aa68-4f36-865a-f1270e920154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240A67F6780>]}
[0m19:06:41.793483 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:06:41.804499 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m19:06:41.864567 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m19:06:41.864567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9f7f8346-aa68-4f36-865a-f1270e920154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240A7CC3F20>]}
[0m19:06:42.583076 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.merchant_data_project.account_statuses' (models\staging\account_statuses.sql) depends on a source named 'merchant_data.account_statuses' which was not found
[0m19:06:42.584989 [debug] [MainThread]: Command `dbt run` failed at 19:06:42.584989 after 1.12 seconds
[0m19:06:42.586025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240A692CF20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240A8042450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240A80B4770>]}
[0m19:06:42.586025 [debug] [MainThread]: Flushing usage events
[0m19:12:06.248392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016ACB387C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016ACE26B170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016ACE26A540>]}


============================== 19:12:06.252482 | e1b6a17e-0dea-4282-9ec6-09fd1bef0be3 ==============================
[0m19:12:06.252482 [info ] [MainThread]: Running with dbt=1.8.8
[0m19:12:06.253390 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alvaro\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\alvaro\\Desktop\\sumup_assignment\\merchant_data_project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select account_statuses.sql', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:12:06.441932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1b6a17e-0dea-4282-9ec6-09fd1bef0be3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016ACEFD2B40>]}
[0m19:12:06.482982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1b6a17e-0dea-4282-9ec6-09fd1bef0be3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016ACD80C830>]}
[0m19:12:06.483974 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:12:06.489977 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m19:12:06.534552 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m19:12:06.535466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e1b6a17e-0dea-4282-9ec6-09fd1bef0be3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016ACD95DD00>]}
[0m19:12:07.267026 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.merchant_data_project.account_statuses' (models\staging\account_statuses.sql) depends on a source named 'merchant_data.merchant_statuses' which was not found
[0m19:12:07.269041 [debug] [MainThread]: Command `dbt run` failed at 19:12:07.269041 after 1.16 seconds
[0m19:12:07.269041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016ACEECC9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016ACFA84EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016ACFA687D0>]}
[0m19:12:07.270062 [debug] [MainThread]: Flushing usage events
[0m19:15:30.481340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F925E44EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F925E46870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F925E477D0>]}


============================== 19:15:30.485340 | f8e174a5-7831-4088-b063-2b2eefa2d77c ==============================
[0m19:15:30.485340 [info ] [MainThread]: Running with dbt=1.8.8
[0m19:15:30.485340 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\alvaro\\.dbt', 'log_path': 'C:\\Users\\alvaro\\Desktop\\sumup_assignment\\merchant_data_project\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select test_connection.sql', 'send_anonymous_usage_stats': 'True'}
[0m19:15:30.662428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8e174a5-7831-4088-b063-2b2eefa2d77c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F925FCB320>]}
[0m19:15:30.704493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8e174a5-7831-4088-b063-2b2eefa2d77c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9249E6510>]}
[0m19:15:30.705499 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:15:30.712450 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m19:15:30.763051 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m19:15:30.764051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f8e174a5-7831-4088-b063-2b2eefa2d77c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9266CB590>]}
[0m19:15:31.478483 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.merchant_data_project.test_connection' (models\test_connection.sql) depends on a source named 'merchant_data.merchant_status' which was not found
[0m19:15:31.480471 [debug] [MainThread]: Command `dbt run` failed at 19:15:31.479382 after 1.08 seconds
[0m19:15:31.480471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9251D0B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F926665CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F925E44EC0>]}
[0m19:15:31.480471 [debug] [MainThread]: Flushing usage events
[0m19:16:14.346371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C8889C530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C8A279BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C8AB25880>]}


============================== 19:16:14.349395 | 9dbfdad4-b049-487f-bbcc-3581cb7cae56 ==============================
[0m19:16:14.349395 [info ] [MainThread]: Running with dbt=1.8.8
[0m19:16:14.349395 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alvaro\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\alvaro\\Desktop\\sumup_assignment\\merchant_data_project\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:16:14.487809 [info ] [MainThread]: dbt version: 1.8.8
[0m19:16:14.488916 [info ] [MainThread]: python version: 3.12.7
[0m19:16:14.489862 [info ] [MainThread]: python path: C:\Users\alvaro\Desktop\sumup_assignment\dbt-sumup\Scripts\python.exe
[0m19:16:14.490806 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m19:16:14.566582 [info ] [MainThread]: Using profiles dir at C:\Users\alvaro\.dbt
[0m19:16:14.567581 [info ] [MainThread]: Using profiles.yml file at C:\Users\alvaro\.dbt\profiles.yml
[0m19:16:14.568582 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\alvaro\Desktop\sumup_assignment\merchant_data_project\dbt_project.yml
[0m19:16:14.569584 [info ] [MainThread]: adapter type: postgres
[0m19:16:14.569584 [info ] [MainThread]: adapter version: 1.8.2
[0m19:16:14.639416 [info ] [MainThread]: Configuration:
[0m19:16:14.640416 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:16:14.641455 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:16:14.641455 [info ] [MainThread]: Required dependencies:
[0m19:16:14.642416 [debug] [MainThread]: Executing "git --help"
[0m19:16:14.668451 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:16:14.669448 [debug] [MainThread]: STDERR: "b''"
[0m19:16:14.669448 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:16:14.670450 [info ] [MainThread]: Connection:
[0m19:16:14.671447 [info ] [MainThread]:   host: localhost
[0m19:16:14.671447 [info ] [MainThread]:   port: 5432
[0m19:16:14.672447 [info ] [MainThread]:   user: postgres
[0m19:16:14.672447 [info ] [MainThread]:   database: merchant_data
[0m19:16:14.673448 [info ] [MainThread]:   schema: public
[0m19:16:14.673448 [info ] [MainThread]:   connect_timeout: 10
[0m19:16:14.674448 [info ] [MainThread]:   role: None
[0m19:16:14.674448 [info ] [MainThread]:   search_path: None
[0m19:16:14.675461 [info ] [MainThread]:   keepalives_idle: 0
[0m19:16:14.675461 [info ] [MainThread]:   sslmode: None
[0m19:16:14.676447 [info ] [MainThread]:   sslcert: None
[0m19:16:14.677447 [info ] [MainThread]:   sslkey: None
[0m19:16:14.677447 [info ] [MainThread]:   sslrootcert: None
[0m19:16:14.677447 [info ] [MainThread]:   application_name: dbt
[0m19:16:14.678446 [info ] [MainThread]:   retries: 1
[0m19:16:14.679446 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:16:14.679446 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m19:16:16.284978 [debug] [MainThread]: Using postgres connection "debug"
[0m19:16:16.284978 [debug] [MainThread]: On debug: select 1 as id
[0m19:16:16.284978 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:16:16.317821 [debug] [MainThread]: SQL status: SELECT 1 in 0.033 seconds
[0m19:16:16.318800 [debug] [MainThread]: On debug: Close
[0m19:16:16.318800 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:16:16.319803 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:16:16.320800 [debug] [MainThread]: Command `dbt debug` succeeded at 19:16:16.320800 after 2.06 seconds
[0m19:16:16.321800 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:16:16.321800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C8A6DABA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C8BDF8FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C8BAC8350>]}
[0m19:16:16.321800 [debug] [MainThread]: Flushing usage events
[0m19:16:27.790375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E40A97E720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E40995E870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E40A97C380>]}


============================== 19:16:27.793376 | 000fbed0-031e-4996-9204-46c4c079afd9 ==============================
[0m19:16:27.793376 [info ] [MainThread]: Running with dbt=1.8.8
[0m19:16:27.794376 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alvaro\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\alvaro\\Desktop\\sumup_assignment\\merchant_data_project\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select test_connection', 'send_anonymous_usage_stats': 'True'}
[0m19:16:27.947103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '000fbed0-031e-4996-9204-46c4c079afd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E40AE177D0>]}
[0m19:16:27.990794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '000fbed0-031e-4996-9204-46c4c079afd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4090B1190>]}
[0m19:16:27.991794 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:16:27.998714 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m19:16:28.044967 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m19:16:28.045982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '000fbed0-031e-4996-9204-46c4c079afd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E409DD02C0>]}
[0m19:16:28.826151 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.merchant_data_project.test_connection' (models\test_connection.sql) depends on a source named 'merchant_data.merchant_status' which was not found
[0m19:16:28.827242 [debug] [MainThread]: Command `dbt run` failed at 19:16:28.827242 after 1.13 seconds
[0m19:16:28.828248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E40995E870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E40AE36C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E40B5437D0>]}
[0m19:16:28.828248 [debug] [MainThread]: Flushing usage events
[0m19:20:01.314593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E72FCB4620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E732968EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E732968E00>]}


============================== 19:20:01.317615 | 408a8f44-1745-452c-b0a2-d94424081ed8 ==============================
[0m19:20:01.317615 [info ] [MainThread]: Running with dbt=1.8.8
[0m19:20:01.318594 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alvaro\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\alvaro\\Desktop\\sumup_assignment\\merchant_data_project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select test_connection', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:20:01.472512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '408a8f44-1745-452c-b0a2-d94424081ed8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E73327CD70>]}
[0m19:20:01.520114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '408a8f44-1745-452c-b0a2-d94424081ed8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E7325E6480>]}
[0m19:20:01.521077 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:20:01.527121 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m19:20:01.572697 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m19:20:01.573886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '408a8f44-1745-452c-b0a2-d94424081ed8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E7329D02C0>]}
[0m19:20:02.315366 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.merchant_data_project.test_connection' (models\test_connection.sql) depends on a source named 'merchant_data.account_statuses' which was not found
[0m19:20:02.317409 [debug] [MainThread]: Command `dbt run` failed at 19:20:02.317409 after 1.09 seconds
[0m19:20:02.317409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E72FCB4620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E733A5CEC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E7340420F0>]}
[0m19:20:02.318408 [debug] [MainThread]: Flushing usage events
[0m19:22:30.230962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD8C168EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD8CB56FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD8CB572C0>]}


============================== 19:22:30.234057 | 49b65cea-650e-453c-a773-19c8adbdc83c ==============================
[0m19:22:30.234057 [info ] [MainThread]: Running with dbt=1.8.8
[0m19:22:30.234965 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\alvaro\\.dbt', 'log_path': 'C:\\Users\\alvaro\\Desktop\\sumup_assignment\\merchant_data_project\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select test_connection', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:22:30.389007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49b65cea-650e-453c-a773-19c8adbdc83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD8CC55790>]}
[0m19:22:30.432016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49b65cea-650e-453c-a773-19c8adbdc83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD8CA9A3C0>]}
[0m19:22:30.433017 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:22:30.440016 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m19:22:30.486533 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m19:22:30.487532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '49b65cea-650e-453c-a773-19c8adbdc83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD8D3E46B0>]}
[0m19:22:31.293922 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.merchant_data_project.example
[0m19:22:31.303911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49b65cea-650e-453c-a773-19c8adbdc83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD8D947D40>]}
[0m19:22:31.410825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49b65cea-650e-453c-a773-19c8adbdc83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD8D947E60>]}
[0m19:22:31.410825 [info ] [MainThread]: Found 1 model, 10 sources, 423 macros
[0m19:22:31.411824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49b65cea-650e-453c-a773-19c8adbdc83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD8D92CAD0>]}
[0m19:22:31.412822 [info ] [MainThread]: 
[0m19:22:31.413821 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:22:31.414922 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merchant_data'
[0m19:22:31.465613 [debug] [ThreadPool]: Using postgres connection "list_merchant_data"
[0m19:22:31.465613 [debug] [ThreadPool]: On list_merchant_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "list_merchant_data"} */

    select distinct nspname from pg_namespace
  
[0m19:22:31.465613 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:22:31.503536 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.038 seconds
[0m19:22:31.504615 [debug] [ThreadPool]: On list_merchant_data: Close
[0m19:22:31.506539 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merchant_data_public'
[0m19:22:31.510622 [debug] [ThreadPool]: Using postgres connection "list_merchant_data_public"
[0m19:22:31.510622 [debug] [ThreadPool]: On list_merchant_data_public: BEGIN
[0m19:22:31.511638 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:22:31.543958 [debug] [ThreadPool]: SQL status: BEGIN in 0.032 seconds
[0m19:22:31.543958 [debug] [ThreadPool]: Using postgres connection "list_merchant_data_public"
[0m19:22:31.544462 [debug] [ThreadPool]: On list_merchant_data_public: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "list_merchant_data_public"} */
select
      'merchant_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'merchant_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'merchant_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:22:31.550475 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.006 seconds
[0m19:22:31.552466 [debug] [ThreadPool]: On list_merchant_data_public: ROLLBACK
[0m19:22:31.552466 [debug] [ThreadPool]: On list_merchant_data_public: Close
[0m19:22:31.559469 [debug] [MainThread]: Using postgres connection "master"
[0m19:22:31.560468 [debug] [MainThread]: On master: BEGIN
[0m19:22:31.560468 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:22:31.593633 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m19:22:31.593633 [debug] [MainThread]: Using postgres connection "master"
[0m19:22:31.594640 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:22:31.602784 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m19:22:31.603834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49b65cea-650e-453c-a773-19c8adbdc83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD8D832570>]}
[0m19:22:31.603834 [debug] [MainThread]: On master: ROLLBACK
[0m19:22:31.603834 [debug] [MainThread]: Using postgres connection "master"
[0m19:22:31.604785 [debug] [MainThread]: On master: BEGIN
[0m19:22:31.604785 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:22:31.605717 [debug] [MainThread]: On master: COMMIT
[0m19:22:31.605717 [debug] [MainThread]: Using postgres connection "master"
[0m19:22:31.605717 [debug] [MainThread]: On master: COMMIT
[0m19:22:31.605717 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:22:31.606748 [debug] [MainThread]: On master: Close
[0m19:22:31.606748 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:22:31.607716 [info ] [MainThread]: 
[0m19:22:31.611716 [debug] [Thread-1 (]: Began running node model.merchant_data_project.test_connection
[0m19:22:31.611716 [info ] [Thread-1 (]: 1 of 1 START sql view model public.test_connection ............................. [RUN]
[0m19:22:31.612798 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.merchant_data_project.test_connection'
[0m19:22:31.613717 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.test_connection
[0m19:22:31.660307 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.test_connection"
[0m19:22:31.661313 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.test_connection
[0m19:22:31.690320 [debug] [Thread-1 (]: Writing runtime sql for node "model.merchant_data_project.test_connection"
[0m19:22:31.691227 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.test_connection"
[0m19:22:31.692231 [debug] [Thread-1 (]: On model.merchant_data_project.test_connection: BEGIN
[0m19:22:31.692231 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:22:31.723764 [debug] [Thread-1 (]: SQL status: BEGIN in 0.031 seconds
[0m19:22:31.723764 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.test_connection"
[0m19:22:31.724834 [debug] [Thread-1 (]: On model.merchant_data_project.test_connection: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.test_connection"} */

  create view "merchant_data"."public"."test_connection__dbt_tmp"
    
    
  as (
    SELECT *
FROM public.merchant_status
LIMIT 10
  );
[0m19:22:31.729842 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m19:22:31.733908 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.test_connection"
[0m19:22:31.734811 [debug] [Thread-1 (]: On model.merchant_data_project.test_connection: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.test_connection"} */
alter table "merchant_data"."public"."test_connection__dbt_tmp" rename to "test_connection"
[0m19:22:31.734811 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:22:31.745589 [debug] [Thread-1 (]: On model.merchant_data_project.test_connection: COMMIT
[0m19:22:31.746594 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.test_connection"
[0m19:22:31.746594 [debug] [Thread-1 (]: On model.merchant_data_project.test_connection: COMMIT
[0m19:22:31.748654 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:22:31.753741 [debug] [Thread-1 (]: Applying DROP to: "merchant_data"."public"."test_connection__dbt_backup"
[0m19:22:31.757749 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.test_connection"
[0m19:22:31.757749 [debug] [Thread-1 (]: On model.merchant_data_project.test_connection: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.test_connection"} */
drop view if exists "merchant_data"."public"."test_connection__dbt_backup" cascade
[0m19:22:31.758663 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m19:22:31.759775 [debug] [Thread-1 (]: On model.merchant_data_project.test_connection: Close
[0m19:22:31.761665 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49b65cea-650e-453c-a773-19c8adbdc83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD8C1D15B0>]}
[0m19:22:31.761665 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.test_connection ........................ [[32mCREATE VIEW[0m in 0.15s]
[0m19:22:31.762663 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.test_connection
[0m19:22:31.763664 [debug] [MainThread]: Using postgres connection "master"
[0m19:22:31.764665 [debug] [MainThread]: On master: BEGIN
[0m19:22:31.764665 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:22:31.796117 [debug] [MainThread]: SQL status: BEGIN in 0.032 seconds
[0m19:22:31.797203 [debug] [MainThread]: On master: COMMIT
[0m19:22:31.797203 [debug] [MainThread]: Using postgres connection "master"
[0m19:22:31.797203 [debug] [MainThread]: On master: COMMIT
[0m19:22:31.798117 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:22:31.798117 [debug] [MainThread]: On master: Close
[0m19:22:31.798117 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:22:31.798117 [debug] [MainThread]: Connection 'list_merchant_data' was properly closed.
[0m19:22:31.799115 [debug] [MainThread]: Connection 'list_merchant_data_public' was properly closed.
[0m19:22:31.799115 [debug] [MainThread]: Connection 'model.merchant_data_project.test_connection' was properly closed.
[0m19:22:31.799115 [info ] [MainThread]: 
[0m19:22:31.800115 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m19:22:31.801117 [debug] [MainThread]: Command end result
[0m19:22:31.826214 [info ] [MainThread]: 
[0m19:22:31.827118 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:22:31.828121 [info ] [MainThread]: 
[0m19:22:31.829117 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:22:31.830211 [debug] [MainThread]: Command `dbt run` succeeded at 19:22:31.830211 after 1.69 seconds
[0m19:22:31.830211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD887BE720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD8BD74BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD8CD7C9B0>]}
[0m19:22:31.830211 [debug] [MainThread]: Flushing usage events
[0m19:27:06.130984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029FA787E780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029FA787C8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029FA76C6660>]}


============================== 19:27:06.133984 | 1289bbfe-7697-40c3-b87a-530aed897a49 ==============================
[0m19:27:06.133984 [info ] [MainThread]: Running with dbt=1.8.8
[0m19:27:06.134987 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\alvaro\\Desktop\\sumup_assignment\\merchant_data_project\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\alvaro\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select test_connection', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:27:06.305500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1289bbfe-7697-40c3-b87a-530aed897a49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029FA4FEB680>]}
[0m19:27:06.353296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1289bbfe-7697-40c3-b87a-530aed897a49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029FA7487740>]}
[0m19:27:06.354298 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:27:06.361212 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m19:27:06.477716 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:27:06.477716 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:27:06.481717 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.merchant_data_project.example
[0m19:27:06.510807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1289bbfe-7697-40c3-b87a-530aed897a49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029FA80437D0>]}
[0m19:27:06.592426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1289bbfe-7697-40c3-b87a-530aed897a49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029FA81DB9B0>]}
[0m19:27:06.593427 [info ] [MainThread]: Found 1 model, 10 sources, 423 macros
[0m19:27:06.593427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1289bbfe-7697-40c3-b87a-530aed897a49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029FA80345C0>]}
[0m19:27:06.595426 [info ] [MainThread]: 
[0m19:27:06.596426 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:27:06.597516 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merchant_data'
[0m19:27:06.652045 [debug] [ThreadPool]: Using postgres connection "list_merchant_data"
[0m19:27:06.652045 [debug] [ThreadPool]: On list_merchant_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "list_merchant_data"} */

    select distinct nspname from pg_namespace
  
[0m19:27:06.653042 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:27:06.692066 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.039 seconds
[0m19:27:06.693067 [debug] [ThreadPool]: On list_merchant_data: Close
[0m19:27:06.695067 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merchant_data_public'
[0m19:27:06.699176 [debug] [ThreadPool]: Using postgres connection "list_merchant_data_public"
[0m19:27:06.700160 [debug] [ThreadPool]: On list_merchant_data_public: BEGIN
[0m19:27:06.700160 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:27:06.730925 [debug] [ThreadPool]: SQL status: BEGIN in 0.031 seconds
[0m19:27:06.732070 [debug] [ThreadPool]: Using postgres connection "list_merchant_data_public"
[0m19:27:06.733011 [debug] [ThreadPool]: On list_merchant_data_public: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "list_merchant_data_public"} */
select
      'merchant_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'merchant_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'merchant_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:27:06.738928 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.006 seconds
[0m19:27:06.740029 [debug] [ThreadPool]: On list_merchant_data_public: ROLLBACK
[0m19:27:06.740029 [debug] [ThreadPool]: On list_merchant_data_public: Close
[0m19:27:06.744925 [debug] [MainThread]: Using postgres connection "master"
[0m19:27:06.746034 [debug] [MainThread]: On master: BEGIN
[0m19:27:06.746034 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:27:06.895101 [debug] [MainThread]: SQL status: BEGIN in 0.149 seconds
[0m19:27:06.895101 [debug] [MainThread]: Using postgres connection "master"
[0m19:27:06.895101 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:27:06.905107 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m19:27:06.907106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1289bbfe-7697-40c3-b87a-530aed897a49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029FA80346E0>]}
[0m19:27:06.907106 [debug] [MainThread]: On master: ROLLBACK
[0m19:27:06.909023 [debug] [MainThread]: Using postgres connection "master"
[0m19:27:06.909023 [debug] [MainThread]: On master: BEGIN
[0m19:27:06.910029 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:27:06.910029 [debug] [MainThread]: On master: COMMIT
[0m19:27:06.911033 [debug] [MainThread]: Using postgres connection "master"
[0m19:27:06.911033 [debug] [MainThread]: On master: COMMIT
[0m19:27:06.912030 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:27:06.912030 [debug] [MainThread]: On master: Close
[0m19:27:06.913031 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:27:06.914028 [info ] [MainThread]: 
[0m19:27:06.918028 [debug] [Thread-1 (]: Began running node model.merchant_data_project.test_connection
[0m19:27:06.919027 [info ] [Thread-1 (]: 1 of 1 START sql view model public.test_connection ............................. [RUN]
[0m19:27:06.920038 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.merchant_data_project.test_connection'
[0m19:27:06.920038 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.test_connection
[0m19:27:06.928968 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.test_connection"
[0m19:27:06.929860 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.test_connection
[0m19:27:06.971857 [debug] [Thread-1 (]: Writing runtime sql for node "model.merchant_data_project.test_connection"
[0m19:27:06.973855 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.test_connection"
[0m19:27:06.973855 [debug] [Thread-1 (]: On model.merchant_data_project.test_connection: BEGIN
[0m19:27:06.974857 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:27:07.012150 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m19:27:07.012150 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.test_connection"
[0m19:27:07.013150 [debug] [Thread-1 (]: On model.merchant_data_project.test_connection: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.test_connection"} */

  create view "merchant_data"."public"."test_connection__dbt_tmp"
    
    
  as (
    SELECT *
FROM public.merchant_status
LIMIT 10
  );
[0m19:27:07.018158 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m19:27:07.025943 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.test_connection"
[0m19:27:07.026860 [debug] [Thread-1 (]: On model.merchant_data_project.test_connection: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.test_connection"} */
alter table "merchant_data"."public"."test_connection__dbt_tmp" rename to "test_connection"
[0m19:27:07.027904 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:27:07.039951 [debug] [Thread-1 (]: On model.merchant_data_project.test_connection: COMMIT
[0m19:27:07.040956 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.test_connection"
[0m19:27:07.040956 [debug] [Thread-1 (]: On model.merchant_data_project.test_connection: COMMIT
[0m19:27:07.045906 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m19:27:07.050956 [debug] [Thread-1 (]: Applying DROP to: "merchant_data"."public"."test_connection__dbt_backup"
[0m19:27:07.056956 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.test_connection"
[0m19:27:07.057863 [debug] [Thread-1 (]: On model.merchant_data_project.test_connection: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.test_connection"} */
drop view if exists "merchant_data"."public"."test_connection__dbt_backup" cascade
[0m19:27:07.057863 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m19:27:07.059900 [debug] [Thread-1 (]: On model.merchant_data_project.test_connection: Close
[0m19:27:07.061857 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1289bbfe-7697-40c3-b87a-530aed897a49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029FA482C650>]}
[0m19:27:07.061857 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.test_connection ........................ [[32mCREATE VIEW[0m in 0.14s]
[0m19:27:07.062858 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.test_connection
[0m19:27:07.063857 [debug] [MainThread]: Using postgres connection "master"
[0m19:27:07.063857 [debug] [MainThread]: On master: BEGIN
[0m19:27:07.064865 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:27:07.097819 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m19:27:07.097819 [debug] [MainThread]: On master: COMMIT
[0m19:27:07.098814 [debug] [MainThread]: Using postgres connection "master"
[0m19:27:07.098814 [debug] [MainThread]: On master: COMMIT
[0m19:27:07.098814 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:27:07.099820 [debug] [MainThread]: On master: Close
[0m19:27:07.099820 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:27:07.099820 [debug] [MainThread]: Connection 'list_merchant_data' was properly closed.
[0m19:27:07.100812 [debug] [MainThread]: Connection 'list_merchant_data_public' was properly closed.
[0m19:27:07.100812 [debug] [MainThread]: Connection 'model.merchant_data_project.test_connection' was properly closed.
[0m19:27:07.100812 [info ] [MainThread]: 
[0m19:27:07.101812 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m19:27:07.101812 [debug] [MainThread]: Command end result
[0m19:27:07.128492 [info ] [MainThread]: 
[0m19:27:07.128492 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:27:07.129486 [info ] [MainThread]: 
[0m19:27:07.130487 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:27:07.131489 [debug] [MainThread]: Command `dbt run` succeeded at 19:27:07.131489 after 1.11 seconds
[0m19:27:07.131489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029FA7655CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029FA482C650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029FA77F6DE0>]}
[0m19:27:07.131489 [debug] [MainThread]: Flushing usage events
[0m19:48:12.217732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284D15CDAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284D15CD430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284D1284380>]}


============================== 19:48:12.221644 | 0a9f992b-a083-4439-8284-cecda9bb6c6e ==============================
[0m19:48:12.221644 [info ] [MainThread]: Running with dbt=1.8.8
[0m19:48:12.222645 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alvaro\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\alvaro\\Desktop\\sumup_assignment\\merchant_data_project\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m19:48:12.236301 [info ] [MainThread]: dbt version: 1.8.8
[0m19:48:12.237309 [info ] [MainThread]: python version: 3.12.7
[0m19:48:12.237309 [info ] [MainThread]: python path: C:\Users\alvaro\Desktop\sumup_assignment\dbt-sumup\Scripts\python.exe
[0m19:48:12.238316 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m19:48:12.323483 [info ] [MainThread]: Using profiles dir at C:\Users\alvaro\.dbt
[0m19:48:12.324456 [info ] [MainThread]: Using profiles.yml file at C:\Users\alvaro\.dbt\profiles.yml
[0m19:48:12.324456 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\alvaro\Desktop\sumup_assignment\merchant_data_project\dbt_project.yml
[0m19:48:12.326474 [info ] [MainThread]: adapter type: postgres
[0m19:48:12.326474 [info ] [MainThread]: adapter version: 1.8.2
[0m19:48:12.395998 [info ] [MainThread]: Configuration:
[0m19:48:12.396908 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:48:12.397910 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:48:12.397910 [info ] [MainThread]: Required dependencies:
[0m19:48:12.398929 [debug] [MainThread]: Executing "git --help"
[0m19:48:12.426925 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:48:12.427916 [debug] [MainThread]: STDERR: "b''"
[0m19:48:12.427916 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:48:12.428933 [info ] [MainThread]: Connection:
[0m19:48:12.428933 [info ] [MainThread]:   host: localhost
[0m19:48:12.428933 [info ] [MainThread]:   port: 5432
[0m19:48:12.430439 [info ] [MainThread]:   user: postgres
[0m19:48:12.430439 [info ] [MainThread]:   database: merchant_data
[0m19:48:12.431445 [info ] [MainThread]:   schema: public
[0m19:48:12.431445 [info ] [MainThread]:   connect_timeout: 10
[0m19:48:12.431445 [info ] [MainThread]:   role: None
[0m19:48:12.432444 [info ] [MainThread]:   search_path: None
[0m19:48:12.432444 [info ] [MainThread]:   keepalives_idle: 0
[0m19:48:12.433445 [info ] [MainThread]:   sslmode: None
[0m19:48:12.433445 [info ] [MainThread]:   sslcert: None
[0m19:48:12.433445 [info ] [MainThread]:   sslkey: None
[0m19:48:12.434444 [info ] [MainThread]:   sslrootcert: None
[0m19:48:12.434444 [info ] [MainThread]:   application_name: dbt
[0m19:48:12.434444 [info ] [MainThread]:   retries: 1
[0m19:48:12.435444 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:48:12.435444 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m19:48:12.479795 [debug] [MainThread]: Using postgres connection "debug"
[0m19:48:12.480792 [debug] [MainThread]: On debug: select 1 as id
[0m19:48:12.480792 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:48:12.516803 [debug] [MainThread]: SQL status: SELECT 1 in 0.035 seconds
[0m19:48:12.516803 [debug] [MainThread]: On debug: Close
[0m19:48:12.517804 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:48:12.518800 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:48:12.519800 [debug] [MainThread]: Command `dbt debug` succeeded at 19:48:12.519800 after 0.40 seconds
[0m19:48:12.519800 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:48:12.520894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284D19FB800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284D19F8B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284D09D3FB0>]}
[0m19:48:12.520894 [debug] [MainThread]: Flushing usage events
[0m20:21:07.562979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC7EF236B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC7E649400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC7EDC67B0>]}


============================== 20:21:07.565978 | 2f14c8be-099c-4344-b31d-d06d53b4c7c8 ==============================
[0m20:21:07.565978 [info ] [MainThread]: Running with dbt=1.8.8
[0m20:21:07.566981 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alvaro\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\alvaro\\Desktop\\sumup_assignment\\merchant_data_project\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select account_statuses', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:21:07.731616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f14c8be-099c-4344-b31d-d06d53b4c7c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC7F2ED640>]}
[0m20:21:07.775311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f14c8be-099c-4344-b31d-d06d53b4c7c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC7EF224E0>]}
[0m20:21:07.777322 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:21:07.784313 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m20:21:07.916022 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m20:21:07.916022 [debug] [MainThread]: Partial parsing: added file: merchant_data_project://models\staging\account_statuses.sql
[0m20:21:07.917023 [debug] [MainThread]: Partial parsing: deleted file: merchant_data_project://models\test_connection.sql
[0m20:21:08.067128 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.merchant_data_project.account_statuses' (models\staging\account_statuses.sql) depends on a source named 'merchant_data.account_statuses' which was not found
[0m20:21:08.069197 [debug] [MainThread]: Command `dbt run` failed at 20:21:08.068117 after 0.62 seconds
[0m20:21:08.069197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC7EDF3800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC7F45DDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC7FABA660>]}
[0m20:21:08.070122 [debug] [MainThread]: Flushing usage events
[0m20:24:07.005758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A56227E630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5615E7800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A56227D250>]}


============================== 20:24:07.008483 | 04e8d735-447b-438e-a6f5-d7b230576261 ==============================
[0m20:24:07.008483 [info ] [MainThread]: Running with dbt=1.8.8
[0m20:24:07.009409 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alvaro\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\alvaro\\Desktop\\sumup_assignment\\merchant_data_project\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select account_statuses', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:24:07.175111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04e8d735-447b-438e-a6f5-d7b230576261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A55FD0C890>]}
[0m20:24:07.220237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '04e8d735-447b-438e-a6f5-d7b230576261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5610E9310>]}
[0m20:24:07.221256 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:24:07.228324 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m20:24:07.361139 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m20:24:07.362162 [debug] [MainThread]: Partial parsing: added file: merchant_data_project://models\staging\account_statuses.sql
[0m20:24:07.363133 [debug] [MainThread]: Partial parsing: updated file: merchant_data_project://models\src_payment.yml
[0m20:24:07.363133 [debug] [MainThread]: Partial parsing: deleted file: merchant_data_project://models\test_connection.sql
[0m20:24:07.639868 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.merchant_data_project.example
[0m20:24:07.649870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04e8d735-447b-438e-a6f5-d7b230576261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5631C8590>]}
[0m20:24:07.730383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04e8d735-447b-438e-a6f5-d7b230576261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5632DA8D0>]}
[0m20:24:07.730383 [info ] [MainThread]: Found 1 model, 10 sources, 423 macros
[0m20:24:07.731388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04e8d735-447b-438e-a6f5-d7b230576261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5619A3FB0>]}
[0m20:24:07.732505 [info ] [MainThread]: 
[0m20:24:07.733484 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:24:07.734484 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merchant_data'
[0m20:24:07.789386 [debug] [ThreadPool]: Using postgres connection "list_merchant_data"
[0m20:24:07.789386 [debug] [ThreadPool]: On list_merchant_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "list_merchant_data"} */

    select distinct nspname from pg_namespace
  
[0m20:24:07.790387 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:24:07.829683 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.040 seconds
[0m20:24:07.830777 [debug] [ThreadPool]: On list_merchant_data: Close
[0m20:24:07.832681 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merchant_data_public'
[0m20:24:07.837681 [debug] [ThreadPool]: Using postgres connection "list_merchant_data_public"
[0m20:24:07.837681 [debug] [ThreadPool]: On list_merchant_data_public: BEGIN
[0m20:24:07.837681 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:24:07.871632 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m20:24:07.872632 [debug] [ThreadPool]: Using postgres connection "list_merchant_data_public"
[0m20:24:07.872632 [debug] [ThreadPool]: On list_merchant_data_public: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "list_merchant_data_public"} */
select
      'merchant_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'merchant_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'merchant_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:24:07.879633 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.007 seconds
[0m20:24:07.880737 [debug] [ThreadPool]: On list_merchant_data_public: ROLLBACK
[0m20:24:07.881701 [debug] [ThreadPool]: On list_merchant_data_public: Close
[0m20:24:07.887628 [debug] [MainThread]: Using postgres connection "master"
[0m20:24:07.887628 [debug] [MainThread]: On master: BEGIN
[0m20:24:07.888627 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:24:07.925180 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m20:24:07.925180 [debug] [MainThread]: Using postgres connection "master"
[0m20:24:07.925180 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:24:07.934220 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m20:24:07.934220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04e8d735-447b-438e-a6f5-d7b230576261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5629C6870>]}
[0m20:24:07.935241 [debug] [MainThread]: On master: ROLLBACK
[0m20:24:07.936193 [debug] [MainThread]: Using postgres connection "master"
[0m20:24:07.936193 [debug] [MainThread]: On master: BEGIN
[0m20:24:07.937154 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:24:07.937154 [debug] [MainThread]: On master: COMMIT
[0m20:24:07.938155 [debug] [MainThread]: Using postgres connection "master"
[0m20:24:07.938155 [debug] [MainThread]: On master: COMMIT
[0m20:24:07.939159 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:24:07.939159 [debug] [MainThread]: On master: Close
[0m20:24:07.939159 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:24:07.940159 [info ] [MainThread]: 
[0m20:24:07.945167 [debug] [Thread-1 (]: Began running node model.merchant_data_project.account_statuses
[0m20:24:07.945167 [info ] [Thread-1 (]: 1 of 1 START sql view model public.account_statuses ............................ [RUN]
[0m20:24:07.947156 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.merchant_data_project.account_statuses'
[0m20:24:07.947156 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.account_statuses
[0m20:24:07.956547 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.account_statuses"
[0m20:24:07.958553 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.account_statuses
[0m20:24:07.996692 [debug] [Thread-1 (]: Writing runtime sql for node "model.merchant_data_project.account_statuses"
[0m20:24:07.998770 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m20:24:07.999698 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: BEGIN
[0m20:24:07.999698 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:24:08.036311 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m20:24:08.037278 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m20:24:08.037278 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.account_statuses"} */

  create view "merchant_data"."public"."account_statuses__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "merchant_data"."public"."account_statuses"
  );
[0m20:24:08.043276 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m20:24:08.048270 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m20:24:08.049271 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.account_statuses"} */
alter table "merchant_data"."public"."account_statuses" rename to "account_statuses__dbt_backup"
[0m20:24:08.049271 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:24:08.051275 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m20:24:08.052274 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.account_statuses"} */
alter table "merchant_data"."public"."account_statuses__dbt_tmp" rename to "account_statuses"
[0m20:24:08.052274 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:24:08.066396 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: COMMIT
[0m20:24:08.066396 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m20:24:08.067371 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: COMMIT
[0m20:24:08.069271 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:24:08.074363 [debug] [Thread-1 (]: Applying DROP to: "merchant_data"."public"."account_statuses__dbt_backup"
[0m20:24:08.077361 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m20:24:08.078358 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.account_statuses"} */
drop table if exists "merchant_data"."public"."account_statuses__dbt_backup" cascade
[0m20:24:08.083275 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m20:24:08.085365 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: Close
[0m20:24:08.086274 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04e8d735-447b-438e-a6f5-d7b230576261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A563915970>]}
[0m20:24:08.086274 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.account_statuses ....................... [[32mCREATE VIEW[0m in 0.14s]
[0m20:24:08.087275 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.account_statuses
[0m20:24:08.089279 [debug] [MainThread]: Using postgres connection "master"
[0m20:24:08.089279 [debug] [MainThread]: On master: BEGIN
[0m20:24:08.089279 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:24:08.128448 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m20:24:08.128448 [debug] [MainThread]: On master: COMMIT
[0m20:24:08.128448 [debug] [MainThread]: Using postgres connection "master"
[0m20:24:08.129448 [debug] [MainThread]: On master: COMMIT
[0m20:24:08.129448 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:24:08.129448 [debug] [MainThread]: On master: Close
[0m20:24:08.130448 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:24:08.130448 [debug] [MainThread]: Connection 'list_merchant_data' was properly closed.
[0m20:24:08.130448 [debug] [MainThread]: Connection 'list_merchant_data_public' was properly closed.
[0m20:24:08.131443 [debug] [MainThread]: Connection 'model.merchant_data_project.account_statuses' was properly closed.
[0m20:24:08.131443 [info ] [MainThread]: 
[0m20:24:08.132462 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m20:24:08.133680 [debug] [MainThread]: Command end result
[0m20:24:08.159724 [info ] [MainThread]: 
[0m20:24:08.160727 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:24:08.161688 [info ] [MainThread]: 
[0m20:24:08.162686 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:24:08.163690 [debug] [MainThread]: Command `dbt run` succeeded at 20:24:08.163690 after 1.30 seconds
[0m20:24:08.163690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A562A376E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A562244F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A562244770>]}
[0m20:24:08.164771 [debug] [MainThread]: Flushing usage events
[0m20:34:08.092470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E39E4C7C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3A143A0F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3A137C5F0>]}


============================== 20:34:08.095539 | 6b60ca53-4bf2-4a02-aa55-2cdcb3a8fee9 ==============================
[0m20:34:08.095539 [info ] [MainThread]: Running with dbt=1.8.8
[0m20:34:08.096477 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\alvaro\\.dbt', 'log_path': 'C:\\Users\\alvaro\\Desktop\\sumup_assignment\\merchant_data_project\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select account_statuses', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:34:08.291412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b60ca53-4bf2-4a02-aa55-2cdcb3a8fee9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3A240C8C0>]}
[0m20:34:08.339087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b60ca53-4bf2-4a02-aa55-2cdcb3a8fee9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3A21EE960>]}
[0m20:34:08.340096 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:34:08.346003 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m20:34:08.479600 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:34:08.480609 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:34:08.484564 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.merchant_data_project.example
[0m20:34:08.511781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b60ca53-4bf2-4a02-aa55-2cdcb3a8fee9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3A1E238F0>]}
[0m20:34:08.594149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b60ca53-4bf2-4a02-aa55-2cdcb3a8fee9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3A29D35F0>]}
[0m20:34:08.594149 [info ] [MainThread]: Found 1 model, 10 sources, 423 macros
[0m20:34:08.595190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b60ca53-4bf2-4a02-aa55-2cdcb3a8fee9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3A2516690>]}
[0m20:34:08.596251 [info ] [MainThread]: 
[0m20:34:08.597238 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:34:08.598787 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merchant_data'
[0m20:34:08.666840 [debug] [ThreadPool]: Using postgres connection "list_merchant_data"
[0m20:34:08.667815 [debug] [ThreadPool]: On list_merchant_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "list_merchant_data"} */

    select distinct nspname from pg_namespace
  
[0m20:34:08.667815 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:34:08.707759 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.040 seconds
[0m20:34:08.709760 [debug] [ThreadPool]: On list_merchant_data: Close
[0m20:34:08.711755 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merchant_data_public'
[0m20:34:08.716755 [debug] [ThreadPool]: Using postgres connection "list_merchant_data_public"
[0m20:34:08.716755 [debug] [ThreadPool]: On list_merchant_data_public: BEGIN
[0m20:34:08.716755 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:34:08.752908 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m20:34:08.753999 [debug] [ThreadPool]: Using postgres connection "list_merchant_data_public"
[0m20:34:08.753999 [debug] [ThreadPool]: On list_merchant_data_public: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "list_merchant_data_public"} */
select
      'merchant_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'merchant_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'merchant_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:34:08.761008 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.007 seconds
[0m20:34:08.762093 [debug] [ThreadPool]: On list_merchant_data_public: ROLLBACK
[0m20:34:08.763097 [debug] [ThreadPool]: On list_merchant_data_public: Close
[0m20:34:08.768007 [debug] [MainThread]: Using postgres connection "master"
[0m20:34:08.769090 [debug] [MainThread]: On master: BEGIN
[0m20:34:08.769090 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:34:08.803838 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m20:34:08.804942 [debug] [MainThread]: Using postgres connection "master"
[0m20:34:08.804942 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:34:08.812994 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m20:34:08.813884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b60ca53-4bf2-4a02-aa55-2cdcb3a8fee9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3A29E0110>]}
[0m20:34:08.814883 [debug] [MainThread]: On master: ROLLBACK
[0m20:34:08.814883 [debug] [MainThread]: Using postgres connection "master"
[0m20:34:08.814883 [debug] [MainThread]: On master: BEGIN
[0m20:34:08.815975 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:34:08.816899 [debug] [MainThread]: On master: COMMIT
[0m20:34:08.816899 [debug] [MainThread]: Using postgres connection "master"
[0m20:34:08.816899 [debug] [MainThread]: On master: COMMIT
[0m20:34:08.817983 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:34:08.817983 [debug] [MainThread]: On master: Close
[0m20:34:08.818982 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:34:08.819884 [info ] [MainThread]: 
[0m20:34:08.823972 [debug] [Thread-1 (]: Began running node model.merchant_data_project.account_statuses
[0m20:34:08.823972 [info ] [Thread-1 (]: 1 of 1 START sql view model public.account_statuses ............................ [RUN]
[0m20:34:08.824900 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.merchant_data_project.account_statuses'
[0m20:34:08.825993 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.account_statuses
[0m20:34:08.835972 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.account_statuses"
[0m20:34:08.836998 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.account_statuses
[0m20:34:08.873435 [debug] [Thread-1 (]: Writing runtime sql for node "model.merchant_data_project.account_statuses"
[0m20:34:08.875440 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m20:34:08.875440 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: BEGIN
[0m20:34:08.875440 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:34:08.911062 [debug] [Thread-1 (]: SQL status: BEGIN in 0.035 seconds
[0m20:34:08.911062 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m20:34:08.911062 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.account_statuses"} */

  create view "merchant_data"."public"."account_statuses__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "merchant_data"."public"."account_statuses"
  );
[0m20:34:08.917058 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m20:34:08.922176 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m20:34:08.922176 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.account_statuses"} */
alter table "merchant_data"."public"."account_statuses" rename to "account_statuses__dbt_backup"
[0m20:34:08.923143 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:34:08.925151 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m20:34:08.925151 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.account_statuses"} */
alter table "merchant_data"."public"."account_statuses__dbt_tmp" rename to "account_statuses"
[0m20:34:08.926172 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:34:08.938177 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: COMMIT
[0m20:34:08.939151 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m20:34:08.939151 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: COMMIT
[0m20:34:08.967785 [debug] [Thread-1 (]: SQL status: COMMIT in 0.028 seconds
[0m20:34:08.972926 [debug] [Thread-1 (]: Applying DROP to: "merchant_data"."public"."account_statuses__dbt_backup"
[0m20:34:08.976879 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m20:34:08.976879 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.account_statuses"} */
drop table if exists "merchant_data"."public"."account_statuses__dbt_backup" cascade
[0m20:34:08.982829 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m20:34:08.984922 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: Close
[0m20:34:08.985831 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b60ca53-4bf2-4a02-aa55-2cdcb3a8fee9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E39EE2C860>]}
[0m20:34:08.986830 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.account_statuses ....................... [[32mCREATE VIEW[0m in 0.16s]
[0m20:34:08.987830 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.account_statuses
[0m20:34:08.988849 [debug] [MainThread]: Using postgres connection "master"
[0m20:34:08.989835 [debug] [MainThread]: On master: BEGIN
[0m20:34:08.989835 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:34:09.135934 [debug] [MainThread]: SQL status: BEGIN in 0.147 seconds
[0m20:34:09.150211 [debug] [MainThread]: On master: COMMIT
[0m20:34:09.151232 [debug] [MainThread]: Using postgres connection "master"
[0m20:34:09.151232 [debug] [MainThread]: On master: COMMIT
[0m20:34:09.152224 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:34:09.152224 [debug] [MainThread]: On master: Close
[0m20:34:09.153236 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:34:09.153236 [debug] [MainThread]: Connection 'list_merchant_data' was properly closed.
[0m20:34:09.153236 [debug] [MainThread]: Connection 'list_merchant_data_public' was properly closed.
[0m20:34:09.153236 [debug] [MainThread]: Connection 'model.merchant_data_project.account_statuses' was properly closed.
[0m20:34:09.153236 [info ] [MainThread]: 
[0m20:34:09.154693 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m20:34:09.155791 [debug] [MainThread]: Command end result
[0m20:34:09.182819 [info ] [MainThread]: 
[0m20:34:09.183799 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:34:09.184804 [info ] [MainThread]: 
[0m20:34:09.186812 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:34:09.187822 [debug] [MainThread]: Command `dbt run` succeeded at 20:34:09.187822 after 1.22 seconds
[0m20:34:09.187822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E39DC2C1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E39EF223C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3A24E2CF0>]}
[0m20:34:09.188806 [debug] [MainThread]: Flushing usage events
[0m20:40:06.461444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223A31EEBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002239EFFC920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223A31C9280>]}


============================== 20:40:06.464444 | 2019479b-f755-4ea2-ad9b-f6e8f1f1501b ==============================
[0m20:40:06.464444 [info ] [MainThread]: Running with dbt=1.8.8
[0m20:40:06.465444 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\alvaro\\Desktop\\sumup_assignment\\merchant_data_project\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\alvaro\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select account_statuses', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:40:06.632700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2019479b-f755-4ea2-ad9b-f6e8f1f1501b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223A31EEBD0>]}
[0m20:40:06.678613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2019479b-f755-4ea2-ad9b-f6e8f1f1501b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223A0495040>]}
[0m20:40:06.679614 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:40:06.685611 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m20:40:06.805400 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:40:06.805400 [debug] [MainThread]: Partial parsing: updated file: merchant_data_project://models\staging\account_statuses.sql
[0m20:40:06.995063 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.merchant_data_project.example
[0m20:40:07.007508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2019479b-f755-4ea2-ad9b-f6e8f1f1501b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223A37E1910>]}
[0m20:40:07.087790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2019479b-f755-4ea2-ad9b-f6e8f1f1501b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223A3AF1F70>]}
[0m20:40:07.088792 [info ] [MainThread]: Found 1 model, 10 sources, 423 macros
[0m20:40:07.088792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2019479b-f755-4ea2-ad9b-f6e8f1f1501b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223A3793A10>]}
[0m20:40:07.090790 [info ] [MainThread]: 
[0m20:40:07.090790 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:40:07.091793 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merchant_data'
[0m20:40:07.147234 [debug] [ThreadPool]: Using postgres connection "list_merchant_data"
[0m20:40:07.147234 [debug] [ThreadPool]: On list_merchant_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "list_merchant_data"} */

    select distinct nspname from pg_namespace
  
[0m20:40:07.147234 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:40:07.187458 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.040 seconds
[0m20:40:07.189563 [debug] [ThreadPool]: On list_merchant_data: Close
[0m20:40:07.190474 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merchant_data_public'
[0m20:40:07.196475 [debug] [ThreadPool]: Using postgres connection "list_merchant_data_public"
[0m20:40:07.196475 [debug] [ThreadPool]: On list_merchant_data_public: BEGIN
[0m20:40:07.196475 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:40:07.229030 [debug] [ThreadPool]: SQL status: BEGIN in 0.032 seconds
[0m20:40:07.229030 [debug] [ThreadPool]: Using postgres connection "list_merchant_data_public"
[0m20:40:07.230030 [debug] [ThreadPool]: On list_merchant_data_public: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "list_merchant_data_public"} */
select
      'merchant_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'merchant_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'merchant_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:40:07.237548 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.007 seconds
[0m20:40:07.238548 [debug] [ThreadPool]: On list_merchant_data_public: ROLLBACK
[0m20:40:07.238548 [debug] [ThreadPool]: On list_merchant_data_public: Close
[0m20:40:07.245959 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:07.245959 [debug] [MainThread]: On master: BEGIN
[0m20:40:07.245959 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:40:07.281934 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m20:40:07.283037 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:07.283037 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:40:07.292946 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m20:40:07.293946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2019479b-f755-4ea2-ad9b-f6e8f1f1501b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223A41F4A10>]}
[0m20:40:07.293946 [debug] [MainThread]: On master: ROLLBACK
[0m20:40:07.293946 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:07.294993 [debug] [MainThread]: On master: BEGIN
[0m20:40:07.295951 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:40:07.295951 [debug] [MainThread]: On master: COMMIT
[0m20:40:07.295951 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:07.295951 [debug] [MainThread]: On master: COMMIT
[0m20:40:07.297031 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:40:07.297031 [debug] [MainThread]: On master: Close
[0m20:40:07.297949 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:40:07.298946 [info ] [MainThread]: 
[0m20:40:07.302942 [debug] [Thread-1 (]: Began running node model.merchant_data_project.account_statuses
[0m20:40:07.304028 [info ] [Thread-1 (]: 1 of 1 START sql view model public.account_statuses ............................ [RUN]
[0m20:40:07.304941 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.merchant_data_project.account_statuses'
[0m20:40:07.304941 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.account_statuses
[0m20:40:07.313036 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.account_statuses"
[0m20:40:07.314050 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.account_statuses
[0m20:40:07.347679 [debug] [Thread-1 (]: Writing runtime sql for node "model.merchant_data_project.account_statuses"
[0m20:40:07.349662 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m20:40:07.349662 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: BEGIN
[0m20:40:07.350651 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:40:07.385652 [debug] [Thread-1 (]: SQL status: BEGIN in 0.035 seconds
[0m20:40:07.386743 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m20:40:07.386743 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.account_statuses"} */

  create view "merchant_data"."public"."account_statuses__dbt_tmp"
    
    
  as (
    SELECT status
FROM "merchant_data"."public"."account_statuses"
  );
[0m20:40:07.393053 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m20:40:07.398753 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m20:40:07.398753 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.account_statuses"} */
alter table "merchant_data"."public"."account_statuses" rename to "account_statuses__dbt_backup"
[0m20:40:07.399924 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:40:07.402052 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m20:40:07.403165 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.account_statuses"} */
alter table "merchant_data"."public"."account_statuses__dbt_tmp" rename to "account_statuses"
[0m20:40:07.403314 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:40:07.416770 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: COMMIT
[0m20:40:07.417774 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m20:40:07.418869 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: COMMIT
[0m20:40:07.420794 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:40:07.425783 [debug] [Thread-1 (]: Applying DROP to: "merchant_data"."public"."account_statuses__dbt_backup"
[0m20:40:07.429783 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m20:40:07.429783 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.account_statuses"} */
drop table if exists "merchant_data"."public"."account_statuses__dbt_backup" cascade
[0m20:40:07.435303 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m20:40:07.437391 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: Close
[0m20:40:07.439394 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2019479b-f755-4ea2-ad9b-f6e8f1f1501b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223A29D1640>]}
[0m20:40:07.439394 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.account_statuses ....................... [[32mCREATE VIEW[0m in 0.13s]
[0m20:40:07.440304 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.account_statuses
[0m20:40:07.442302 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:07.442302 [debug] [MainThread]: On master: BEGIN
[0m20:40:07.442302 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:40:07.478378 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m20:40:07.478378 [debug] [MainThread]: On master: COMMIT
[0m20:40:07.479472 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:07.480378 [debug] [MainThread]: On master: COMMIT
[0m20:40:07.480378 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:40:07.481405 [debug] [MainThread]: On master: Close
[0m20:40:07.481405 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:40:07.482379 [debug] [MainThread]: Connection 'list_merchant_data' was properly closed.
[0m20:40:07.482379 [debug] [MainThread]: Connection 'list_merchant_data_public' was properly closed.
[0m20:40:07.482379 [debug] [MainThread]: Connection 'model.merchant_data_project.account_statuses' was properly closed.
[0m20:40:07.483377 [info ] [MainThread]: 
[0m20:40:07.484377 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m20:40:07.485383 [debug] [MainThread]: Command end result
[0m20:40:07.513427 [info ] [MainThread]: 
[0m20:40:07.514428 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:40:07.515420 [info ] [MainThread]: 
[0m20:40:07.515420 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:40:07.517480 [debug] [MainThread]: Command `dbt run` succeeded at 20:40:07.516421 after 1.17 seconds
[0m20:40:07.517480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223A357C2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223A0F0C6B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223A35CC9E0>]}
[0m20:40:07.518430 [debug] [MainThread]: Flushing usage events
[0m20:47:10.033206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A957CFA060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A95B168D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A95B168CB0>]}


============================== 20:47:10.037214 | e72c29a2-ccb5-42c4-8653-d10b73df8f96 ==============================
[0m20:47:10.037214 [info ] [MainThread]: Running with dbt=1.8.8
[0m20:47:10.037214 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\alvaro\\.dbt', 'log_path': 'C:\\Users\\alvaro\\Desktop\\sumup_assignment\\merchant_data_project\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select account_statuses', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:47:10.203500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e72c29a2-ccb5-42c4-8653-d10b73df8f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A956C0F9B0>]}
[0m20:47:10.249683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e72c29a2-ccb5-42c4-8653-d10b73df8f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A95BEEFA40>]}
[0m20:47:10.249683 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:47:10.256909 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m20:47:10.319076 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m20:47:10.319978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e72c29a2-ccb5-42c4-8653-d10b73df8f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A95C3F5370>]}
[0m20:47:11.140076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e72c29a2-ccb5-42c4-8653-d10b73df8f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A95C6C13D0>]}
[0m20:47:11.216853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e72c29a2-ccb5-42c4-8653-d10b73df8f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A95CAD5040>]}
[0m20:47:11.217853 [info ] [MainThread]: Found 1 model, 10 sources, 423 macros
[0m20:47:11.218853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e72c29a2-ccb5-42c4-8653-d10b73df8f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A95C742F30>]}
[0m20:47:11.220852 [info ] [MainThread]: 
[0m20:47:11.221852 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:47:11.222891 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merchant_data'
[0m20:47:11.280809 [debug] [ThreadPool]: Using postgres connection "list_merchant_data"
[0m20:47:11.281810 [debug] [ThreadPool]: On list_merchant_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "list_merchant_data"} */

    select distinct nspname from pg_namespace
  
[0m20:47:11.281810 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:47:11.322812 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.041 seconds
[0m20:47:11.324896 [debug] [ThreadPool]: On list_merchant_data: Close
[0m20:47:11.326811 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merchant_data_public'
[0m20:47:11.332917 [debug] [ThreadPool]: Using postgres connection "list_merchant_data_public"
[0m20:47:11.332917 [debug] [ThreadPool]: On list_merchant_data_public: BEGIN
[0m20:47:11.332917 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:47:11.476220 [debug] [ThreadPool]: SQL status: BEGIN in 0.143 seconds
[0m20:47:11.477217 [debug] [ThreadPool]: Using postgres connection "list_merchant_data_public"
[0m20:47:11.477217 [debug] [ThreadPool]: On list_merchant_data_public: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "list_merchant_data_public"} */
select
      'merchant_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'merchant_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'merchant_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:47:11.482218 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.005 seconds
[0m20:47:11.483223 [debug] [ThreadPool]: On list_merchant_data_public: ROLLBACK
[0m20:47:11.483223 [debug] [ThreadPool]: On list_merchant_data_public: Close
[0m20:47:11.526217 [debug] [MainThread]: Using postgres connection "master"
[0m20:47:11.527217 [debug] [MainThread]: On master: BEGIN
[0m20:47:11.527217 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:47:11.564183 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m20:47:11.564183 [debug] [MainThread]: Using postgres connection "master"
[0m20:47:11.564183 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:47:11.571188 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m20:47:11.573190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e72c29a2-ccb5-42c4-8653-d10b73df8f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A958BF3D70>]}
[0m20:47:11.573190 [debug] [MainThread]: On master: ROLLBACK
[0m20:47:11.574204 [debug] [MainThread]: Using postgres connection "master"
[0m20:47:11.574204 [debug] [MainThread]: On master: BEGIN
[0m20:47:11.575185 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:47:11.575185 [debug] [MainThread]: On master: COMMIT
[0m20:47:11.575185 [debug] [MainThread]: Using postgres connection "master"
[0m20:47:11.575185 [debug] [MainThread]: On master: COMMIT
[0m20:47:11.576202 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:47:11.576202 [debug] [MainThread]: On master: Close
[0m20:47:11.576202 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:47:11.577185 [info ] [MainThread]: 
[0m20:47:11.580240 [debug] [Thread-1 (]: Began running node model.merchant_data_project.account_statuses
[0m20:47:11.581294 [info ] [Thread-1 (]: 1 of 1 START sql view model public.account_statuses ............................ [RUN]
[0m20:47:11.582278 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.merchant_data_project.account_statuses'
[0m20:47:11.583280 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.account_statuses
[0m20:47:11.589277 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.account_statuses"
[0m20:47:11.590275 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.account_statuses
[0m20:47:11.628310 [debug] [Thread-1 (]: Writing runtime sql for node "model.merchant_data_project.account_statuses"
[0m20:47:11.630235 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m20:47:11.630235 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: BEGIN
[0m20:47:11.631228 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:47:11.665906 [debug] [Thread-1 (]: SQL status: BEGIN in 0.035 seconds
[0m20:47:11.666977 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m20:47:11.666977 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.account_statuses"} */

  create view "merchant_data"."public"."account_statuses__dbt_tmp"
    
    
  as (
    SELECT *
FROM "merchant_data"."public"."account_statuses"
  );
[0m20:47:11.670894 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m20:47:11.676996 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m20:47:11.676996 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.account_statuses"} */
alter table "merchant_data"."public"."account_statuses" rename to "account_statuses__dbt_backup"
[0m20:47:11.677895 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:47:11.679894 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m20:47:11.679894 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.account_statuses"} */
alter table "merchant_data"."public"."account_statuses__dbt_tmp" rename to "account_statuses"
[0m20:47:11.679894 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:47:11.692984 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: COMMIT
[0m20:47:11.692984 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m20:47:11.693991 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: COMMIT
[0m20:47:11.695922 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:47:11.701999 [debug] [Thread-1 (]: Applying DROP to: "merchant_data"."public"."account_statuses__dbt_backup"
[0m20:47:11.705011 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m20:47:11.705975 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.account_statuses"} */
drop table if exists "merchant_data"."public"."account_statuses__dbt_backup" cascade
[0m20:47:11.710935 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m20:47:11.712896 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: Close
[0m20:47:11.715024 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e72c29a2-ccb5-42c4-8653-d10b73df8f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A958B2C500>]}
[0m20:47:11.715024 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.account_statuses ....................... [[32mCREATE VIEW[0m in 0.13s]
[0m20:47:11.716029 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.account_statuses
[0m20:47:11.717039 [debug] [MainThread]: Using postgres connection "master"
[0m20:47:11.718231 [debug] [MainThread]: On master: BEGIN
[0m20:47:11.718231 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:47:11.756907 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m20:47:11.756907 [debug] [MainThread]: On master: COMMIT
[0m20:47:11.756907 [debug] [MainThread]: Using postgres connection "master"
[0m20:47:11.757906 [debug] [MainThread]: On master: COMMIT
[0m20:47:11.757906 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:47:11.757906 [debug] [MainThread]: On master: Close
[0m20:47:11.758904 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:47:11.758904 [debug] [MainThread]: Connection 'list_merchant_data' was properly closed.
[0m20:47:11.759902 [debug] [MainThread]: Connection 'list_merchant_data_public' was properly closed.
[0m20:47:11.759902 [debug] [MainThread]: Connection 'model.merchant_data_project.account_statuses' was properly closed.
[0m20:47:11.760954 [info ] [MainThread]: 
[0m20:47:11.761996 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m20:47:11.762906 [debug] [MainThread]: Command end result
[0m20:47:11.793902 [info ] [MainThread]: 
[0m20:47:11.794901 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:47:11.794901 [info ] [MainThread]: 
[0m20:47:11.795904 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:47:11.797902 [debug] [MainThread]: Command `dbt run` succeeded at 20:47:11.796903 after 1.87 seconds
[0m20:47:11.797902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A95AC379E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A95BD22540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A95BD20D40>]}
[0m20:47:11.798974 [debug] [MainThread]: Flushing usage events
[0m20:49:31.540443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C489BD820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C491360F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C461410A0>]}


============================== 20:49:31.544453 | c8a7a00f-b48d-40fb-86aa-e1f39aadb8db ==============================
[0m20:49:31.544453 [info ] [MainThread]: Running with dbt=1.8.8
[0m20:49:31.544453 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alvaro\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\alvaro\\Desktop\\sumup_assignment\\merchant_data_project\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select account_statuses', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:49:31.730830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8a7a00f-b48d-40fb-86aa-e1f39aadb8db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C49F7D520>]}
[0m20:49:31.774536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8a7a00f-b48d-40fb-86aa-e1f39aadb8db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C4A3EF9E0>]}
[0m20:49:31.775541 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:49:31.782545 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m20:49:31.850478 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m20:49:31.851472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c8a7a00f-b48d-40fb-86aa-e1f39aadb8db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C496D0260>]}
[0m20:49:32.786865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8a7a00f-b48d-40fb-86aa-e1f39aadb8db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C4A6E14F0>]}
[0m20:49:32.866910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8a7a00f-b48d-40fb-86aa-e1f39aadb8db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C4AE430E0>]}
[0m20:49:32.867910 [info ] [MainThread]: Found 1 model, 10 sources, 423 macros
[0m20:49:32.867910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8a7a00f-b48d-40fb-86aa-e1f39aadb8db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C4AEC1FA0>]}
[0m20:49:32.870009 [info ] [MainThread]: 
[0m20:49:32.870009 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:49:32.871001 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merchant_data'
[0m20:49:32.925918 [debug] [ThreadPool]: Using postgres connection "list_merchant_data"
[0m20:49:32.925918 [debug] [ThreadPool]: On list_merchant_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "list_merchant_data"} */

    select distinct nspname from pg_namespace
  
[0m20:49:32.926929 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:49:32.963885 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.038 seconds
[0m20:49:32.964904 [debug] [ThreadPool]: On list_merchant_data: Close
[0m20:49:32.966883 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merchant_data_public'
[0m20:49:32.973146 [debug] [ThreadPool]: Using postgres connection "list_merchant_data_public"
[0m20:49:32.973146 [debug] [ThreadPool]: On list_merchant_data_public: BEGIN
[0m20:49:32.973146 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:49:33.005751 [debug] [ThreadPool]: SQL status: BEGIN in 0.032 seconds
[0m20:49:33.005751 [debug] [ThreadPool]: Using postgres connection "list_merchant_data_public"
[0m20:49:33.005751 [debug] [ThreadPool]: On list_merchant_data_public: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "list_merchant_data_public"} */
select
      'merchant_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'merchant_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'merchant_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:49:33.012791 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.006 seconds
[0m20:49:33.013694 [debug] [ThreadPool]: On list_merchant_data_public: ROLLBACK
[0m20:49:33.014695 [debug] [ThreadPool]: On list_merchant_data_public: Close
[0m20:49:33.060718 [debug] [MainThread]: Using postgres connection "master"
[0m20:49:33.060718 [debug] [MainThread]: On master: BEGIN
[0m20:49:33.061714 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:49:33.208875 [debug] [MainThread]: SQL status: BEGIN in 0.148 seconds
[0m20:49:33.209858 [debug] [MainThread]: Using postgres connection "master"
[0m20:49:33.209858 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:49:33.218055 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m20:49:33.219056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8a7a00f-b48d-40fb-86aa-e1f39aadb8db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C488D46E0>]}
[0m20:49:33.219056 [debug] [MainThread]: On master: ROLLBACK
[0m20:49:33.219056 [debug] [MainThread]: Using postgres connection "master"
[0m20:49:33.220055 [debug] [MainThread]: On master: BEGIN
[0m20:49:33.220055 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:49:33.220055 [debug] [MainThread]: On master: COMMIT
[0m20:49:33.220055 [debug] [MainThread]: Using postgres connection "master"
[0m20:49:33.221054 [debug] [MainThread]: On master: COMMIT
[0m20:49:33.221054 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:49:33.221054 [debug] [MainThread]: On master: Close
[0m20:49:33.222055 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:49:33.222055 [info ] [MainThread]: 
[0m20:49:33.226318 [debug] [Thread-1 (]: Began running node model.merchant_data_project.account_statuses
[0m20:49:33.226318 [info ] [Thread-1 (]: 1 of 1 START sql incremental model public.account_statuses ..................... [RUN]
[0m20:49:33.227317 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.merchant_data_project.account_statuses'
[0m20:49:33.227317 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.account_statuses
[0m20:49:33.237321 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.account_statuses"
[0m20:49:33.238322 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.account_statuses
[0m20:49:33.289848 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m20:49:33.290848 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.account_statuses"} */

    
  
    

  create temporary table "account_statuses__dbt_tmp204933265852"
  
  
    as
  
  (
    
SELECT *
FROM "merchant_data"."public"."account_statuses"
  );
  
  
[0m20:49:33.290848 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:49:33.330385 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.039 seconds
[0m20:49:33.342414 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m20:49:33.342414 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: BEGIN
[0m20:49:33.343386 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m20:49:33.343386 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m20:49:33.343386 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.account_statuses"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'account_statuses__dbt_tmp204933265852'
        
      order by ordinal_position

  
[0m20:49:33.355299 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.011 seconds
[0m20:49:33.359543 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m20:49:33.359543 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.account_statuses"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "merchant_data".INFORMATION_SCHEMA.columns
      where table_name = 'account_statuses'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:49:33.363088 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.002 seconds
[0m20:49:33.368624 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m20:49:33.368624 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.account_statuses"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "merchant_data".INFORMATION_SCHEMA.columns
      where table_name = 'account_statuses'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:49:33.371978 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.003 seconds
[0m20:49:33.382086 [debug] [Thread-1 (]: Writing runtime sql for node "model.merchant_data_project.account_statuses"
[0m20:49:33.383083 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m20:49:33.384084 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.account_statuses"} */

      insert into "merchant_data"."public"."account_statuses" ("id", "status", "description", "src_created_at", "src_updated_at", "created_at", "updated_at")
    (
        select "id", "status", "description", "src_created_at", "src_updated_at", "created_at", "updated_at"
        from "account_statuses__dbt_tmp204933265852"
    )


  
[0m20:49:33.386083 [debug] [Thread-1 (]: Postgres adapter: Postgres error: duplicate key value violates unique constraint "account_statuses_pkey"
DETAIL:  Key (id)=(1) already exists.

[0m20:49:33.386083 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: ROLLBACK
[0m20:49:33.387100 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: Close
[0m20:49:33.460675 [debug] [Thread-1 (]: Database Error in model account_statuses (models\staging\account_statuses.sql)
  duplicate key value violates unique constraint "account_statuses_pkey"
  DETAIL:  Key (id)=(1) already exists.
  compiled code at target\run\merchant_data_project\models\staging\account_statuses.sql
[0m20:49:33.461667 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8a7a00f-b48d-40fb-86aa-e1f39aadb8db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C496D1580>]}
[0m20:49:33.461667 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model public.account_statuses ............ [[31mERROR[0m in 0.23s]
[0m20:49:33.462654 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.account_statuses
[0m20:49:33.464648 [debug] [MainThread]: Using postgres connection "master"
[0m20:49:33.464648 [debug] [MainThread]: On master: BEGIN
[0m20:49:33.464648 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:49:33.500137 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m20:49:33.501199 [debug] [MainThread]: On master: COMMIT
[0m20:49:33.501199 [debug] [MainThread]: Using postgres connection "master"
[0m20:49:33.502146 [debug] [MainThread]: On master: COMMIT
[0m20:49:33.502146 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:49:33.502146 [debug] [MainThread]: On master: Close
[0m20:49:33.503162 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:49:33.503162 [debug] [MainThread]: Connection 'list_merchant_data' was properly closed.
[0m20:49:33.503162 [debug] [MainThread]: Connection 'list_merchant_data_public' was properly closed.
[0m20:49:33.504140 [debug] [MainThread]: Connection 'model.merchant_data_project.account_statuses' was properly closed.
[0m20:49:33.504140 [info ] [MainThread]: 
[0m20:49:33.505138 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m20:49:33.506142 [debug] [MainThread]: Command end result
[0m20:49:33.531995 [info ] [MainThread]: 
[0m20:49:33.533006 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:49:33.533996 [info ] [MainThread]: 
[0m20:49:33.533996 [error] [MainThread]:   Database Error in model account_statuses (models\staging\account_statuses.sql)
  duplicate key value violates unique constraint "account_statuses_pkey"
  DETAIL:  Key (id)=(1) already exists.
  compiled code at target\run\merchant_data_project\models\staging\account_statuses.sql
[0m20:49:33.534996 [info ] [MainThread]: 
[0m20:49:33.535995 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:49:33.536995 [debug] [MainThread]: Command `dbt run` failed at 20:49:33.536995 after 2.10 seconds
[0m20:49:33.537995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C49EEBFB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C48DE9400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C4AB5D460>]}
[0m20:49:33.537995 [debug] [MainThread]: Flushing usage events
[0m21:33:30.757370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016672B78DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016675D68770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016675D69AF0>]}


============================== 21:33:30.761148 | ff7bff73-1968-4961-a764-a81147a31710 ==============================
[0m21:33:30.761148 [info ] [MainThread]: Running with dbt=1.8.8
[0m21:33:30.761148 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alvaro\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\alvaro\\Desktop\\sumup_assignment\\merchant_data_project\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m21:33:30.772876 [info ] [MainThread]: dbt version: 1.8.8
[0m21:33:30.773874 [info ] [MainThread]: python version: 3.12.7
[0m21:33:30.774874 [info ] [MainThread]: python path: C:\Users\alvaro\Desktop\sumup_assignment\dbt-sumup\Scripts\python.exe
[0m21:33:30.774874 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m21:33:30.777955 [info ] [MainThread]: Using profiles dir at C:\Users\alvaro\.dbt
[0m21:33:30.778967 [info ] [MainThread]: Using profiles.yml file at C:\Users\alvaro\.dbt\profiles.yml
[0m21:33:30.779875 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\alvaro\Desktop\sumup_assignment\merchant_data_project\dbt_project.yml
[0m21:33:30.887153 [info ] [MainThread]: Configuration:
[0m21:33:30.888153 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m21:33:30.889061 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:33:30.890095 [info ] [MainThread]: Required dependencies:
[0m21:33:30.890095 [debug] [MainThread]: Executing "git --help"
[0m21:33:30.921510 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:33:30.922511 [debug] [MainThread]: STDERR: "b''"
[0m21:33:30.922511 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:33:30.924519 [info ] [MainThread]: Connection test skipped since no profile was found
[0m21:33:30.924519 [info ] [MainThread]: [31m1 check failed:[0m
[0m21:33:30.925509 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  The profile 'merchant_data_project' does not have a target named 'public'. The valid target names for this profile are:
   - dev


[0m21:33:30.928602 [debug] [MainThread]: Command `dbt debug` failed at 21:33:30.927513 after 0.29 seconds
[0m21:33:30.928602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016672B78DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016675D6B260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016676AF9940>]}
[0m21:33:30.928602 [debug] [MainThread]: Flushing usage events
[0m21:34:30.290909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D0416F860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D0416EDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D0416E720>]}


============================== 21:34:30.295001 | 55cb7109-9aaa-4adc-9274-ec41b963e9c1 ==============================
[0m21:34:30.295001 [info ] [MainThread]: Running with dbt=1.8.8
[0m21:34:30.295909 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\alvaro\\Desktop\\sumup_assignment\\merchant_data_project\\logs', 'profiles_dir': 'C:\\Users\\alvaro\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:34:30.307990 [info ] [MainThread]: dbt version: 1.8.8
[0m21:34:30.307990 [info ] [MainThread]: python version: 3.12.7
[0m21:34:30.308908 [info ] [MainThread]: python path: C:\Users\alvaro\Desktop\sumup_assignment\dbt-sumup\Scripts\python.exe
[0m21:34:30.309908 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m21:34:30.395771 [info ] [MainThread]: Using profiles dir at C:\Users\alvaro\.dbt
[0m21:34:30.396772 [info ] [MainThread]: Using profiles.yml file at C:\Users\alvaro\.dbt\profiles.yml
[0m21:34:30.396772 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\alvaro\Desktop\sumup_assignment\merchant_data_project\dbt_project.yml
[0m21:34:30.397773 [info ] [MainThread]: adapter type: postgres
[0m21:34:30.398772 [info ] [MainThread]: adapter version: 1.8.2
[0m21:34:30.475484 [info ] [MainThread]: Configuration:
[0m21:34:30.476485 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:34:30.476485 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:34:30.477484 [info ] [MainThread]: Required dependencies:
[0m21:34:30.477484 [debug] [MainThread]: Executing "git --help"
[0m21:34:30.506120 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:34:30.507215 [debug] [MainThread]: STDERR: "b''"
[0m21:34:30.507215 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:34:30.508126 [info ] [MainThread]: Connection:
[0m21:34:30.508126 [info ] [MainThread]:   host: localhost
[0m21:34:30.509126 [info ] [MainThread]:   port: 5432
[0m21:34:30.509126 [info ] [MainThread]:   user: postgres
[0m21:34:30.509126 [info ] [MainThread]:   database: merchant_data
[0m21:34:30.510126 [info ] [MainThread]:   schema: public
[0m21:34:30.510126 [info ] [MainThread]:   connect_timeout: 10
[0m21:34:30.511181 [info ] [MainThread]:   role: None
[0m21:34:30.511181 [info ] [MainThread]:   search_path: None
[0m21:34:30.512182 [info ] [MainThread]:   keepalives_idle: 0
[0m21:34:30.513126 [info ] [MainThread]:   sslmode: None
[0m21:34:30.513126 [info ] [MainThread]:   sslcert: None
[0m21:34:30.514130 [info ] [MainThread]:   sslkey: None
[0m21:34:30.514130 [info ] [MainThread]:   sslrootcert: None
[0m21:34:30.515176 [info ] [MainThread]:   application_name: dbt
[0m21:34:30.515176 [info ] [MainThread]:   retries: 1
[0m21:34:30.516144 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:34:30.517126 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m21:34:30.562222 [debug] [MainThread]: Using postgres connection "debug"
[0m21:34:30.563320 [debug] [MainThread]: On debug: select 1 as id
[0m21:34:30.563320 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:34:30.599155 [debug] [MainThread]: SQL status: SELECT 1 in 0.036 seconds
[0m21:34:30.600235 [debug] [MainThread]: On debug: Close
[0m21:34:30.601143 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:34:30.601143 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:34:30.602147 [debug] [MainThread]: Command `dbt debug` succeeded at 21:34:30.602147 after 0.44 seconds
[0m21:34:30.602147 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:34:30.603576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D04AEBB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D04EA24E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D04DCCC80>]}
[0m21:34:30.603576 [debug] [MainThread]: Flushing usage events
[0m21:35:01.897660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CA00CC6E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CA3C51280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CA3C53740>]}


============================== 21:35:01.900663 | 09292d90-9f27-470b-a614-2eabe701c3ea ==============================
[0m21:35:01.900663 [info ] [MainThread]: Running with dbt=1.8.8
[0m21:35:01.901659 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\alvaro\\Desktop\\sumup_assignment\\merchant_data_project\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\alvaro\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select account_statuses', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:35:02.112784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09292d90-9f27-470b-a614-2eabe701c3ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CA31109B0>]}
[0m21:35:02.162771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09292d90-9f27-470b-a614-2eabe701c3ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CA40A26F0>]}
[0m21:35:02.163772 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:35:02.170762 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m21:35:02.255004 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m21:35:02.255983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '09292d90-9f27-470b-a614-2eabe701c3ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CA3DD03B0>]}
[0m21:35:03.126934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09292d90-9f27-470b-a614-2eabe701c3ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CA54FA5A0>]}
[0m21:35:03.203378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09292d90-9f27-470b-a614-2eabe701c3ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CA55F60C0>]}
[0m21:35:03.204376 [info ] [MainThread]: Found 1 model, 10 sources, 423 macros
[0m21:35:03.204376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09292d90-9f27-470b-a614-2eabe701c3ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CA5531340>]}
[0m21:35:03.206379 [info ] [MainThread]: 
[0m21:35:03.206379 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:35:03.207380 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merchant_data'
[0m21:35:03.299988 [debug] [ThreadPool]: Using postgres connection "list_merchant_data"
[0m21:35:03.299988 [debug] [ThreadPool]: On list_merchant_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "list_merchant_data"} */

    select distinct nspname from pg_namespace
  
[0m21:35:03.299988 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:35:03.341498 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.041 seconds
[0m21:35:03.343585 [debug] [ThreadPool]: On list_merchant_data: Close
[0m21:35:03.344498 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merchant_data_public'
[0m21:35:03.351498 [debug] [ThreadPool]: Using postgres connection "list_merchant_data_public"
[0m21:35:03.351498 [debug] [ThreadPool]: On list_merchant_data_public: BEGIN
[0m21:35:03.351498 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:35:03.387529 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m21:35:03.387529 [debug] [ThreadPool]: Using postgres connection "list_merchant_data_public"
[0m21:35:03.388530 [debug] [ThreadPool]: On list_merchant_data_public: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "list_merchant_data_public"} */
select
      'merchant_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'merchant_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'merchant_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:35:03.394531 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.006 seconds
[0m21:35:03.396537 [debug] [ThreadPool]: On list_merchant_data_public: ROLLBACK
[0m21:35:03.396537 [debug] [ThreadPool]: On list_merchant_data_public: Close
[0m21:35:03.439337 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:03.440337 [debug] [MainThread]: On master: BEGIN
[0m21:35:03.440337 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:35:03.472739 [debug] [MainThread]: SQL status: BEGIN in 0.032 seconds
[0m21:35:03.472739 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:03.473816 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:35:03.481864 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m21:35:03.482865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09292d90-9f27-470b-a614-2eabe701c3ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CA39BC320>]}
[0m21:35:03.482865 [debug] [MainThread]: On master: ROLLBACK
[0m21:35:03.483861 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:03.483861 [debug] [MainThread]: On master: BEGIN
[0m21:35:03.484863 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:35:03.484863 [debug] [MainThread]: On master: COMMIT
[0m21:35:03.484863 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:03.484863 [debug] [MainThread]: On master: COMMIT
[0m21:35:03.485975 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:35:03.485975 [debug] [MainThread]: On master: Close
[0m21:35:03.486964 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:35:03.486964 [info ] [MainThread]: 
[0m21:35:03.492283 [debug] [Thread-1 (]: Began running node model.merchant_data_project.account_statuses
[0m21:35:03.492283 [info ] [Thread-1 (]: 1 of 1 START sql incremental model public.account_statuses ..................... [RUN]
[0m21:35:03.493277 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.merchant_data_project.account_statuses'
[0m21:35:03.493277 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.account_statuses
[0m21:35:03.501372 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.account_statuses"
[0m21:35:03.502374 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.account_statuses
[0m21:35:03.552994 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m21:35:03.552994 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.account_statuses"} */

    
  
    

  create temporary table "account_statuses__dbt_tmp213503527994"
  
  
    as
  
  (
    
SELECT *
FROM "merchant_data"."public"."account_statuses"
  );
  
  
[0m21:35:03.553994 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:35:03.624387 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.070 seconds
[0m21:35:03.636377 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m21:35:03.636377 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: BEGIN
[0m21:35:03.637379 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m21:35:03.638372 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m21:35:03.638372 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.account_statuses"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'account_statuses__dbt_tmp213503527994'
        
      order by ordinal_position

  
[0m21:35:03.650445 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.012 seconds
[0m21:35:03.654444 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m21:35:03.655445 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.account_statuses"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "merchant_data".INFORMATION_SCHEMA.columns
      where table_name = 'account_statuses'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m21:35:03.657530 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.002 seconds
[0m21:35:03.663448 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m21:35:03.663448 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.account_statuses"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "merchant_data".INFORMATION_SCHEMA.columns
      where table_name = 'account_statuses'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m21:35:03.666531 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.002 seconds
[0m21:35:03.675524 [debug] [Thread-1 (]: Writing runtime sql for node "model.merchant_data_project.account_statuses"
[0m21:35:03.676442 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m21:35:03.676442 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.account_statuses"} */

      insert into "merchant_data"."public"."account_statuses" ("id", "status", "description", "src_created_at", "src_updated_at", "created_at", "updated_at")
    (
        select "id", "status", "description", "src_created_at", "src_updated_at", "created_at", "updated_at"
        from "account_statuses__dbt_tmp213503527994"
    )


  
[0m21:35:03.678441 [debug] [Thread-1 (]: Postgres adapter: Postgres error: duplicate key value violates unique constraint "account_statuses_pkey"
DETAIL:  Key (id)=(1) already exists.

[0m21:35:03.678441 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: ROLLBACK
[0m21:35:03.679445 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: Close
[0m21:35:03.684535 [debug] [Thread-1 (]: Database Error in model account_statuses (models\staging\account_statuses.sql)
  duplicate key value violates unique constraint "account_statuses_pkey"
  DETAIL:  Key (id)=(1) already exists.
  compiled code at target\run\merchant_data_project\models\staging\account_statuses.sql
[0m21:35:03.686534 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09292d90-9f27-470b-a614-2eabe701c3ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CA54E4830>]}
[0m21:35:03.686534 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model public.account_statuses ............ [[31mERROR[0m in 0.19s]
[0m21:35:03.687477 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.account_statuses
[0m21:35:03.689443 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:03.689443 [debug] [MainThread]: On master: BEGIN
[0m21:35:03.689443 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:35:03.723687 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m21:35:03.723687 [debug] [MainThread]: On master: COMMIT
[0m21:35:03.723687 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:03.723687 [debug] [MainThread]: On master: COMMIT
[0m21:35:03.724688 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:35:03.724688 [debug] [MainThread]: On master: Close
[0m21:35:03.724688 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:35:03.725688 [debug] [MainThread]: Connection 'list_merchant_data' was properly closed.
[0m21:35:03.725688 [debug] [MainThread]: Connection 'list_merchant_data_public' was properly closed.
[0m21:35:03.725688 [debug] [MainThread]: Connection 'model.merchant_data_project.account_statuses' was properly closed.
[0m21:35:03.725688 [info ] [MainThread]: 
[0m21:35:03.726688 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m21:35:03.726688 [debug] [MainThread]: Command end result
[0m21:35:03.754408 [info ] [MainThread]: 
[0m21:35:03.755424 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:35:03.756432 [info ] [MainThread]: 
[0m21:35:03.756432 [error] [MainThread]:   Database Error in model account_statuses (models\staging\account_statuses.sql)
  duplicate key value violates unique constraint "account_statuses_pkey"
  DETAIL:  Key (id)=(1) already exists.
  compiled code at target\run\merchant_data_project\models\staging\account_statuses.sql
[0m21:35:03.757432 [info ] [MainThread]: 
[0m21:35:03.758434 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:35:03.759436 [debug] [MainThread]: Command `dbt run` failed at 21:35:03.759436 after 1.97 seconds
[0m21:35:03.759436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CA489B170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CA1DD0FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CA1A57830>]}
[0m21:35:03.760436 [debug] [MainThread]: Flushing usage events
[0m21:37:21.090829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293461C4A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293421D2060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029344F4A8A0>]}


============================== 21:37:21.093853 | 2ffed49a-fa8d-44f9-8847-9fec10878abe ==============================
[0m21:37:21.093853 [info ] [MainThread]: Running with dbt=1.8.8
[0m21:37:21.094835 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alvaro\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\alvaro\\Desktop\\sumup_assignment\\merchant_data_project\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select account_statuses', 'send_anonymous_usage_stats': 'True'}
[0m21:37:21.281819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ffed49a-fa8d-44f9-8847-9fec10878abe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002934612B680>]}
[0m21:37:21.338899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ffed49a-fa8d-44f9-8847-9fec10878abe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029344AA0410>]}
[0m21:37:21.340912 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:37:21.347898 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m21:37:21.463164 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:37:21.464158 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:37:21.496909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ffed49a-fa8d-44f9-8847-9fec10878abe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029346943D10>]}
[0m21:37:21.584890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ffed49a-fa8d-44f9-8847-9fec10878abe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029346CD3E30>]}
[0m21:37:21.585888 [info ] [MainThread]: Found 1 model, 10 sources, 423 macros
[0m21:37:21.586888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ffed49a-fa8d-44f9-8847-9fec10878abe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002934650C560>]}
[0m21:37:21.589023 [info ] [MainThread]: 
[0m21:37:21.590020 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:37:21.591026 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merchant_data'
[0m21:37:21.706049 [debug] [ThreadPool]: Using postgres connection "list_merchant_data"
[0m21:37:21.706049 [debug] [ThreadPool]: On list_merchant_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "list_merchant_data"} */

    select distinct nspname from pg_namespace
  
[0m21:37:21.707058 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:37:21.753070 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.046 seconds
[0m21:37:21.754100 [debug] [ThreadPool]: On list_merchant_data: Close
[0m21:37:21.756076 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merchant_data_public'
[0m21:37:21.761075 [debug] [ThreadPool]: Using postgres connection "list_merchant_data_public"
[0m21:37:21.761075 [debug] [ThreadPool]: On list_merchant_data_public: BEGIN
[0m21:37:21.761075 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:37:21.793251 [debug] [ThreadPool]: SQL status: BEGIN in 0.032 seconds
[0m21:37:21.793251 [debug] [ThreadPool]: Using postgres connection "list_merchant_data_public"
[0m21:37:21.794226 [debug] [ThreadPool]: On list_merchant_data_public: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "list_merchant_data_public"} */
select
      'merchant_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'merchant_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'merchant_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:37:21.799246 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.005 seconds
[0m21:37:21.800225 [debug] [ThreadPool]: On list_merchant_data_public: ROLLBACK
[0m21:37:21.801226 [debug] [ThreadPool]: On list_merchant_data_public: Close
[0m21:37:21.807678 [debug] [MainThread]: Using postgres connection "master"
[0m21:37:21.808676 [debug] [MainThread]: On master: BEGIN
[0m21:37:21.808676 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:37:21.842646 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m21:37:21.843644 [debug] [MainThread]: Using postgres connection "master"
[0m21:37:21.843644 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:37:21.850743 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m21:37:21.851715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ffed49a-fa8d-44f9-8847-9fec10878abe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029347228770>]}
[0m21:37:21.851715 [debug] [MainThread]: On master: ROLLBACK
[0m21:37:21.852691 [debug] [MainThread]: Using postgres connection "master"
[0m21:37:21.852691 [debug] [MainThread]: On master: BEGIN
[0m21:37:21.853643 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:37:21.853643 [debug] [MainThread]: On master: COMMIT
[0m21:37:21.853643 [debug] [MainThread]: Using postgres connection "master"
[0m21:37:21.854646 [debug] [MainThread]: On master: COMMIT
[0m21:37:21.854646 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:37:21.854646 [debug] [MainThread]: On master: Close
[0m21:37:21.855735 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:37:21.855735 [info ] [MainThread]: 
[0m21:37:21.859641 [debug] [Thread-1 (]: Began running node model.merchant_data_project.account_statuses
[0m21:37:21.859641 [info ] [Thread-1 (]: 1 of 1 START sql incremental model public.account_statuses ..................... [RUN]
[0m21:37:21.860641 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.merchant_data_project.account_statuses'
[0m21:37:21.860641 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.account_statuses
[0m21:37:21.866729 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.account_statuses"
[0m21:37:21.867643 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.account_statuses
[0m21:37:21.927266 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m21:37:21.927266 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.account_statuses"} */

    
  
    

  create temporary table "account_statuses__dbt_tmp213721902266"
  
  
    as
  
  (
    
SELECT *
FROM "merchant_data"."public"."account_statuses"
  );
  
  
[0m21:37:21.928266 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:37:21.973294 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.046 seconds
[0m21:37:21.985291 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m21:37:21.986290 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: BEGIN
[0m21:37:21.987304 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m21:37:21.987304 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m21:37:21.987814 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.account_statuses"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'account_statuses__dbt_tmp213721902266'
        
      order by ordinal_position

  
[0m21:37:21.998907 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.011 seconds
[0m21:37:22.005935 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m21:37:22.005935 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.account_statuses"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "merchant_data".INFORMATION_SCHEMA.columns
      where table_name = 'account_statuses'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m21:37:22.008914 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.002 seconds
[0m21:37:22.016151 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m21:37:22.016151 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.account_statuses"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "merchant_data".INFORMATION_SCHEMA.columns
      where table_name = 'account_statuses'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m21:37:22.019149 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.003 seconds
[0m21:37:22.028142 [debug] [Thread-1 (]: Writing runtime sql for node "model.merchant_data_project.account_statuses"
[0m21:37:22.030133 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m21:37:22.030133 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.account_statuses"} */

      insert into "merchant_data"."public"."account_statuses" ("id", "status", "description", "src_created_at", "src_updated_at", "created_at", "updated_at")
    (
        select "id", "status", "description", "src_created_at", "src_updated_at", "created_at", "updated_at"
        from "account_statuses__dbt_tmp213721902266"
    )


  
[0m21:37:22.032570 [debug] [Thread-1 (]: Postgres adapter: Postgres error: duplicate key value violates unique constraint "account_statuses_pkey"
DETAIL:  Key (id)=(1) already exists.

[0m21:37:22.033562 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: ROLLBACK
[0m21:37:22.033562 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: Close
[0m21:37:22.040076 [debug] [Thread-1 (]: Database Error in model account_statuses (models\staging\account_statuses.sql)
  duplicate key value violates unique constraint "account_statuses_pkey"
  DETAIL:  Key (id)=(1) already exists.
  compiled code at target\run\merchant_data_project\models\staging\account_statuses.sql
[0m21:37:22.041005 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ffed49a-fa8d-44f9-8847-9fec10878abe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293472142F0>]}
[0m21:37:22.042086 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model public.account_statuses ............ [[31mERROR[0m in 0.18s]
[0m21:37:22.042997 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.account_statuses
[0m21:37:22.045008 [debug] [MainThread]: Using postgres connection "master"
[0m21:37:22.045008 [debug] [MainThread]: On master: BEGIN
[0m21:37:22.046011 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:37:22.081562 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m21:37:22.082544 [debug] [MainThread]: On master: COMMIT
[0m21:37:22.082544 [debug] [MainThread]: Using postgres connection "master"
[0m21:37:22.083462 [debug] [MainThread]: On master: COMMIT
[0m21:37:22.083462 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:37:22.083973 [debug] [MainThread]: On master: Close
[0m21:37:22.083973 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:37:22.083973 [debug] [MainThread]: Connection 'list_merchant_data' was properly closed.
[0m21:37:22.084990 [debug] [MainThread]: Connection 'list_merchant_data_public' was properly closed.
[0m21:37:22.084990 [debug] [MainThread]: Connection 'model.merchant_data_project.account_statuses' was properly closed.
[0m21:37:22.085986 [info ] [MainThread]: 
[0m21:37:22.085986 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m21:37:22.087492 [debug] [MainThread]: Command end result
[0m21:37:22.118430 [info ] [MainThread]: 
[0m21:37:22.120840 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:37:22.120840 [info ] [MainThread]: 
[0m21:37:22.122063 [error] [MainThread]:   Database Error in model account_statuses (models\staging\account_statuses.sql)
  duplicate key value violates unique constraint "account_statuses_pkey"
  DETAIL:  Key (id)=(1) already exists.
  compiled code at target\run\merchant_data_project\models\staging\account_statuses.sql
[0m21:37:22.122063 [info ] [MainThread]: 
[0m21:37:22.123290 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:37:22.124296 [debug] [MainThread]: Command `dbt run` failed at 21:37:22.124296 after 1.15 seconds
[0m21:37:22.125295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293461C4A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029346592DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293457D1CD0>]}
[0m21:37:22.125295 [debug] [MainThread]: Flushing usage events
[0m21:40:39.664066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC6C07A6F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC6FE47590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC6FE44C50>]}


============================== 21:40:39.667131 | 78665041-a865-4890-8c27-c40863bb8a93 ==============================
[0m21:40:39.667131 [info ] [MainThread]: Running with dbt=1.8.8
[0m21:40:39.668081 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\alvaro\\Desktop\\sumup_assignment\\merchant_data_project\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\alvaro\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select account_statuses', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:40:39.830759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78665041-a865-4890-8c27-c40863bb8a93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC6FACB140>]}
[0m21:40:39.874682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '78665041-a865-4890-8c27-c40863bb8a93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC6FE7FF20>]}
[0m21:40:39.875754 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:40:39.882742 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m21:40:39.953061 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m21:40:39.954104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '78665041-a865-4890-8c27-c40863bb8a93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC6F2D0200>]}
[0m21:40:40.799976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78665041-a865-4890-8c27-c40863bb8a93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC70A47C80>]}
[0m21:40:40.870487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78665041-a865-4890-8c27-c40863bb8a93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC70B7CDA0>]}
[0m21:40:40.870487 [info ] [MainThread]: Found 1 model, 10 sources, 423 macros
[0m21:40:40.871486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78665041-a865-4890-8c27-c40863bb8a93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC70A47D10>]}
[0m21:40:40.873563 [info ] [MainThread]: 
[0m21:40:40.874485 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:40:40.875485 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merchant_data'
[0m21:40:40.932195 [debug] [ThreadPool]: Using postgres connection "list_merchant_data"
[0m21:40:40.946410 [debug] [ThreadPool]: On list_merchant_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "list_merchant_data"} */

    select distinct nspname from pg_namespace
  
[0m21:40:40.947415 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:40:40.984714 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.038 seconds
[0m21:40:40.986807 [debug] [ThreadPool]: On list_merchant_data: Close
[0m21:40:40.987721 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merchant_data_public'
[0m21:40:40.994053 [debug] [ThreadPool]: Using postgres connection "list_merchant_data_public"
[0m21:40:40.994053 [debug] [ThreadPool]: On list_merchant_data_public: BEGIN
[0m21:40:40.994053 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:40:41.026044 [debug] [ThreadPool]: SQL status: BEGIN in 0.032 seconds
[0m21:40:41.027044 [debug] [ThreadPool]: Using postgres connection "list_merchant_data_public"
[0m21:40:41.027044 [debug] [ThreadPool]: On list_merchant_data_public: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "list_merchant_data_public"} */
select
      'merchant_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'merchant_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'merchant_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:40:41.034044 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.006 seconds
[0m21:40:41.036043 [debug] [ThreadPool]: On list_merchant_data_public: ROLLBACK
[0m21:40:41.037056 [debug] [ThreadPool]: On list_merchant_data_public: Close
[0m21:40:41.078745 [debug] [MainThread]: Using postgres connection "master"
[0m21:40:41.078745 [debug] [MainThread]: On master: BEGIN
[0m21:40:41.078745 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:40:41.116217 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m21:40:41.116217 [debug] [MainThread]: Using postgres connection "master"
[0m21:40:41.116217 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:40:41.124221 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m21:40:41.125302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78665041-a865-4890-8c27-c40863bb8a93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC6FD22B70>]}
[0m21:40:41.126314 [debug] [MainThread]: On master: ROLLBACK
[0m21:40:41.126314 [debug] [MainThread]: Using postgres connection "master"
[0m21:40:41.127221 [debug] [MainThread]: On master: BEGIN
[0m21:40:41.127221 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:40:41.128217 [debug] [MainThread]: On master: COMMIT
[0m21:40:41.128217 [debug] [MainThread]: Using postgres connection "master"
[0m21:40:41.128217 [debug] [MainThread]: On master: COMMIT
[0m21:40:41.128217 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:40:41.129220 [debug] [MainThread]: On master: Close
[0m21:40:41.129220 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:40:41.130217 [info ] [MainThread]: 
[0m21:40:41.133217 [debug] [Thread-1 (]: Began running node model.merchant_data_project.account_statuses
[0m21:40:41.133217 [info ] [Thread-1 (]: 1 of 1 START sql incremental model public.account_statuses ..................... [RUN]
[0m21:40:41.134327 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.merchant_data_project.account_statuses'
[0m21:40:41.134327 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.account_statuses
[0m21:40:41.143335 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.account_statuses"
[0m21:40:41.144334 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.account_statuses
[0m21:40:41.194936 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m21:40:41.195972 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.account_statuses"} */

    
  
    

  create temporary table "account_statuses__dbt_tmp214041172738"
  
  
    as
  
  (
    
SELECT *
FROM "merchant_data"."public"."account_statuses"
  );
  
  
[0m21:40:41.195972 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:40:41.237483 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.041 seconds
[0m21:40:41.247449 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m21:40:41.248449 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: BEGIN
[0m21:40:41.249454 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m21:40:41.249454 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m21:40:41.249454 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.account_statuses"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'account_statuses__dbt_tmp214041172738'
        
      order by ordinal_position

  
[0m21:40:41.261454 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.012 seconds
[0m21:40:41.266558 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m21:40:41.266558 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.account_statuses"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "merchant_data".INFORMATION_SCHEMA.columns
      where table_name = 'account_statuses'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m21:40:41.269453 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.002 seconds
[0m21:40:41.274542 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m21:40:41.274542 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.account_statuses"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "merchant_data".INFORMATION_SCHEMA.columns
      where table_name = 'account_statuses'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m21:40:41.278455 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.003 seconds
[0m21:40:41.288533 [debug] [Thread-1 (]: Writing runtime sql for node "model.merchant_data_project.account_statuses"
[0m21:40:41.289472 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m21:40:41.290453 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.account_statuses"} */

      insert into "merchant_data"."public"."account_statuses" ("id", "status", "description", "src_created_at", "src_updated_at", "created_at", "updated_at")
    (
        select "id", "status", "description", "src_created_at", "src_updated_at", "created_at", "updated_at"
        from "account_statuses__dbt_tmp214041172738"
    )


  
[0m21:40:41.292459 [debug] [Thread-1 (]: Postgres adapter: Postgres error: duplicate key value violates unique constraint "account_statuses_pkey"
DETAIL:  Key (id)=(1) already exists.

[0m21:40:41.292459 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: ROLLBACK
[0m21:40:41.293458 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: Close
[0m21:40:41.298808 [debug] [Thread-1 (]: Database Error in model account_statuses (models\staging\account_statuses.sql)
  duplicate key value violates unique constraint "account_statuses_pkey"
  DETAIL:  Key (id)=(1) already exists.
  compiled code at target\run\merchant_data_project\models\staging\account_statuses.sql
[0m21:40:41.299857 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78665041-a865-4890-8c27-c40863bb8a93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC70A93680>]}
[0m21:40:41.301082 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model public.account_statuses ............ [[31mERROR[0m in 0.17s]
[0m21:40:41.302129 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.account_statuses
[0m21:40:41.303395 [debug] [MainThread]: Using postgres connection "master"
[0m21:40:41.304652 [debug] [MainThread]: On master: BEGIN
[0m21:40:41.304652 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:40:41.340783 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m21:40:41.341781 [debug] [MainThread]: On master: COMMIT
[0m21:40:41.341781 [debug] [MainThread]: Using postgres connection "master"
[0m21:40:41.342849 [debug] [MainThread]: On master: COMMIT
[0m21:40:41.342849 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:40:41.343784 [debug] [MainThread]: On master: Close
[0m21:40:41.343784 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:40:41.343784 [debug] [MainThread]: Connection 'list_merchant_data' was properly closed.
[0m21:40:41.344791 [debug] [MainThread]: Connection 'list_merchant_data_public' was properly closed.
[0m21:40:41.344791 [debug] [MainThread]: Connection 'model.merchant_data_project.account_statuses' was properly closed.
[0m21:40:41.344791 [info ] [MainThread]: 
[0m21:40:41.345783 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m21:40:41.347781 [debug] [MainThread]: Command end result
[0m21:40:41.376845 [info ] [MainThread]: 
[0m21:40:41.379245 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:40:41.380246 [info ] [MainThread]: 
[0m21:40:41.380246 [error] [MainThread]:   Database Error in model account_statuses (models\staging\account_statuses.sql)
  duplicate key value violates unique constraint "account_statuses_pkey"
  DETAIL:  Key (id)=(1) already exists.
  compiled code at target\run\merchant_data_project\models\staging\account_statuses.sql
[0m21:40:41.382243 [info ] [MainThread]: 
[0m21:40:41.382243 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:40:41.384247 [debug] [MainThread]: Command `dbt run` failed at 21:40:41.384247 after 1.85 seconds
[0m21:40:41.385243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC6F1A3FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC70BC1C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC70BC35C0>]}
[0m21:40:41.385243 [debug] [MainThread]: Flushing usage events
[0m21:43:12.642689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD1C8F85C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD1EE6EED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD1EE6EBD0>]}


============================== 21:43:12.645694 | 26dc55e2-d5b1-485e-adbf-f0dae01d3bf3 ==============================
[0m21:43:12.645694 [info ] [MainThread]: Running with dbt=1.8.8
[0m21:43:12.646699 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alvaro\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\alvaro\\Desktop\\sumup_assignment\\merchant_data_project\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select account_statuses', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:43:12.848052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '26dc55e2-d5b1-485e-adbf-f0dae01d3bf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD2007E6C0>]}
[0m21:43:12.912600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '26dc55e2-d5b1-485e-adbf-f0dae01d3bf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD1FE55160>]}
[0m21:43:12.913602 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:43:12.925601 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m21:43:13.016954 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m21:43:13.017994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '26dc55e2-d5b1-485e-adbf-f0dae01d3bf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD1F4D00E0>]}
[0m21:43:13.910322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26dc55e2-d5b1-485e-adbf-f0dae01d3bf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD20C36CC0>]}
[0m21:43:13.980332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26dc55e2-d5b1-485e-adbf-f0dae01d3bf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD20C2E3C0>]}
[0m21:43:13.981338 [info ] [MainThread]: Found 1 model, 10 sources, 423 macros
[0m21:43:13.982339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26dc55e2-d5b1-485e-adbf-f0dae01d3bf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD20D76750>]}
[0m21:43:13.983351 [info ] [MainThread]: 
[0m21:43:13.984350 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:43:13.985332 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merchant_data'
[0m21:43:14.039313 [debug] [ThreadPool]: Using postgres connection "list_merchant_data"
[0m21:43:14.040314 [debug] [ThreadPool]: On list_merchant_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "list_merchant_data"} */

    select distinct nspname from pg_namespace
  
[0m21:43:14.040314 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:43:14.182463 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.142 seconds
[0m21:43:14.183462 [debug] [ThreadPool]: On list_merchant_data: Close
[0m21:43:14.184461 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merchant_data_public'
[0m21:43:14.190679 [debug] [ThreadPool]: Using postgres connection "list_merchant_data_public"
[0m21:43:14.192001 [debug] [ThreadPool]: On list_merchant_data_public: BEGIN
[0m21:43:14.192001 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:43:14.225536 [debug] [ThreadPool]: SQL status: BEGIN in 0.033 seconds
[0m21:43:14.225536 [debug] [ThreadPool]: Using postgres connection "list_merchant_data_public"
[0m21:43:14.225536 [debug] [ThreadPool]: On list_merchant_data_public: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "list_merchant_data_public"} */
select
      'merchant_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'merchant_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'merchant_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:43:14.231817 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.006 seconds
[0m21:43:14.232908 [debug] [ThreadPool]: On list_merchant_data_public: ROLLBACK
[0m21:43:14.233891 [debug] [ThreadPool]: On list_merchant_data_public: Close
[0m21:43:14.278130 [debug] [MainThread]: Using postgres connection "master"
[0m21:43:14.278130 [debug] [MainThread]: On master: BEGIN
[0m21:43:14.279123 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:43:14.312353 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m21:43:14.313306 [debug] [MainThread]: Using postgres connection "master"
[0m21:43:14.313306 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:43:14.321519 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m21:43:14.322470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26dc55e2-d5b1-485e-adbf-f0dae01d3bf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD20DA6F30>]}
[0m21:43:14.322470 [debug] [MainThread]: On master: ROLLBACK
[0m21:43:14.323547 [debug] [MainThread]: Using postgres connection "master"
[0m21:43:14.323547 [debug] [MainThread]: On master: BEGIN
[0m21:43:14.324622 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m21:43:14.324622 [debug] [MainThread]: On master: COMMIT
[0m21:43:14.324622 [debug] [MainThread]: Using postgres connection "master"
[0m21:43:14.325628 [debug] [MainThread]: On master: COMMIT
[0m21:43:14.325628 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:43:14.325628 [debug] [MainThread]: On master: Close
[0m21:43:14.326715 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:43:14.326715 [info ] [MainThread]: 
[0m21:43:14.330890 [debug] [Thread-1 (]: Began running node model.merchant_data_project.account_statuses
[0m21:43:14.330890 [info ] [Thread-1 (]: 1 of 1 START sql view model public.account_statuses ............................ [RUN]
[0m21:43:14.331891 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.merchant_data_project.account_statuses'
[0m21:43:14.331891 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.account_statuses
[0m21:43:14.337891 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.account_statuses"
[0m21:43:14.338892 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.account_statuses
[0m21:43:14.377132 [debug] [Thread-1 (]: Writing runtime sql for node "model.merchant_data_project.account_statuses"
[0m21:43:14.379134 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m21:43:14.379134 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: BEGIN
[0m21:43:14.380128 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:43:14.417463 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m21:43:14.417463 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m21:43:14.418558 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.account_statuses"} */

  create view "merchant_data"."public"."account_statuses__dbt_tmp"
    
    
  as (
    
SELECT *
FROM "merchant_data"."public"."account_statuses"
  );
[0m21:43:14.424467 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m21:43:14.429551 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m21:43:14.430552 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.account_statuses"} */
alter table "merchant_data"."public"."account_statuses" rename to "account_statuses__dbt_backup"
[0m21:43:14.430552 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:43:14.432482 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m21:43:14.433516 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.account_statuses"} */
alter table "merchant_data"."public"."account_statuses__dbt_tmp" rename to "account_statuses"
[0m21:43:14.433516 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:43:14.445554 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: COMMIT
[0m21:43:14.446558 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m21:43:14.446558 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: COMMIT
[0m21:43:14.475152 [debug] [Thread-1 (]: SQL status: COMMIT in 0.029 seconds
[0m21:43:14.484273 [debug] [Thread-1 (]: Applying DROP to: "merchant_data"."public"."account_statuses__dbt_backup"
[0m21:43:14.488272 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m21:43:14.488272 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.account_statuses"} */
drop table if exists "merchant_data"."public"."account_statuses__dbt_backup" cascade
[0m21:43:14.492432 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m21:43:14.494431 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: Close
[0m21:43:14.496586 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26dc55e2-d5b1-485e-adbf-f0dae01d3bf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD1CE2C230>]}
[0m21:43:14.496586 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.account_statuses ....................... [[32mCREATE VIEW[0m in 0.16s]
[0m21:43:14.497960 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.account_statuses
[0m21:43:14.498965 [debug] [MainThread]: Using postgres connection "master"
[0m21:43:14.499965 [debug] [MainThread]: On master: BEGIN
[0m21:43:14.499965 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:43:14.535980 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m21:43:14.535980 [debug] [MainThread]: On master: COMMIT
[0m21:43:14.536983 [debug] [MainThread]: Using postgres connection "master"
[0m21:43:14.536983 [debug] [MainThread]: On master: COMMIT
[0m21:43:14.537982 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:43:14.537982 [debug] [MainThread]: On master: Close
[0m21:43:14.538982 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:43:14.538982 [debug] [MainThread]: Connection 'list_merchant_data' was properly closed.
[0m21:43:14.538982 [debug] [MainThread]: Connection 'list_merchant_data_public' was properly closed.
[0m21:43:14.538982 [debug] [MainThread]: Connection 'model.merchant_data_project.account_statuses' was properly closed.
[0m21:43:14.539981 [info ] [MainThread]: 
[0m21:43:14.539981 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m21:43:14.540984 [debug] [MainThread]: Command end result
[0m21:43:14.569981 [info ] [MainThread]: 
[0m21:43:14.570981 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:43:14.572008 [info ] [MainThread]: 
[0m21:43:14.572008 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:43:14.574074 [debug] [MainThread]: Command `dbt run` succeeded at 21:43:14.574074 after 2.04 seconds
[0m21:43:14.575197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD1C8F85C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD21214CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD1FE24770>]}
[0m21:43:14.575197 [debug] [MainThread]: Flushing usage events
[0m21:45:45.288787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024374ECD340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243716FAC30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024374E44CB0>]}


============================== 21:45:45.292908 | e82f74c7-4d55-46e4-af0d-b2ad8d13282e ==============================
[0m21:45:45.292908 [info ] [MainThread]: Running with dbt=1.8.8
[0m21:45:45.293940 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\alvaro\\.dbt', 'log_path': 'C:\\Users\\alvaro\\Desktop\\sumup_assignment\\merchant_data_project\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select account_statuses', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:45:45.465641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e82f74c7-4d55-46e4-af0d-b2ad8d13282e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024371C2D220>]}
[0m21:45:45.508641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e82f74c7-4d55-46e4-af0d-b2ad8d13282e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024374ECD220>]}
[0m21:45:45.509640 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:45:45.516640 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m21:45:45.584336 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m21:45:45.585334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e82f74c7-4d55-46e4-af0d-b2ad8d13282e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243742D0260>]}
[0m21:45:46.422508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e82f74c7-4d55-46e4-af0d-b2ad8d13282e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243756378C0>]}
[0m21:45:46.494151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e82f74c7-4d55-46e4-af0d-b2ad8d13282e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243756A8770>]}
[0m21:45:46.494151 [info ] [MainThread]: Found 1 model, 10 sources, 423 macros
[0m21:45:46.495594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e82f74c7-4d55-46e4-af0d-b2ad8d13282e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243753C8A40>]}
[0m21:45:46.496603 [info ] [MainThread]: 
[0m21:45:46.497605 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:45:46.498603 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merchant_data'
[0m21:45:46.550386 [debug] [ThreadPool]: Using postgres connection "list_merchant_data"
[0m21:45:46.551424 [debug] [ThreadPool]: On list_merchant_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "list_merchant_data"} */

    select distinct nspname from pg_namespace
  
[0m21:45:46.551424 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:45:46.589727 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.038 seconds
[0m21:45:46.590725 [debug] [ThreadPool]: On list_merchant_data: Close
[0m21:45:46.592724 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merchant_data_public'
[0m21:45:46.597806 [debug] [ThreadPool]: Using postgres connection "list_merchant_data_public"
[0m21:45:46.598816 [debug] [ThreadPool]: On list_merchant_data_public: BEGIN
[0m21:45:46.598816 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:45:46.631998 [debug] [ThreadPool]: SQL status: BEGIN in 0.033 seconds
[0m21:45:46.631998 [debug] [ThreadPool]: Using postgres connection "list_merchant_data_public"
[0m21:45:46.631998 [debug] [ThreadPool]: On list_merchant_data_public: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "list_merchant_data_public"} */
select
      'merchant_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'merchant_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'merchant_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:45:46.639499 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.006 seconds
[0m21:45:46.641597 [debug] [ThreadPool]: On list_merchant_data_public: ROLLBACK
[0m21:45:46.641597 [debug] [ThreadPool]: On list_merchant_data_public: Close
[0m21:45:46.687507 [debug] [MainThread]: Using postgres connection "master"
[0m21:45:46.687507 [debug] [MainThread]: On master: BEGIN
[0m21:45:46.687507 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:45:46.724781 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m21:45:46.724781 [debug] [MainThread]: Using postgres connection "master"
[0m21:45:46.725884 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:45:46.734784 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m21:45:46.735794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e82f74c7-4d55-46e4-af0d-b2ad8d13282e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243740E7E30>]}
[0m21:45:46.735794 [debug] [MainThread]: On master: ROLLBACK
[0m21:45:46.736781 [debug] [MainThread]: Using postgres connection "master"
[0m21:45:46.736781 [debug] [MainThread]: On master: BEGIN
[0m21:45:46.737783 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:45:46.737783 [debug] [MainThread]: On master: COMMIT
[0m21:45:46.737783 [debug] [MainThread]: Using postgres connection "master"
[0m21:45:46.737783 [debug] [MainThread]: On master: COMMIT
[0m21:45:46.738785 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:45:46.738785 [debug] [MainThread]: On master: Close
[0m21:45:46.738785 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:45:46.739781 [info ] [MainThread]: 
[0m21:45:46.743291 [debug] [Thread-1 (]: Began running node model.merchant_data_project.account_statuses
[0m21:45:46.744342 [info ] [Thread-1 (]: 1 of 1 START sql incremental model public.account_statuses ..................... [RUN]
[0m21:45:46.745292 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.merchant_data_project.account_statuses'
[0m21:45:46.745292 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.account_statuses
[0m21:45:46.753292 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.account_statuses"
[0m21:45:46.754371 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.account_statuses
[0m21:45:46.807387 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m21:45:46.808443 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.account_statuses"} */

    
  
    

  create temporary table "account_statuses__dbt_tmp214546784285"
  
  
    as
  
  (
    
SELECT *
FROM "merchant_data"."public"."account_statuses"
  );
  
  
[0m21:45:46.808443 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:45:46.849172 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.040 seconds
[0m21:45:46.861285 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m21:45:46.861285 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: BEGIN
[0m21:45:46.862274 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m21:45:46.862274 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m21:45:46.862274 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.account_statuses"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'account_statuses__dbt_tmp214546784285'
        
      order by ordinal_position

  
[0m21:45:46.876325 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.013 seconds
[0m21:45:46.880331 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m21:45:46.880331 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.account_statuses"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "merchant_data".INFORMATION_SCHEMA.columns
      where table_name = 'account_statuses'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m21:45:46.883441 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.002 seconds
[0m21:45:46.889446 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m21:45:46.889446 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.account_statuses"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "merchant_data".INFORMATION_SCHEMA.columns
      where table_name = 'account_statuses'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m21:45:46.892445 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.002 seconds
[0m21:45:46.901535 [debug] [Thread-1 (]: Writing runtime sql for node "model.merchant_data_project.account_statuses"
[0m21:45:46.902442 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m21:45:46.903456 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.account_statuses"} */

      insert into "merchant_data"."public"."account_statuses" ("id", "status", "description", "src_created_at", "src_updated_at", "created_at", "updated_at")
    (
        select "id", "status", "description", "src_created_at", "src_updated_at", "created_at", "updated_at"
        from "account_statuses__dbt_tmp214546784285"
    )


  
[0m21:45:46.905270 [debug] [Thread-1 (]: Postgres adapter: Postgres error: duplicate key value violates unique constraint "account_statuses_pkey"
DETAIL:  Key (id)=(1) already exists.

[0m21:45:46.906280 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: ROLLBACK
[0m21:45:46.906280 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: Close
[0m21:45:46.911606 [debug] [Thread-1 (]: Database Error in model account_statuses (models\staging\account_statuses.sql)
  duplicate key value violates unique constraint "account_statuses_pkey"
  DETAIL:  Key (id)=(1) already exists.
  compiled code at target\run\merchant_data_project\models\staging\account_statuses.sql
[0m21:45:46.912610 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e82f74c7-4d55-46e4-af0d-b2ad8d13282e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243742D1580>]}
[0m21:45:46.913730 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model public.account_statuses ............ [[31mERROR[0m in 0.17s]
[0m21:45:46.913730 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.account_statuses
[0m21:45:46.915802 [debug] [MainThread]: Using postgres connection "master"
[0m21:45:46.915802 [debug] [MainThread]: On master: BEGIN
[0m21:45:46.915802 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:45:46.949629 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m21:45:46.950678 [debug] [MainThread]: On master: COMMIT
[0m21:45:46.950678 [debug] [MainThread]: Using postgres connection "master"
[0m21:45:46.950678 [debug] [MainThread]: On master: COMMIT
[0m21:45:46.951595 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:45:46.951595 [debug] [MainThread]: On master: Close
[0m21:45:46.951595 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:45:46.952593 [debug] [MainThread]: Connection 'list_merchant_data' was properly closed.
[0m21:45:46.952593 [debug] [MainThread]: Connection 'list_merchant_data_public' was properly closed.
[0m21:45:46.952593 [debug] [MainThread]: Connection 'model.merchant_data_project.account_statuses' was properly closed.
[0m21:45:46.952593 [info ] [MainThread]: 
[0m21:45:46.953592 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m21:45:46.954591 [debug] [MainThread]: Command end result
[0m21:45:46.981860 [info ] [MainThread]: 
[0m21:45:46.983697 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:45:46.984715 [info ] [MainThread]: 
[0m21:45:46.984715 [error] [MainThread]:   Database Error in model account_statuses (models\staging\account_statuses.sql)
  duplicate key value violates unique constraint "account_statuses_pkey"
  DETAIL:  Key (id)=(1) already exists.
  compiled code at target\run\merchant_data_project\models\staging\account_statuses.sql
[0m21:45:46.985712 [info ] [MainThread]: 
[0m21:45:46.986710 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:45:46.987864 [debug] [MainThread]: Command `dbt run` failed at 21:45:46.987864 after 1.81 seconds
[0m21:45:46.987864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024374A87C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024374A87860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024370D6B830>]}
[0m21:45:46.988873 [debug] [MainThread]: Flushing usage events
[0m21:49:01.654862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273DA5A13A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273DA5A0FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273DA5A14C0>]}


============================== 21:49:01.658986 | 96714723-3e0b-4495-ac30-c0db4427a163 ==============================
[0m21:49:01.658986 [info ] [MainThread]: Running with dbt=1.8.8
[0m21:49:01.658986 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\alvaro\\.dbt', 'log_path': 'C:\\Users\\alvaro\\Desktop\\sumup_assignment\\merchant_data_project\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select account_statuses', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:49:01.827077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96714723-3e0b-4495-ac30-c0db4427a163', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273DA5CD190>]}
[0m21:49:01.867686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96714723-3e0b-4495-ac30-c0db4427a163', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273DA5CD190>]}
[0m21:49:01.868700 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:49:01.875698 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m21:49:01.941694 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m21:49:01.942692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '96714723-3e0b-4495-ac30-c0db4427a163', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273DACF5C10>]}
[0m21:49:02.818777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96714723-3e0b-4495-ac30-c0db4427a163', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273DA9C8FB0>]}
[0m21:49:02.887938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96714723-3e0b-4495-ac30-c0db4427a163', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273DB1D11C0>]}
[0m21:49:02.888939 [info ] [MainThread]: Found 1 model, 10 sources, 423 macros
[0m21:49:02.889939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96714723-3e0b-4495-ac30-c0db4427a163', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273DB12CB60>]}
[0m21:49:02.890940 [info ] [MainThread]: 
[0m21:49:02.891940 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:49:02.892940 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merchant_data'
[0m21:49:02.945110 [debug] [ThreadPool]: Using postgres connection "list_merchant_data"
[0m21:49:02.945110 [debug] [ThreadPool]: On list_merchant_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "list_merchant_data"} */

    select distinct nspname from pg_namespace
  
[0m21:49:02.946109 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:49:02.985672 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.040 seconds
[0m21:49:02.987677 [debug] [ThreadPool]: On list_merchant_data: Close
[0m21:49:02.989676 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merchant_data_public'
[0m21:49:02.995746 [debug] [ThreadPool]: Using postgres connection "list_merchant_data_public"
[0m21:49:02.996760 [debug] [ThreadPool]: On list_merchant_data_public: BEGIN
[0m21:49:02.996760 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:49:03.033088 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m21:49:03.034087 [debug] [ThreadPool]: Using postgres connection "list_merchant_data_public"
[0m21:49:03.035094 [debug] [ThreadPool]: On list_merchant_data_public: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "list_merchant_data_public"} */
select
      'merchant_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'merchant_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'merchant_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:49:03.042113 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.007 seconds
[0m21:49:03.044112 [debug] [ThreadPool]: On list_merchant_data_public: ROLLBACK
[0m21:49:03.045143 [debug] [ThreadPool]: On list_merchant_data_public: Close
[0m21:49:03.088253 [debug] [MainThread]: Using postgres connection "master"
[0m21:49:03.088253 [debug] [MainThread]: On master: BEGIN
[0m21:49:03.088253 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:49:03.233332 [debug] [MainThread]: SQL status: BEGIN in 0.144 seconds
[0m21:49:03.233332 [debug] [MainThread]: Using postgres connection "master"
[0m21:49:03.233332 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:49:03.242298 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m21:49:03.243389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96714723-3e0b-4495-ac30-c0db4427a163', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273D5669790>]}
[0m21:49:03.243389 [debug] [MainThread]: On master: ROLLBACK
[0m21:49:03.244299 [debug] [MainThread]: Using postgres connection "master"
[0m21:49:03.244299 [debug] [MainThread]: On master: BEGIN
[0m21:49:03.244299 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:49:03.245298 [debug] [MainThread]: On master: COMMIT
[0m21:49:03.245298 [debug] [MainThread]: Using postgres connection "master"
[0m21:49:03.245298 [debug] [MainThread]: On master: COMMIT
[0m21:49:03.245298 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:49:03.246298 [debug] [MainThread]: On master: Close
[0m21:49:03.246298 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:49:03.247297 [info ] [MainThread]: 
[0m21:49:03.250301 [debug] [Thread-1 (]: Began running node model.merchant_data_project.account_statuses
[0m21:49:03.250301 [info ] [Thread-1 (]: 1 of 1 START sql view model public.account_statuses ............................ [RUN]
[0m21:49:03.251307 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.merchant_data_project.account_statuses'
[0m21:49:03.251307 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.account_statuses
[0m21:49:03.256829 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.account_statuses"
[0m21:49:03.257828 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.account_statuses
[0m21:49:03.293565 [debug] [Thread-1 (]: Writing runtime sql for node "model.merchant_data_project.account_statuses"
[0m21:49:03.295570 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m21:49:03.295570 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: BEGIN
[0m21:49:03.296578 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:49:03.330318 [debug] [Thread-1 (]: SQL status: BEGIN in 0.034 seconds
[0m21:49:03.330318 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m21:49:03.331318 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.account_statuses"} */

  create view "merchant_data"."public"."account_statuses__dbt_tmp"
    
    
  as (
    SELECT *
FROM public.account_statuses
LIMIT 10
  );
[0m21:49:03.336402 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m21:49:03.342463 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m21:49:03.342463 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.account_statuses"} */
alter table "merchant_data"."public"."account_statuses" rename to "account_statuses__dbt_backup"
[0m21:49:03.343370 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:49:03.345366 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m21:49:03.345366 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.account_statuses"} */
alter table "merchant_data"."public"."account_statuses__dbt_tmp" rename to "account_statuses"
[0m21:49:03.346365 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:49:03.359154 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: COMMIT
[0m21:49:03.359154 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m21:49:03.359154 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: COMMIT
[0m21:49:03.388927 [debug] [Thread-1 (]: SQL status: COMMIT in 0.028 seconds
[0m21:49:03.398011 [debug] [Thread-1 (]: Applying DROP to: "merchant_data"."public"."account_statuses__dbt_backup"
[0m21:49:03.401013 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m21:49:03.402013 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.account_statuses"} */
drop table if exists "merchant_data"."public"."account_statuses__dbt_backup" cascade
[0m21:49:03.406926 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m21:49:03.407927 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: Close
[0m21:49:03.409925 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96714723-3e0b-4495-ac30-c0db4427a163', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273D7230110>]}
[0m21:49:03.409925 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.account_statuses ....................... [[32mCREATE VIEW[0m in 0.16s]
[0m21:49:03.410926 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.account_statuses
[0m21:49:03.411924 [debug] [MainThread]: Using postgres connection "master"
[0m21:49:03.412925 [debug] [MainThread]: On master: BEGIN
[0m21:49:03.412925 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:49:03.449956 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m21:49:03.450921 [debug] [MainThread]: On master: COMMIT
[0m21:49:03.450921 [debug] [MainThread]: Using postgres connection "master"
[0m21:49:03.450921 [debug] [MainThread]: On master: COMMIT
[0m21:49:03.451919 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:49:03.451919 [debug] [MainThread]: On master: Close
[0m21:49:03.451919 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:49:03.453008 [debug] [MainThread]: Connection 'list_merchant_data' was properly closed.
[0m21:49:03.453008 [debug] [MainThread]: Connection 'list_merchant_data_public' was properly closed.
[0m21:49:03.453008 [debug] [MainThread]: Connection 'model.merchant_data_project.account_statuses' was properly closed.
[0m21:49:03.453008 [info ] [MainThread]: 
[0m21:49:03.454029 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m21:49:03.455434 [debug] [MainThread]: Command end result
[0m21:49:03.481448 [info ] [MainThread]: 
[0m21:49:03.482439 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:49:03.482439 [info ] [MainThread]: 
[0m21:49:03.483444 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:49:03.485503 [debug] [MainThread]: Command `dbt run` succeeded at 21:49:03.485503 after 1.94 seconds
[0m21:49:03.485503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273DA17FFE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273DA083FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273D7230110>]}
[0m21:49:03.486543 [debug] [MainThread]: Flushing usage events
[0m21:54:47.980950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF5B4A1610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF5B4A1550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF5B4A1340>]}


============================== 21:54:47.984467 | fe5f25e5-b2dd-49b3-9570-9c955560dd35 ==============================
[0m21:54:47.984467 [info ] [MainThread]: Running with dbt=1.8.8
[0m21:54:47.985467 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alvaro\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\alvaro\\Desktop\\sumup_assignment\\merchant_data_project\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select account_statuses', 'send_anonymous_usage_stats': 'True'}
[0m21:54:48.152012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe5f25e5-b2dd-49b3-9570-9c955560dd35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF5B593680>]}
[0m21:54:48.197536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe5f25e5-b2dd-49b3-9570-9c955560dd35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF57F94E30>]}
[0m21:54:48.198537 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:54:48.209007 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m21:54:48.279129 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m21:54:48.280112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fe5f25e5-b2dd-49b3-9570-9c955560dd35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF5A5D03B0>]}
[0m21:54:49.111143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe5f25e5-b2dd-49b3-9570-9c955560dd35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF5B79BEF0>]}
[0m21:54:49.184886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe5f25e5-b2dd-49b3-9570-9c955560dd35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF5BEA6D50>]}
[0m21:54:49.184886 [info ] [MainThread]: Found 1 model, 10 sources, 423 macros
[0m21:54:49.185993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe5f25e5-b2dd-49b3-9570-9c955560dd35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF5BEC2CC0>]}
[0m21:54:49.186895 [info ] [MainThread]: 
[0m21:54:49.187883 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:54:49.188886 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merchant_data'
[0m21:54:49.243904 [debug] [ThreadPool]: Using postgres connection "list_merchant_data"
[0m21:54:49.243904 [debug] [ThreadPool]: On list_merchant_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "list_merchant_data"} */

    select distinct nspname from pg_namespace
  
[0m21:54:49.244892 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:54:49.283689 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.039 seconds
[0m21:54:49.284931 [debug] [ThreadPool]: On list_merchant_data: Close
[0m21:54:49.286105 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merchant_data_public'
[0m21:54:49.293133 [debug] [ThreadPool]: Using postgres connection "list_merchant_data_public"
[0m21:54:49.293133 [debug] [ThreadPool]: On list_merchant_data_public: BEGIN
[0m21:54:49.293133 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:54:49.334192 [debug] [ThreadPool]: SQL status: BEGIN in 0.040 seconds
[0m21:54:49.334192 [debug] [ThreadPool]: Using postgres connection "list_merchant_data_public"
[0m21:54:49.335181 [debug] [ThreadPool]: On list_merchant_data_public: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "list_merchant_data_public"} */
select
      'merchant_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'merchant_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'merchant_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:54:49.340175 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.005 seconds
[0m21:54:49.342176 [debug] [ThreadPool]: On list_merchant_data_public: ROLLBACK
[0m21:54:49.343176 [debug] [ThreadPool]: On list_merchant_data_public: Close
[0m21:54:49.385778 [debug] [MainThread]: Using postgres connection "master"
[0m21:54:49.386780 [debug] [MainThread]: On master: BEGIN
[0m21:54:49.386780 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:54:49.533978 [debug] [MainThread]: SQL status: BEGIN in 0.147 seconds
[0m21:54:49.533978 [debug] [MainThread]: Using postgres connection "master"
[0m21:54:49.533978 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:54:49.539971 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m21:54:49.540967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe5f25e5-b2dd-49b3-9570-9c955560dd35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF598A24E0>]}
[0m21:54:49.540967 [debug] [MainThread]: On master: ROLLBACK
[0m21:54:49.542311 [debug] [MainThread]: Using postgres connection "master"
[0m21:54:49.542311 [debug] [MainThread]: On master: BEGIN
[0m21:54:49.543319 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:54:49.543319 [debug] [MainThread]: On master: COMMIT
[0m21:54:49.543319 [debug] [MainThread]: Using postgres connection "master"
[0m21:54:49.543319 [debug] [MainThread]: On master: COMMIT
[0m21:54:49.544317 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:54:49.544317 [debug] [MainThread]: On master: Close
[0m21:54:49.544317 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:54:49.545319 [info ] [MainThread]: 
[0m21:54:49.547690 [debug] [Thread-1 (]: Began running node model.merchant_data_project.account_statuses
[0m21:54:49.548696 [info ] [Thread-1 (]: 1 of 1 START sql view model public.account_statuses ............................ [RUN]
[0m21:54:49.549702 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.merchant_data_project.account_statuses'
[0m21:54:49.549702 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.account_statuses
[0m21:54:49.554699 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.account_statuses"
[0m21:54:49.554699 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.account_statuses
[0m21:54:49.591027 [debug] [Thread-1 (]: Writing runtime sql for node "model.merchant_data_project.account_statuses"
[0m21:54:49.591936 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m21:54:49.592949 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: BEGIN
[0m21:54:49.593947 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:54:49.629856 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m21:54:49.629856 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m21:54:49.629856 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.account_statuses"} */

  create view "merchant_data"."public"."account_statuses__dbt_tmp"
    
    
  as (
    SELECT *
FROM public.card_reader_types
LIMIT 10
  );
[0m21:54:49.634983 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m21:54:49.641087 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m21:54:49.641087 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.account_statuses"} */
alter table "merchant_data"."public"."account_statuses" rename to "account_statuses__dbt_backup"
[0m21:54:49.641985 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:54:49.644064 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m21:54:49.644064 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.account_statuses"} */
alter table "merchant_data"."public"."account_statuses__dbt_tmp" rename to "account_statuses"
[0m21:54:49.645088 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:54:49.657074 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: COMMIT
[0m21:54:49.657996 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m21:54:49.657996 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: COMMIT
[0m21:54:49.686762 [debug] [Thread-1 (]: SQL status: COMMIT in 0.028 seconds
[0m21:54:49.694768 [debug] [Thread-1 (]: Applying DROP to: "merchant_data"."public"."account_statuses__dbt_backup"
[0m21:54:49.700770 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m21:54:49.701769 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.account_statuses"} */
drop table if exists "merchant_data"."public"."account_statuses__dbt_backup" cascade
[0m21:54:49.706771 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m21:54:49.709867 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: Close
[0m21:54:49.710772 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe5f25e5-b2dd-49b3-9570-9c955560dd35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF57F2C5C0>]}
[0m21:54:49.710772 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.account_statuses ....................... [[32mCREATE VIEW[0m in 0.16s]
[0m21:54:49.711829 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.account_statuses
[0m21:54:49.713910 [debug] [MainThread]: Using postgres connection "master"
[0m21:54:49.713910 [debug] [MainThread]: On master: BEGIN
[0m21:54:49.714928 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:54:49.749917 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m21:54:49.749917 [debug] [MainThread]: On master: COMMIT
[0m21:54:49.749917 [debug] [MainThread]: Using postgres connection "master"
[0m21:54:49.751005 [debug] [MainThread]: On master: COMMIT
[0m21:54:49.751005 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:54:49.751005 [debug] [MainThread]: On master: Close
[0m21:54:49.751925 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:54:49.751925 [debug] [MainThread]: Connection 'list_merchant_data' was properly closed.
[0m21:54:49.751925 [debug] [MainThread]: Connection 'list_merchant_data_public' was properly closed.
[0m21:54:49.752926 [debug] [MainThread]: Connection 'model.merchant_data_project.account_statuses' was properly closed.
[0m21:54:49.752926 [info ] [MainThread]: 
[0m21:54:49.753916 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m21:54:49.754909 [debug] [MainThread]: Command end result
[0m21:54:49.780009 [info ] [MainThread]: 
[0m21:54:49.782502 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:54:49.782502 [info ] [MainThread]: 
[0m21:54:49.784046 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:54:49.785148 [debug] [MainThread]: Command `dbt run` succeeded at 21:54:49.785148 after 1.92 seconds
[0m21:54:49.786144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF5AD847D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF5BEA6AE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF5A833FB0>]}
[0m21:54:49.786144 [debug] [MainThread]: Flushing usage events
[0m22:00:46.578411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB56F7B6E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB52CBF260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB52E41340>]}


============================== 22:00:46.583378 | 05728b87-05a3-4845-9cf9-7dbb2f756bbd ==============================
[0m22:00:46.583378 [info ] [MainThread]: Running with dbt=1.8.8
[0m22:00:46.583378 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alvaro\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\alvaro\\Desktop\\sumup_assignment\\merchant_data_project\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:00:46.599808 [info ] [MainThread]: dbt version: 1.8.8
[0m22:00:46.599808 [info ] [MainThread]: python version: 3.12.7
[0m22:00:46.599808 [info ] [MainThread]: python path: C:\Users\alvaro\Desktop\sumup_assignment\dbt-sumup\Scripts\python.exe
[0m22:00:46.600811 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m22:00:46.704451 [info ] [MainThread]: Using profiles dir at C:\Users\alvaro\.dbt
[0m22:00:46.704451 [info ] [MainThread]: Using profiles.yml file at C:\Users\alvaro\.dbt\profiles.yml
[0m22:00:46.705934 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\alvaro\Desktop\sumup_assignment\merchant_data_project\dbt_project.yml
[0m22:00:46.706942 [info ] [MainThread]: adapter type: postgres
[0m22:00:46.707945 [info ] [MainThread]: adapter version: 1.8.2
[0m22:00:46.799900 [info ] [MainThread]: Configuration:
[0m22:00:46.799900 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:00:46.800898 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:00:46.801915 [info ] [MainThread]: Required dependencies:
[0m22:00:46.802896 [debug] [MainThread]: Executing "git --help"
[0m22:00:46.834551 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:00:46.835558 [debug] [MainThread]: STDERR: "b''"
[0m22:00:46.835558 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:00:46.836564 [info ] [MainThread]: Connection:
[0m22:00:46.837564 [info ] [MainThread]:   host: localhost
[0m22:00:46.837564 [info ] [MainThread]:   port: 5432
[0m22:00:46.838586 [info ] [MainThread]:   user: postgres
[0m22:00:46.839602 [info ] [MainThread]:   database: merchant_data
[0m22:00:46.839602 [info ] [MainThread]:   schema: public
[0m22:00:46.840594 [info ] [MainThread]:   connect_timeout: 10
[0m22:00:46.840594 [info ] [MainThread]:   role: None
[0m22:00:46.841593 [info ] [MainThread]:   search_path: None
[0m22:00:46.842594 [info ] [MainThread]:   keepalives_idle: 0
[0m22:00:46.842594 [info ] [MainThread]:   sslmode: None
[0m22:00:46.843595 [info ] [MainThread]:   sslcert: None
[0m22:00:46.843595 [info ] [MainThread]:   sslkey: None
[0m22:00:46.844594 [info ] [MainThread]:   sslrootcert: None
[0m22:00:46.844594 [info ] [MainThread]:   application_name: dbt
[0m22:00:46.845675 [info ] [MainThread]:   retries: 1
[0m22:00:46.846907 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:00:46.847917 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m22:00:46.902633 [debug] [MainThread]: Using postgres connection "debug"
[0m22:00:46.903655 [debug] [MainThread]: On debug: select 1 as id
[0m22:00:46.903655 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:00:46.949939 [debug] [MainThread]: SQL status: SELECT 1 in 0.046 seconds
[0m22:00:46.951021 [debug] [MainThread]: On debug: Close
[0m22:00:46.951021 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m22:00:46.951941 [info ] [MainThread]: [32mAll checks passed![0m
[0m22:00:46.952941 [debug] [MainThread]: Command `dbt debug` succeeded at 22:00:46.952941 after 0.51 seconds
[0m22:00:46.954448 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:00:46.954448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB56E97920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB56C06960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB56F7B6E0>]}
[0m22:00:46.955454 [debug] [MainThread]: Flushing usage events
[0m22:03:32.680089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C938978E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C939DC9100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C93BA6B1A0>]}


============================== 22:03:32.684657 | f67ed260-1343-457e-a20d-e035398c54d0 ==============================
[0m22:03:32.684657 [info ] [MainThread]: Running with dbt=1.8.8
[0m22:03:32.685725 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alvaro\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\alvaro\\Desktop\\sumup_assignment\\merchant_data_project\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:03:32.703265 [info ] [MainThread]: dbt version: 1.8.8
[0m22:03:32.703772 [info ] [MainThread]: python version: 3.12.7
[0m22:03:32.704779 [info ] [MainThread]: python path: C:\Users\alvaro\Desktop\sumup_assignment\dbt-sumup\Scripts\python.exe
[0m22:03:32.705780 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m22:03:32.826492 [info ] [MainThread]: Using profiles dir at C:\Users\alvaro\.dbt
[0m22:03:32.827493 [info ] [MainThread]: Using profiles.yml file at C:\Users\alvaro\.dbt\profiles.yml
[0m22:03:32.828477 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\alvaro\Desktop\sumup_assignment\merchant_data_project\dbt_project.yml
[0m22:03:32.829473 [info ] [MainThread]: adapter type: postgres
[0m22:03:32.830473 [info ] [MainThread]: adapter version: 1.8.2
[0m22:03:32.972153 [info ] [MainThread]: Configuration:
[0m22:03:32.973660 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:03:32.974670 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:03:32.975700 [info ] [MainThread]: Required dependencies:
[0m22:03:32.976675 [debug] [MainThread]: Executing "git --help"
[0m22:03:33.029183 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:03:33.030196 [debug] [MainThread]: STDERR: "b''"
[0m22:03:33.031187 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:03:33.032186 [info ] [MainThread]: Connection:
[0m22:03:33.032186 [info ] [MainThread]:   host: localhost
[0m22:03:33.033695 [info ] [MainThread]:   port: 5432
[0m22:03:33.034706 [info ] [MainThread]:   user: postgres
[0m22:03:33.034706 [info ] [MainThread]:   database: merchant_data
[0m22:03:33.035716 [info ] [MainThread]:   schema: public
[0m22:03:33.036721 [info ] [MainThread]:   connect_timeout: 10
[0m22:03:33.037719 [info ] [MainThread]:   role: None
[0m22:03:33.038714 [info ] [MainThread]:   search_path: None
[0m22:03:33.038714 [info ] [MainThread]:   keepalives_idle: 0
[0m22:03:33.039718 [info ] [MainThread]:   sslmode: None
[0m22:03:33.040715 [info ] [MainThread]:   sslcert: None
[0m22:03:33.040715 [info ] [MainThread]:   sslkey: None
[0m22:03:33.041717 [info ] [MainThread]:   sslrootcert: None
[0m22:03:33.042714 [info ] [MainThread]:   application_name: dbt
[0m22:03:33.042714 [info ] [MainThread]:   retries: 1
[0m22:03:33.044906 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:03:33.046918 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m22:03:33.143600 [debug] [MainThread]: Using postgres connection "debug"
[0m22:03:33.143600 [debug] [MainThread]: On debug: select 1 as id
[0m22:03:33.144608 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:03:33.301049 [debug] [MainThread]: SQL status: SELECT 1 in 0.156 seconds
[0m22:03:33.302050 [debug] [MainThread]: On debug: Close
[0m22:03:33.302050 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m22:03:33.303568 [info ] [MainThread]: [32mAll checks passed![0m
[0m22:03:33.304581 [debug] [MainThread]: Command `dbt debug` succeeded at 22:03:33.304581 after 0.77 seconds
[0m22:03:33.305575 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:03:33.305575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C938540E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C93C77C5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C93C69B500>]}
[0m22:03:33.306582 [debug] [MainThread]: Flushing usage events
[0m15:09:44.829843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADB8D39F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADB8D39A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADB88510D0>]}


============================== 15:09:44.837843 | ea0dfd1e-aeb2-4d6c-ac58-0ac36f939f66 ==============================
[0m15:09:44.837843 [info ] [MainThread]: Running with dbt=1.8.8
[0m15:09:44.838843 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\alvaro\\.dbt', 'log_path': 'C:\\Users\\alvaro\\Desktop\\sumup_assignment\\merchant_data_project\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m15:09:44.972463 [info ] [MainThread]: dbt version: 1.8.8
[0m15:09:44.973481 [info ] [MainThread]: python version: 3.12.7
[0m15:09:44.974382 [info ] [MainThread]: python path: C:\Users\alvaro\Desktop\sumup_assignment\dbt-sumup\Scripts\python.exe
[0m15:09:44.974382 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m15:09:45.331379 [info ] [MainThread]: Using profiles dir at C:\Users\alvaro\.dbt
[0m15:09:45.332385 [info ] [MainThread]: Using profiles.yml file at C:\Users\alvaro\.dbt\profiles.yml
[0m15:09:45.332385 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\alvaro\Desktop\sumup_assignment\merchant_data_project\dbt_project.yml
[0m15:09:45.344852 [info ] [MainThread]: adapter type: postgres
[0m15:09:45.345859 [info ] [MainThread]: adapter version: 1.8.2
[0m15:09:45.416061 [info ] [MainThread]: Configuration:
[0m15:09:45.417066 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:09:45.417959 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:09:45.417959 [info ] [MainThread]: Required dependencies:
[0m15:09:45.419481 [debug] [MainThread]: Executing "git --help"
[0m15:09:45.454179 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:09:45.454179 [debug] [MainThread]: STDERR: "b''"
[0m15:09:45.454179 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:09:45.456177 [info ] [MainThread]: Connection:
[0m15:09:45.457141 [info ] [MainThread]:   host: localhost
[0m15:09:45.457141 [info ] [MainThread]:   port: 5432
[0m15:09:45.458143 [info ] [MainThread]:   user: postgres
[0m15:09:45.458143 [info ] [MainThread]:   database: merchant_data
[0m15:09:45.459140 [info ] [MainThread]:   schema: public
[0m15:09:45.460139 [info ] [MainThread]:   connect_timeout: 10
[0m15:09:45.460139 [info ] [MainThread]:   role: None
[0m15:09:45.461141 [info ] [MainThread]:   search_path: None
[0m15:09:45.461141 [info ] [MainThread]:   keepalives_idle: 0
[0m15:09:45.462139 [info ] [MainThread]:   sslmode: None
[0m15:09:45.463144 [info ] [MainThread]:   sslcert: None
[0m15:09:45.463144 [info ] [MainThread]:   sslkey: None
[0m15:09:45.464141 [info ] [MainThread]:   sslrootcert: None
[0m15:09:45.465142 [info ] [MainThread]:   application_name: dbt
[0m15:09:45.465142 [info ] [MainThread]:   retries: 1
[0m15:09:45.466154 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:09:45.467144 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m15:09:47.273540 [debug] [MainThread]: Using postgres connection "debug"
[0m15:09:47.273540 [debug] [MainThread]: On debug: select 1 as id
[0m15:09:47.273540 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:09:47.312667 [debug] [MainThread]: SQL status: SELECT 1 in 0.038 seconds
[0m15:09:47.313756 [debug] [MainThread]: On debug: Close
[0m15:09:47.313756 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:09:47.314668 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:09:47.315663 [debug] [MainThread]: Command `dbt debug` succeeded at 15:09:47.315663 after 2.60 seconds
[0m15:09:47.316689 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:09:47.316689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADBC955730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADBCE0E150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADBCBF9790>]}
[0m15:09:47.316689 [debug] [MainThread]: Flushing usage events
[0m17:52:40.741972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE7EBF2F00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE01768C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE01768C50>]}


============================== 17:52:40.744974 | 6b244466-d4f1-4b8a-a139-ff64a5890982 ==============================
[0m17:52:40.744974 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:52:40.745971 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alvaro\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\alvaro\\Desktop\\sumup_assignment\\merchant_data_project\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:52:40.756991 [info ] [MainThread]: dbt version: 1.8.8
[0m17:52:40.756991 [info ] [MainThread]: python version: 3.12.7
[0m17:52:40.757970 [info ] [MainThread]: python path: C:\Users\alvaro\Desktop\sumup_assignment\dbt-sumup\Scripts\python.exe
[0m17:52:40.757970 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m17:52:40.836529 [info ] [MainThread]: Using profiles dir at C:\Users\alvaro\.dbt
[0m17:52:40.837530 [info ] [MainThread]: Using profiles.yml file at C:\Users\alvaro\.dbt\profiles.yml
[0m17:52:40.837530 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\alvaro\Desktop\sumup_assignment\merchant_data_project\dbt_project.yml
[0m17:52:40.838532 [info ] [MainThread]: adapter type: postgres
[0m17:52:40.839530 [info ] [MainThread]: adapter version: 1.8.2
[0m17:52:40.923042 [info ] [MainThread]: Configuration:
[0m17:52:40.923042 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:52:40.924043 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:52:40.925046 [info ] [MainThread]: Required dependencies:
[0m17:52:40.925046 [debug] [MainThread]: Executing "git --help"
[0m17:52:40.956047 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:52:40.957046 [debug] [MainThread]: STDERR: "b''"
[0m17:52:40.957046 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:52:40.958044 [info ] [MainThread]: Connection:
[0m17:52:40.959043 [info ] [MainThread]:   host: localhost
[0m17:52:40.959043 [info ] [MainThread]:   port: 5432
[0m17:52:40.960046 [info ] [MainThread]:   user: postgres
[0m17:52:40.961046 [info ] [MainThread]:   database: merchant_data
[0m17:52:40.961046 [info ] [MainThread]:   schema: public
[0m17:52:40.962052 [info ] [MainThread]:   connect_timeout: 10
[0m17:52:40.962052 [info ] [MainThread]:   role: None
[0m17:52:40.963057 [info ] [MainThread]:   search_path: None
[0m17:52:40.963057 [info ] [MainThread]:   keepalives_idle: 0
[0m17:52:40.963057 [info ] [MainThread]:   sslmode: None
[0m17:52:40.964059 [info ] [MainThread]:   sslcert: None
[0m17:52:40.964059 [info ] [MainThread]:   sslkey: None
[0m17:52:40.965057 [info ] [MainThread]:   sslrootcert: None
[0m17:52:40.965057 [info ] [MainThread]:   application_name: dbt
[0m17:52:40.965057 [info ] [MainThread]:   retries: 1
[0m17:52:40.966056 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:52:40.967056 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m17:52:41.021430 [debug] [MainThread]: Using postgres connection "debug"
[0m17:52:41.021430 [debug] [MainThread]: On debug: select 1 as id
[0m17:52:41.021430 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:52:41.059185 [debug] [MainThread]: SQL status: SELECT 1 in 0.037 seconds
[0m17:52:41.060192 [debug] [MainThread]: On debug: Close
[0m17:52:41.060192 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:52:41.060192 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:52:41.061648 [debug] [MainThread]: Command `dbt debug` succeeded at 17:52:41.061648 after 0.42 seconds
[0m17:52:41.062653 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:52:41.062653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE7EBF2F00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE025F9130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE025FB830>]}
[0m17:52:41.063653 [debug] [MainThread]: Flushing usage events
[0m17:55:22.858609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EB06B4530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EB3369130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EB3368860>]}


============================== 17:55:22.863025 | 6fee8323-d948-4b9e-8874-85de961ceb34 ==============================
[0m17:55:22.863025 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:55:22.863025 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\alvaro\\Desktop\\sumup_assignment\\merchant_data_project\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\alvaro\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build --select curated_merchant_data', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:55:23.040320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6fee8323-d948-4b9e-8874-85de961ceb34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EB27109B0>]}
[0m17:55:23.087753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6fee8323-d948-4b9e-8874-85de961ceb34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EB4190E30>]}
[0m17:55:23.088754 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:55:23.105750 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m17:55:23.173366 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m17:55:23.174363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6fee8323-d948-4b9e-8874-85de961ceb34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EB4A18380>]}
[0m17:55:24.587244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6fee8323-d948-4b9e-8874-85de961ceb34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EB4B50470>]}
[0m17:55:24.806774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6fee8323-d948-4b9e-8874-85de961ceb34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EB4BB8380>]}
[0m17:55:24.807771 [info ] [MainThread]: Found 19 models, 10 sources, 423 macros
[0m17:55:24.809832 [info ] [MainThread]: 
[0m17:55:24.810771 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:55:24.811896 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merchant_data'
[0m17:55:24.864697 [debug] [ThreadPool]: Using postgres connection "list_merchant_data"
[0m17:55:24.864697 [debug] [ThreadPool]: On list_merchant_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "list_merchant_data"} */

    select distinct nspname from pg_namespace
  
[0m17:55:24.864697 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:55:24.902124 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.037 seconds
[0m17:55:24.903210 [debug] [ThreadPool]: On list_merchant_data: Close
[0m17:55:24.909248 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merchant_data_public'
[0m17:55:24.913368 [debug] [ThreadPool]: Using postgres connection "list_merchant_data_public"
[0m17:55:24.913368 [debug] [ThreadPool]: On list_merchant_data_public: BEGIN
[0m17:55:24.914346 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:55:24.949298 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m17:55:24.949298 [debug] [ThreadPool]: Using postgres connection "list_merchant_data_public"
[0m17:55:24.949298 [debug] [ThreadPool]: On list_merchant_data_public: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "list_merchant_data_public"} */
select
      'merchant_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'merchant_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'merchant_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:55:24.956337 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.006 seconds
[0m17:55:24.957404 [debug] [ThreadPool]: On list_merchant_data_public: ROLLBACK
[0m17:55:24.958305 [debug] [ThreadPool]: On list_merchant_data_public: Close
[0m17:55:24.963302 [debug] [MainThread]: Using postgres connection "master"
[0m17:55:24.963302 [debug] [MainThread]: On master: BEGIN
[0m17:55:24.963302 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:55:24.996452 [debug] [MainThread]: SQL status: BEGIN in 0.032 seconds
[0m17:55:24.996452 [debug] [MainThread]: Using postgres connection "master"
[0m17:55:24.996452 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:55:25.004563 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m17:55:25.005469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fee8323-d948-4b9e-8874-85de961ceb34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EB52D72F0>]}
[0m17:55:25.005469 [debug] [MainThread]: On master: ROLLBACK
[0m17:55:25.006470 [debug] [MainThread]: Using postgres connection "master"
[0m17:55:25.006470 [debug] [MainThread]: On master: BEGIN
[0m17:55:25.007471 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:55:25.007471 [debug] [MainThread]: On master: COMMIT
[0m17:55:25.007471 [debug] [MainThread]: Using postgres connection "master"
[0m17:55:25.007471 [debug] [MainThread]: On master: COMMIT
[0m17:55:25.008587 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:55:25.008587 [debug] [MainThread]: On master: Close
[0m17:55:25.008587 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:55:25.009471 [info ] [MainThread]: 
[0m17:55:25.013470 [debug] [Thread-1 (]: Began running node model.merchant_data_project.curated_merchant_data
[0m17:55:25.014558 [info ] [Thread-1 (]: 1 of 1 START sql view model public.curated_merchant_data ....................... [RUN]
[0m17:55:25.015469 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.merchant_data_project.curated_merchant_data'
[0m17:55:25.015469 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.curated_merchant_data
[0m17:55:25.024475 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.curated_merchant_data"
[0m17:55:25.026472 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.curated_merchant_data
[0m17:55:25.054166 [debug] [Thread-1 (]: Writing runtime sql for node "model.merchant_data_project.curated_merchant_data"
[0m17:55:25.056488 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.curated_merchant_data"
[0m17:55:25.056488 [debug] [Thread-1 (]: On model.merchant_data_project.curated_merchant_data: BEGIN
[0m17:55:25.057581 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:55:25.201833 [debug] [Thread-1 (]: SQL status: BEGIN in 0.144 seconds
[0m17:55:25.201833 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.curated_merchant_data"
[0m17:55:25.201833 [debug] [Thread-1 (]: On model.merchant_data_project.curated_merchant_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.curated_merchant_data"} */

  create view "merchant_data"."public"."curated_merchant_data__dbt_tmp"
    
    
  as (
    WITH merchant_signup AS (
    -- Define the 7, 30, 90, 180, 365 day periods after signup for each merchant
    SELECT
        merchant_id,
        sign_up_time,
        sign_up_time + INTERVAL '7 days' AS signup_plus_7_days,
        sign_up_time + INTERVAL '30 days' AS signup_plus_30_days,
        sign_up_time + INTERVAL '90 days' AS signup_plus_90_days,
        sign_up_time + INTERVAL '180 days' AS signup_plus_180_days,
        sign_up_time + INTERVAL '365 days' AS signup_plus_365_days
    FROM "merchant_data"."public"."merchants"
),

-- Checking the output of merchant signup information
-- select * from merchant_signup
successful_transactions AS (
    -- Get successful transactions per merchant
    SELECT
        t.merchant_id,
        t.server_time_created_at,
        row_number() OVER (PARTITION BY t.merchant_id ORDER BY t.server_time_created_at) AS transaction_rank
    FROM "merchant_data"."public"."transactions" t
    WHERE t.tx_result = 11  -- Only successful transactions
),

first_successful_transaction AS (
    -- Get first successful transaction date for each merchant
    SELECT
        st.merchant_id,
        min(st.server_time_created_at) AS first_successful_transaction_date
    FROM successful_transactions st
    WHERE st.transaction_rank = 1
    GROUP BY st.merchant_id
),

-- Checking the output of the first successful transaction
-- select * from first_successful_transaction

successful_card_present_transactions AS (
    SELECT
        t.merchant_id,
        t.server_time_created_at,
        row_number() OVER (PARTITION BY t.merchant_id ORDER BY t.server_time_created_at) AS transaction_rank
    FROM "merchant_data"."public"."transactions" t
    JOIN "merchant_data"."public"."payment_types" pt
        ON t.payment_type_code = pt.code  -- Joining ON the payment type code
    WHERE t.tx_result = 11  -- Successful transaction (tx_result = 11)
      AND NOT pt.code IN (8,9,12,14)  -- Card-not-present transaction codes
),

first_card_present_transaction AS (
    -- Get first card-present transaction date for each merchant
    SELECT
        st.merchant_id,
        min(st.server_time_created_at) AS first_card_present_transaction_date
    FROM successful_card_present_transactions st
    WHERE st.transaction_rank = 1  -- Get the first card-present transaction
    GROUP BY st.merchant_id
),

-- Checking the output of the first card-present transaction
-- select * from first_card_present_transaction

fifth_successful_transaction AS (
    -- Get fifth successful transaction date for each merchant
    SELECT
        st.merchant_id,
        min(st.server_time_created_at) AS fifth_successful_transaction_date
    FROM successful_transactions st
    WHERE st.transaction_rank = 5
    GROUP BY st.merchant_id
),

-- Checking the output of the fifth successful transaction
-- select * from fifth_successful_transaction


last_successful_transaction AS (
    -- Get last successful transaction date for each merchant
    SELECT
        st.merchant_id,
        max(st.server_time_created_at) AS last_successful_transaction_date
    FROM successful_transactions st
    WHERE st.transaction_rank = 1
    GROUP BY st.merchant_id
),

-- Checking the output of the fifth successful transaction
-- select * from last_successful_transaction

all_time_successful_transactions AS (
    -- Get all time successful transaction for each merchant
   SELECT
        t.merchant_id,
        count(*) AS all_time_successful_transactions
    FROM "merchant_data"."public"."transactions" t
    WHERE t.tx_result = 11  -- Successful transaction (tx_result = 11)
    GROUP BY t.merchant_id
),

-- Checking the output of the all time successful transactions
-- select * from all_time_successful_transactions

all_time_failed_transactions AS (
    -- Get all time failed transaction for each merchant
   SELECT
        t.merchant_id,
        count(*) AS all_time_failed_transactions
    FROM "merchant_data"."public"."transactions" t
    WHERE t.tx_result != 11  -- failed transaction (tx_result != 11)
    GROUP BY t.merchant_id
),

-- Checking the output of the all time failed transactions
-- select * from all_time_failed_transactions

transactions_in_period AS (
    -- Join transactions WITH calculated periods, filtering by successful transactions within 365 days of signup
    SELECT
        m.merchant_id,
        t.amount,
        t.vat_amount,
        t.tip_amount,
        t.currency,
        CASE
            WHEN t.server_time_created_at >= m.sign_up_time 
                 AND t.server_time_created_at < m.signup_plus_7_days THEN '7_day'
            WHEN t.server_time_created_at >= m.sign_up_time
                 AND t.server_time_created_at < m.signup_plus_30_days THEN '30_day'
            WHEN t.server_time_created_at >= m.sign_up_time
                 AND t.server_time_created_at < m.signup_plus_90_days THEN '90_day'
            WHEN t.server_time_created_at >= m.sign_up_time
                 AND t.server_time_created_at < m.signup_plus_180_days THEN '180_day'
            WHEN t.server_time_created_at >= m.sign_up_time
                 AND t.server_time_created_at < m.signup_plus_365_days THEN '365_day'
        END AS PERIOD
    FROM merchant_signup m
    JOIN "merchant_data"."public"."transactions" t
        ON m.merchant_id = t.merchant_id
    WHERE t.tx_result = 11  -- Only successful transactions
      AND t.server_time_created_at < m.signup_plus_365_days
),

tpv_summary AS (
    SELECT
        merchant_id,
        sum(CASE WHEN PERIOD = '7_day' THEN amount + vat_amount + tip_amount ELSE 0 END) AS tpv_7_day,
        sum(CASE WHEN PERIOD IN ('7_day', '30_day') THEN amount + vat_amount + tip_amount ELSE 0 END) AS tpv_30_day,
        sum(CASE WHEN PERIOD IN ('7_day', '30_day', '90_day') THEN amount + vat_amount + tip_amount ELSE 0 END) AS tpv_90_day,
        sum(CASE WHEN PERIOD IN ('7_day', '30_day','90_day','180_day') THEN amount + vat_amount + tip_amount ELSE 0 END) AS tpv_180_day,
        sum(CASE WHEN PERIOD IN ('7_day', '30_day','90_day','180_day','365_day') THEN amount + vat_amount + tip_amount ELSE 0 END) AS tpv_365_day
    FROM transactions_in_period
    WHERE PERIOD IS NOT NULL
    GROUP BY merchant_id
)

-- Final selection combining all computed metrics

SELECT
    ms.merchant_id,
    ms.sign_up_time,
    fst.first_successful_transaction_date,
    fcpt.first_card_present_transaction_date,
    fifth.fifth_successful_transaction_date,
    lst.last_successful_transaction_date,
    atst.all_time_successful_transactions,
    atft.all_time_failed_transactions,
    tpv.tpv_7_day,
    tpv.tpv_30_day,
    tpv.tpv_90_day,
    tpv.tpv_180_day,
    tpv.tpv_365_day

FROM merchant_signup ms
LEFT JOIN first_successful_transaction fst ON ms.merchant_id = fst.merchant_id
LEFT JOIN first_card_present_transaction fcpt ON ms.merchant_id = fcpt.merchant_id
LEFT JOIN fifth_successful_transaction fifth ON ms.merchant_id = fifth.merchant_id
LEFT JOIN last_successful_transaction lst ON ms.merchant_id = lst.merchant_id
LEFT JOIN all_time_successful_transactions atst ON ms.merchant_id = atst.merchant_id
LEFT JOIN all_time_failed_transactions atft ON ms.merchant_id = atft.merchant_id
LEFT JOIN tpv_summary tpv ON ms.merchant_id = tpv.merchant_id

ORDER BY sign_up_time;
  );
[0m17:55:25.202915 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 189: ORDER BY sign_up_time;
                               ^

[0m17:55:25.203887 [debug] [Thread-1 (]: On model.merchant_data_project.curated_merchant_data: ROLLBACK
[0m17:55:25.203887 [debug] [Thread-1 (]: On model.merchant_data_project.curated_merchant_data: Close
[0m17:55:25.273582 [debug] [Thread-1 (]: Database Error in model curated_merchant_data (models\curated\curated_merchant_data.sql)
  syntax error at or near ";"
  LINE 189: ORDER BY sign_up_time;
                                 ^
  compiled code at target\run\merchant_data_project\models\curated\curated_merchant_data.sql
[0m17:55:25.274581 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fee8323-d948-4b9e-8874-85de961ceb34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EB449E030>]}
[0m17:55:25.275581 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.curated_merchant_data .............. [[31mERROR[0m in 0.26s]
[0m17:55:25.276621 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.curated_merchant_data
[0m17:55:25.277578 [debug] [MainThread]: Using postgres connection "master"
[0m17:55:25.277578 [debug] [MainThread]: On master: BEGIN
[0m17:55:25.278657 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:55:25.311415 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m17:55:25.311415 [debug] [MainThread]: On master: COMMIT
[0m17:55:25.312493 [debug] [MainThread]: Using postgres connection "master"
[0m17:55:25.312493 [debug] [MainThread]: On master: COMMIT
[0m17:55:25.312493 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:55:25.313502 [debug] [MainThread]: On master: Close
[0m17:55:25.313502 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:55:25.313502 [debug] [MainThread]: Connection 'list_merchant_data' was properly closed.
[0m17:55:25.314406 [debug] [MainThread]: Connection 'list_merchant_data_public' was properly closed.
[0m17:55:25.314406 [debug] [MainThread]: Connection 'model.merchant_data_project.curated_merchant_data' was properly closed.
[0m17:55:25.314406 [info ] [MainThread]: 
[0m17:55:25.315411 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m17:55:25.316404 [debug] [MainThread]: Command end result
[0m17:55:25.372927 [info ] [MainThread]: 
[0m17:55:25.376927 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:55:25.377927 [info ] [MainThread]: 
[0m17:55:25.378926 [error] [MainThread]:   Database Error in model curated_merchant_data (models\curated\curated_merchant_data.sql)
  syntax error at or near ";"
  LINE 189: ORDER BY sign_up_time;
                                 ^
  compiled code at target\run\merchant_data_project\models\curated\curated_merchant_data.sql
[0m17:55:25.379928 [info ] [MainThread]: 
[0m17:55:25.379928 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:55:25.380929 [debug] [MainThread]: Command `dbt build` failed at 17:55:25.380929 after 2.63 seconds
[0m17:55:25.381982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EB06B4530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EB2AD93D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EB3369B50>]}
[0m17:55:25.381982 [debug] [MainThread]: Flushing usage events
[0m18:05:20.741045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7B4E44E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7B35C5D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7B35C75C0>]}


============================== 18:05:20.744064 | 9ce12f51-4f48-4358-94b5-682b7ed01dea ==============================
[0m18:05:20.744064 [info ] [MainThread]: Running with dbt=1.8.8
[0m18:05:20.745047 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alvaro\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\alvaro\\Desktop\\sumup_assignment\\merchant_data_project\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build --select curated_merchant_data', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:05:20.897985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ce12f51-4f48-4358-94b5-682b7ed01dea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7B3810800>]}
[0m18:05:20.938594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ce12f51-4f48-4358-94b5-682b7ed01dea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7B4E46840>]}
[0m18:05:20.939584 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:05:20.945605 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m18:05:21.012504 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m18:05:21.013516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9ce12f51-4f48-4358-94b5-682b7ed01dea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7B42A3F50>]}
[0m18:05:21.828369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ce12f51-4f48-4358-94b5-682b7ed01dea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7B53399D0>]}
[0m18:05:21.955973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ce12f51-4f48-4358-94b5-682b7ed01dea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7B1C70320>]}
[0m18:05:21.955973 [info ] [MainThread]: Found 19 models, 11 sources, 423 macros
[0m18:05:21.957969 [info ] [MainThread]: 
[0m18:05:21.958969 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:05:21.960050 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merchant_data'
[0m18:05:22.011011 [debug] [ThreadPool]: Using postgres connection "list_merchant_data"
[0m18:05:22.012072 [debug] [ThreadPool]: On list_merchant_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "list_merchant_data"} */

    select distinct nspname from pg_namespace
  
[0m18:05:22.012072 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:05:22.167708 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.156 seconds
[0m18:05:22.168710 [debug] [ThreadPool]: On list_merchant_data: Close
[0m18:05:22.173708 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merchant_data_public'
[0m18:05:22.177795 [debug] [ThreadPool]: Using postgres connection "list_merchant_data_public"
[0m18:05:22.177795 [debug] [ThreadPool]: On list_merchant_data_public: BEGIN
[0m18:05:22.178799 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:05:22.208906 [debug] [ThreadPool]: SQL status: BEGIN in 0.031 seconds
[0m18:05:22.209900 [debug] [ThreadPool]: Using postgres connection "list_merchant_data_public"
[0m18:05:22.209900 [debug] [ThreadPool]: On list_merchant_data_public: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "list_merchant_data_public"} */
select
      'merchant_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'merchant_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'merchant_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:05:22.215837 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.006 seconds
[0m18:05:22.216798 [debug] [ThreadPool]: On list_merchant_data_public: ROLLBACK
[0m18:05:22.217798 [debug] [ThreadPool]: On list_merchant_data_public: Close
[0m18:05:22.223005 [debug] [MainThread]: Using postgres connection "master"
[0m18:05:22.223005 [debug] [MainThread]: On master: BEGIN
[0m18:05:22.224000 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:05:22.256045 [debug] [MainThread]: SQL status: BEGIN in 0.032 seconds
[0m18:05:22.256045 [debug] [MainThread]: Using postgres connection "master"
[0m18:05:22.256045 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:05:22.264012 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m18:05:22.265110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ce12f51-4f48-4358-94b5-682b7ed01dea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7B6094D40>]}
[0m18:05:22.265110 [debug] [MainThread]: On master: ROLLBACK
[0m18:05:22.266100 [debug] [MainThread]: Using postgres connection "master"
[0m18:05:22.267088 [debug] [MainThread]: On master: BEGIN
[0m18:05:22.267088 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:05:22.268010 [debug] [MainThread]: On master: COMMIT
[0m18:05:22.268010 [debug] [MainThread]: Using postgres connection "master"
[0m18:05:22.268010 [debug] [MainThread]: On master: COMMIT
[0m18:05:22.269007 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:05:22.269007 [debug] [MainThread]: On master: Close
[0m18:05:22.269007 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:05:22.270018 [info ] [MainThread]: 
[0m18:05:22.274007 [debug] [Thread-1 (]: Began running node model.merchant_data_project.curated_merchant_data
[0m18:05:22.274007 [info ] [Thread-1 (]: 1 of 1 START sql view model public.curated_merchant_data ....................... [RUN]
[0m18:05:22.275063 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.merchant_data_project.curated_merchant_data'
[0m18:05:22.275063 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.curated_merchant_data
[0m18:05:22.283120 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.curated_merchant_data"
[0m18:05:22.285008 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.curated_merchant_data
[0m18:05:22.314012 [debug] [Thread-1 (]: Writing runtime sql for node "model.merchant_data_project.curated_merchant_data"
[0m18:05:22.315087 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.curated_merchant_data"
[0m18:05:22.316082 [debug] [Thread-1 (]: On model.merchant_data_project.curated_merchant_data: BEGIN
[0m18:05:22.316082 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:05:22.349042 [debug] [Thread-1 (]: SQL status: BEGIN in 0.033 seconds
[0m18:05:22.350042 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.curated_merchant_data"
[0m18:05:22.350042 [debug] [Thread-1 (]: On model.merchant_data_project.curated_merchant_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.curated_merchant_data"} */

  create view "merchant_data"."public"."curated_merchant_data__dbt_tmp"
    
    
  as (
    WITH merchant_signup AS (
    -- Define the 7, 30, 90, 180, 365 day periods after signup for each merchant
    SELECT
        merchant_id,
        sign_up_time,
        sign_up_time + INTERVAL '7 days' AS signup_plus_7_days,
        sign_up_time + INTERVAL '30 days' AS signup_plus_30_days,
        sign_up_time + INTERVAL '90 days' AS signup_plus_90_days,
        sign_up_time + INTERVAL '180 days' AS signup_plus_180_days,
        sign_up_time + INTERVAL '365 days' AS signup_plus_365_days
    FROM "merchant_data"."public"."merchants"
),

-- Checking the output of merchant signup information
-- select * from merchant_signup
successful_transactions AS (
    -- Get successful transactions per merchant
    SELECT
        t.merchant_id,
        t.server_time_created_at,
        row_number() OVER (PARTITION BY t.merchant_id ORDER BY t.server_time_created_at) AS transaction_rank
    FROM "merchant_data"."public"."transactions" t
    WHERE t.tx_result = 11  -- Only successful transactions
),

first_successful_transaction AS (
    -- Get first successful transaction date for each merchant
    SELECT
        st.merchant_id,
        min(st.server_time_created_at) AS first_successful_transaction_date
    FROM successful_transactions st
    WHERE st.transaction_rank = 1
    GROUP BY st.merchant_id
),

-- Checking the output of the first successful transaction
-- select * from first_successful_transaction

successful_card_present_transactions AS (
    SELECT
        t.merchant_id,
        t.server_time_created_at,
        row_number() OVER (PARTITION BY t.merchant_id ORDER BY t.server_time_created_at) AS transaction_rank
    FROM "merchant_data"."public"."transactions" t
    JOIN "merchant_data"."public"."payment_types" pt
        ON t.payment_type_code = pt.code  -- Joining ON the payment type code
    WHERE t.tx_result = 11  -- Successful transaction (tx_result = 11)
      AND NOT pt.code IN (8,9,12,14)  -- Card-not-present transaction codes
),

first_card_present_transaction AS (
    -- Get first card-present transaction date for each merchant
    SELECT
        st.merchant_id,
        min(st.server_time_created_at) AS first_card_present_transaction_date
    FROM successful_card_present_transactions st
    WHERE st.transaction_rank = 1  -- Get the first card-present transaction
    GROUP BY st.merchant_id
),

-- Checking the output of the first card-present transaction
-- select * from first_card_present_transaction

fifth_successful_transaction AS (
    -- Get fifth successful transaction date for each merchant
    SELECT
        st.merchant_id,
        min(st.server_time_created_at) AS fifth_successful_transaction_date
    FROM successful_transactions st
    WHERE st.transaction_rank = 5
    GROUP BY st.merchant_id
),

-- Checking the output of the fifth successful transaction
-- select * from fifth_successful_transaction


last_successful_transaction AS (
    -- Get last successful transaction date for each merchant
    SELECT
        st.merchant_id,
        max(st.server_time_created_at) AS last_successful_transaction_date
    FROM successful_transactions st
    WHERE st.transaction_rank = 1
    GROUP BY st.merchant_id
),

-- Checking the output of the fifth successful transaction
-- select * from last_successful_transaction

all_time_successful_transactions AS (
    -- Get all time successful transaction for each merchant
   SELECT
        t.merchant_id,
        count(*) AS all_time_successful_transactions
    FROM "merchant_data"."public"."transactions" t
    WHERE t.tx_result = 11  -- Successful transaction (tx_result = 11)
    GROUP BY t.merchant_id
),

-- Checking the output of the all time successful transactions
-- select * from all_time_successful_transactions

all_time_failed_transactions AS (
    -- Get all time failed transaction for each merchant
   SELECT
        t.merchant_id,
        count(*) AS all_time_failed_transactions
    FROM "merchant_data"."public"."transactions" t
    WHERE t.tx_result != 11  -- failed transaction (tx_result != 11)
    GROUP BY t.merchant_id
),

-- Checking the output of the all time failed transactions
-- select * from all_time_failed_transactions

transactions_in_period AS (
    -- Join transactions WITH calculated periods, filtering by successful transactions within 365 days of signup
    SELECT
        m.merchant_id,
        t.amount,
        t.vat_amount,
        t.tip_amount,
        t.currency,
        CASE
            WHEN t.server_time_created_at >= m.sign_up_time 
                 AND t.server_time_created_at < m.signup_plus_7_days THEN '7_day'
            WHEN t.server_time_created_at >= m.sign_up_time
                 AND t.server_time_created_at < m.signup_plus_30_days THEN '30_day'
            WHEN t.server_time_created_at >= m.sign_up_time
                 AND t.server_time_created_at < m.signup_plus_90_days THEN '90_day'
            WHEN t.server_time_created_at >= m.sign_up_time
                 AND t.server_time_created_at < m.signup_plus_180_days THEN '180_day'
            WHEN t.server_time_created_at >= m.sign_up_time
                 AND t.server_time_created_at < m.signup_plus_365_days THEN '365_day'
        END AS PERIOD
    FROM merchant_signup m
    JOIN "merchant_data"."public"."transactions" t
        ON m.merchant_id = t.merchant_id
    WHERE t.tx_result = 11  -- Only successful transactions
      AND t.server_time_created_at < m.signup_plus_365_days
),

tpv_summary AS (
    SELECT
        merchant_id,
        sum(CASE WHEN PERIOD = '7_day' THEN amount + vat_amount + tip_amount ELSE 0 END) AS tpv_7_day,
        sum(CASE WHEN PERIOD IN ('7_day', '30_day') THEN amount + vat_amount + tip_amount ELSE 0 END) AS tpv_30_day,
        sum(CASE WHEN PERIOD IN ('7_day', '30_day', '90_day') THEN amount + vat_amount + tip_amount ELSE 0 END) AS tpv_90_day,
        sum(CASE WHEN PERIOD IN ('7_day', '30_day','90_day','180_day') THEN amount + vat_amount + tip_amount ELSE 0 END) AS tpv_180_day,
        sum(CASE WHEN PERIOD IN ('7_day', '30_day','90_day','180_day','365_day') THEN amount + vat_amount + tip_amount ELSE 0 END) AS tpv_365_day
    FROM transactions_in_period
    WHERE PERIOD IS NOT NULL
    GROUP BY merchant_id
)

-- Final selection combining all computed metrics

SELECT
    ms.merchant_id,
    ms.sign_up_time,
    fst.first_successful_transaction_date,
    fcpt.first_card_present_transaction_date,
    fifth.fifth_successful_transaction_date,
    lst.last_successful_transaction_date,
    atst.all_time_successful_transactions,
    atft.all_time_failed_transactions,
    tpv.tpv_7_day,
    tpv.tpv_30_day,
    tpv.tpv_90_day,
    tpv.tpv_180_day,
    tpv.tpv_365_day

FROM merchant_signup ms
LEFT JOIN first_successful_transaction fst ON ms.merchant_id = fst.merchant_id
LEFT JOIN first_card_present_transaction fcpt ON ms.merchant_id = fcpt.merchant_id
LEFT JOIN fifth_successful_transaction fifth ON ms.merchant_id = fifth.merchant_id
LEFT JOIN last_successful_transaction lst ON ms.merchant_id = lst.merchant_id
LEFT JOIN all_time_successful_transactions atst ON ms.merchant_id = atst.merchant_id
LEFT JOIN all_time_failed_transactions atft ON ms.merchant_id = atft.merchant_id
LEFT JOIN tpv_summary tpv ON ms.merchant_id = tpv.merchant_id

ORDER BY sign_up_time;
  );
[0m18:05:22.351041 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 189: ORDER BY sign_up_time;
                               ^

[0m18:05:22.352052 [debug] [Thread-1 (]: On model.merchant_data_project.curated_merchant_data: ROLLBACK
[0m18:05:22.352052 [debug] [Thread-1 (]: On model.merchant_data_project.curated_merchant_data: Close
[0m18:05:22.357041 [debug] [Thread-1 (]: Database Error in model curated_merchant_data (models\curated\curated_merchant_data.sql)
  syntax error at or near ";"
  LINE 189: ORDER BY sign_up_time;
                                 ^
  compiled code at target\run\merchant_data_project\models\curated\curated_merchant_data.sql
[0m18:05:22.358041 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ce12f51-4f48-4358-94b5-682b7ed01dea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7B53F2510>]}
[0m18:05:22.358041 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.curated_merchant_data .............. [[31mERROR[0m in 0.08s]
[0m18:05:22.360248 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.curated_merchant_data
[0m18:05:22.361196 [debug] [MainThread]: Using postgres connection "master"
[0m18:05:22.362155 [debug] [MainThread]: On master: BEGIN
[0m18:05:22.362155 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:05:22.507697 [debug] [MainThread]: SQL status: BEGIN in 0.146 seconds
[0m18:05:22.508780 [debug] [MainThread]: On master: COMMIT
[0m18:05:22.508780 [debug] [MainThread]: Using postgres connection "master"
[0m18:05:22.508780 [debug] [MainThread]: On master: COMMIT
[0m18:05:22.508780 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:05:22.509696 [debug] [MainThread]: On master: Close
[0m18:05:22.509696 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:05:22.509696 [debug] [MainThread]: Connection 'list_merchant_data' was properly closed.
[0m18:05:22.510707 [debug] [MainThread]: Connection 'list_merchant_data_public' was properly closed.
[0m18:05:22.510707 [debug] [MainThread]: Connection 'model.merchant_data_project.curated_merchant_data' was properly closed.
[0m18:05:22.510707 [info ] [MainThread]: 
[0m18:05:22.511706 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m18:05:22.512694 [debug] [MainThread]: Command end result
[0m18:05:22.542302 [info ] [MainThread]: 
[0m18:05:22.543306 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:05:22.544301 [info ] [MainThread]: 
[0m18:05:22.545331 [error] [MainThread]:   Database Error in model curated_merchant_data (models\curated\curated_merchant_data.sql)
  syntax error at or near ";"
  LINE 189: ORDER BY sign_up_time;
                                 ^
  compiled code at target\run\merchant_data_project\models\curated\curated_merchant_data.sql
[0m18:05:22.546306 [info ] [MainThread]: 
[0m18:05:22.547371 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:05:22.548308 [debug] [MainThread]: Command `dbt build` failed at 18:05:22.548308 after 1.90 seconds
[0m18:05:22.549307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7B4C24CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7B4221820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7B5A8EEA0>]}
[0m18:05:22.549307 [debug] [MainThread]: Flushing usage events
[0m18:13:38.286386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B9D4F2FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BA0068CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BA0069A60>]}


============================== 18:13:38.289404 | 6706406b-7262-422b-94a1-04972133d152 ==============================
[0m18:13:38.289404 [info ] [MainThread]: Running with dbt=1.8.8
[0m18:13:38.290385 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\alvaro\\.dbt', 'log_path': 'C:\\Users\\alvaro\\Desktop\\sumup_assignment\\merchant_data_project\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:13:38.446986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6706406b-7262-422b-94a1-04972133d152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B9DA2D730>]}
[0m18:13:38.488708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6706406b-7262-422b-94a1-04972133d152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B9F3A3B00>]}
[0m18:13:38.490623 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:13:38.496687 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m18:13:38.559694 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m18:13:38.560698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6706406b-7262-422b-94a1-04972133d152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BA00D0350>]}
[0m18:13:39.437303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6706406b-7262-422b-94a1-04972133d152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BA1883E00>]}
[0m18:13:39.547953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6706406b-7262-422b-94a1-04972133d152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BA18CB1A0>]}
[0m18:13:39.547953 [info ] [MainThread]: Found 19 models, 11 sources, 423 macros
[0m18:13:39.548940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6706406b-7262-422b-94a1-04972133d152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B9F6F0FB0>]}
[0m18:13:39.551050 [info ] [MainThread]: 
[0m18:13:39.551940 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:13:39.555942 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merchant_data'
[0m18:13:39.605606 [debug] [ThreadPool]: Using postgres connection "list_merchant_data"
[0m18:13:39.606609 [debug] [ThreadPool]: On list_merchant_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "list_merchant_data"} */

    select distinct nspname from pg_namespace
  
[0m18:13:39.606609 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:39.646986 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.040 seconds
[0m18:13:39.648093 [debug] [ThreadPool]: On list_merchant_data: Close
[0m18:13:39.650984 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merchant_data_public'
[0m18:13:39.655069 [debug] [ThreadPool]: Using postgres connection "list_merchant_data_public"
[0m18:13:39.656088 [debug] [ThreadPool]: On list_merchant_data_public: BEGIN
[0m18:13:39.656088 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:39.688514 [debug] [ThreadPool]: SQL status: BEGIN in 0.033 seconds
[0m18:13:39.688514 [debug] [ThreadPool]: Using postgres connection "list_merchant_data_public"
[0m18:13:39.689617 [debug] [ThreadPool]: On list_merchant_data_public: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "list_merchant_data_public"} */
select
      'merchant_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'merchant_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'merchant_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:13:39.695514 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.006 seconds
[0m18:13:39.697621 [debug] [ThreadPool]: On list_merchant_data_public: ROLLBACK
[0m18:13:39.697621 [debug] [ThreadPool]: On list_merchant_data_public: Close
[0m18:13:39.707518 [debug] [MainThread]: Using postgres connection "master"
[0m18:13:39.707518 [debug] [MainThread]: On master: BEGIN
[0m18:13:39.707518 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:13:39.742514 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m18:13:39.742514 [debug] [MainThread]: Using postgres connection "master"
[0m18:13:39.742514 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:13:39.750642 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m18:13:39.751558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6706406b-7262-422b-94a1-04972133d152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BA1EFD340>]}
[0m18:13:39.752558 [debug] [MainThread]: On master: ROLLBACK
[0m18:13:39.752558 [debug] [MainThread]: Using postgres connection "master"
[0m18:13:39.752558 [debug] [MainThread]: On master: BEGIN
[0m18:13:39.753640 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:13:39.753640 [debug] [MainThread]: On master: COMMIT
[0m18:13:39.753640 [debug] [MainThread]: Using postgres connection "master"
[0m18:13:39.754639 [debug] [MainThread]: On master: COMMIT
[0m18:13:39.754639 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:13:39.754639 [debug] [MainThread]: On master: Close
[0m18:13:39.755643 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:13:39.755643 [info ] [MainThread]: 
[0m18:13:39.760605 [debug] [Thread-1 (]: Began running node model.merchant_data_project.account_statuses
[0m18:13:39.760605 [info ] [Thread-1 (]: 1 of 19 START sql view model public.account_statuses ........................... [RUN]
[0m18:13:39.761612 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.merchant_data_project.account_statuses'
[0m18:13:39.762566 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.account_statuses
[0m18:13:39.768602 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.account_statuses"
[0m18:13:39.770567 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.account_statuses
[0m18:13:39.799859 [debug] [Thread-1 (]: Writing runtime sql for node "model.merchant_data_project.account_statuses"
[0m18:13:39.801981 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m18:13:39.801981 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: BEGIN
[0m18:13:39.803086 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:13:39.834991 [debug] [Thread-1 (]: SQL status: BEGIN in 0.032 seconds
[0m18:13:39.834991 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m18:13:39.836109 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.account_statuses"} */

  create view "merchant_data"."public"."account_statuses__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * from "merchant_data"."public"."account_statuses"
)
    SELECT
         id::INTEGER AS id,
         status::VARCHAR(50) AS status,
         description::TEXT AS description,
         src_created_at::TIMESTAMPTZ AS src_created_at,
         src_updated_at::TIMESTAMPTZ AS src_updated_at,
         created_at::TIMESTAMPTZ AS created_at,
         updated_at::TIMESTAMPTZ AS updated_at

    FROM source
  );
[0m18:13:39.839989 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m18:13:39.844991 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m18:13:39.845992 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.account_statuses"} */
alter table "merchant_data"."public"."account_statuses" rename to "account_statuses__dbt_backup"
[0m18:13:39.845992 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:13:39.847992 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m18:13:39.848991 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.account_statuses"} */
alter table "merchant_data"."public"."account_statuses__dbt_tmp" rename to "account_statuses"
[0m18:13:39.848991 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:13:39.860999 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: COMMIT
[0m18:13:39.862000 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m18:13:39.862000 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: COMMIT
[0m18:13:39.866999 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m18:13:39.872000 [debug] [Thread-1 (]: Applying DROP to: "merchant_data"."public"."account_statuses__dbt_backup"
[0m18:13:39.875513 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.account_statuses"
[0m18:13:39.875513 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.account_statuses"} */
drop table if exists "merchant_data"."public"."account_statuses__dbt_backup" cascade
[0m18:13:39.880520 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m18:13:39.882524 [debug] [Thread-1 (]: On model.merchant_data_project.account_statuses: Close
[0m18:13:39.884524 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6706406b-7262-422b-94a1-04972133d152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BA00D1610>]}
[0m18:13:39.884524 [info ] [Thread-1 (]: 1 of 19 OK created sql view model public.account_statuses ...................... [[32mCREATE VIEW[0m in 0.12s]
[0m18:13:39.885528 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.account_statuses
[0m18:13:39.886530 [debug] [Thread-1 (]: Began running node model.merchant_data_project.card_reader_types
[0m18:13:39.886530 [info ] [Thread-1 (]: 2 of 19 START sql view model public.card_reader_types .......................... [RUN]
[0m18:13:39.887528 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.merchant_data_project.account_statuses, now model.merchant_data_project.card_reader_types)
[0m18:13:39.887528 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.card_reader_types
[0m18:13:39.890532 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.card_reader_types"
[0m18:13:39.890532 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.card_reader_types
[0m18:13:39.894993 [debug] [Thread-1 (]: Writing runtime sql for node "model.merchant_data_project.card_reader_types"
[0m18:13:39.897004 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.card_reader_types"
[0m18:13:39.897004 [debug] [Thread-1 (]: On model.merchant_data_project.card_reader_types: BEGIN
[0m18:13:39.897995 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:39.933047 [debug] [Thread-1 (]: SQL status: BEGIN in 0.035 seconds
[0m18:13:39.933047 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.card_reader_types"
[0m18:13:39.934046 [debug] [Thread-1 (]: On model.merchant_data_project.card_reader_types: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.card_reader_types"} */

  create view "merchant_data"."public"."card_reader_types__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "merchant_data"."public"."card_reader_types"
)
    SELECT
        id::INTEGER AS id,
        name::VARCHAR(255) AS name,
        model::VARCHAR(255) AS model,
        pin_entry_capability::INTEGER AS pin_entry_capability,
        pin_block_format_code::INTEGER AS pin_block_format_code,
        encryption::BOOLEAN AS encryption,
        color::VARCHAR(50) AS color,
        description::TEXT AS description,
        is_emv_capable::BOOLEAN AS is_emv_capable,
        src_created_at::TIMESTAMPTZ AS src_created_at,
        src_updated_at::TIMESTAMPTZ AS src_updated_at,
        model_type::VARCHAR(50) AS model_type,
        created_at::TIMESTAMPTZ AS created_at,
        updated_at::TIMESTAMPTZ AS updated_at

    FROM source
  );
[0m18:13:39.940085 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m18:13:39.944199 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.card_reader_types"
[0m18:13:39.945195 [debug] [Thread-1 (]: On model.merchant_data_project.card_reader_types: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.card_reader_types"} */
alter table "merchant_data"."public"."card_reader_types" rename to "card_reader_types__dbt_backup"
[0m18:13:39.946082 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:13:39.948083 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.card_reader_types"
[0m18:13:39.948083 [debug] [Thread-1 (]: On model.merchant_data_project.card_reader_types: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.card_reader_types"} */
alter table "merchant_data"."public"."card_reader_types__dbt_tmp" rename to "card_reader_types"
[0m18:13:39.949083 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:13:39.950082 [debug] [Thread-1 (]: On model.merchant_data_project.card_reader_types: COMMIT
[0m18:13:39.950082 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.card_reader_types"
[0m18:13:39.950082 [debug] [Thread-1 (]: On model.merchant_data_project.card_reader_types: COMMIT
[0m18:13:39.952176 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:13:39.954172 [debug] [Thread-1 (]: Applying DROP to: "merchant_data"."public"."card_reader_types__dbt_backup"
[0m18:13:39.954172 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.card_reader_types"
[0m18:13:39.954172 [debug] [Thread-1 (]: On model.merchant_data_project.card_reader_types: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.card_reader_types"} */
drop table if exists "merchant_data"."public"."card_reader_types__dbt_backup" cascade
[0m18:13:39.959091 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m18:13:39.960170 [debug] [Thread-1 (]: On model.merchant_data_project.card_reader_types: Close
[0m18:13:39.961098 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6706406b-7262-422b-94a1-04972133d152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BA1FD2D20>]}
[0m18:13:39.961098 [info ] [Thread-1 (]: 2 of 19 OK created sql view model public.card_reader_types ..................... [[32mCREATE VIEW[0m in 0.07s]
[0m18:13:39.963091 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.card_reader_types
[0m18:13:39.963091 [debug] [Thread-1 (]: Began running node model.merchant_data_project.legal_types
[0m18:13:39.963091 [info ] [Thread-1 (]: 3 of 19 START sql view model public.legal_types ................................ [RUN]
[0m18:13:39.964090 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.merchant_data_project.card_reader_types, now model.merchant_data_project.legal_types)
[0m18:13:39.965091 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.legal_types
[0m18:13:39.967124 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.legal_types"
[0m18:13:39.968193 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.legal_types
[0m18:13:39.971088 [debug] [Thread-1 (]: Writing runtime sql for node "model.merchant_data_project.legal_types"
[0m18:13:39.972090 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.legal_types"
[0m18:13:39.972090 [debug] [Thread-1 (]: On model.merchant_data_project.legal_types: BEGIN
[0m18:13:39.973594 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:40.006824 [debug] [Thread-1 (]: SQL status: BEGIN in 0.033 seconds
[0m18:13:40.006824 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.legal_types"
[0m18:13:40.006824 [debug] [Thread-1 (]: On model.merchant_data_project.legal_types: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.legal_types"} */

  create view "merchant_data"."public"."legal_types__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "merchant_data"."public"."legal_types"
)
SELECT
    id::INTEGER AS id,
    description::VARCHAR(255) AS description,
    short_description::VARCHAR(255) AS short_description,
    country_id::INTEGER AS country_id,
    src_created_at::TIMESTAMPTZ AS src_created_at,
    src_updated_at::TIMESTAMPTZ AS src_updated_at,
    active::BOOLEAN AS active,
    signup_screen::INTEGER AS signup_screen,
    translation_key::VARCHAR(255) AS translation_key,
    parent_id::INTEGER AS parent_id,
    sort_order::INTEGER AS sort_order,
    created_at::TIMESTAMPTZ AS created_at,
    updated_at::TIMESTAMPTZ AS updated_at

FROM source
  );
[0m18:13:40.013821 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m18:13:40.015911 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.legal_types"
[0m18:13:40.016937 [debug] [Thread-1 (]: On model.merchant_data_project.legal_types: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.legal_types"} */
alter table "merchant_data"."public"."legal_types" rename to "legal_types__dbt_backup"
[0m18:13:40.016937 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:13:40.018918 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.legal_types"
[0m18:13:40.018918 [debug] [Thread-1 (]: On model.merchant_data_project.legal_types: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.legal_types"} */
alter table "merchant_data"."public"."legal_types__dbt_tmp" rename to "legal_types"
[0m18:13:40.019903 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:13:40.020903 [debug] [Thread-1 (]: On model.merchant_data_project.legal_types: COMMIT
[0m18:13:40.021823 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.legal_types"
[0m18:13:40.021823 [debug] [Thread-1 (]: On model.merchant_data_project.legal_types: COMMIT
[0m18:13:40.022821 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:13:40.025829 [debug] [Thread-1 (]: Applying DROP to: "merchant_data"."public"."legal_types__dbt_backup"
[0m18:13:40.026821 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.legal_types"
[0m18:13:40.026821 [debug] [Thread-1 (]: On model.merchant_data_project.legal_types: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.legal_types"} */
drop table if exists "merchant_data"."public"."legal_types__dbt_backup" cascade
[0m18:13:40.032821 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m18:13:40.034830 [debug] [Thread-1 (]: On model.merchant_data_project.legal_types: Close
[0m18:13:40.034830 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6706406b-7262-422b-94a1-04972133d152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BA18C81A0>]}
[0m18:13:40.035823 [info ] [Thread-1 (]: 3 of 19 OK created sql view model public.legal_types ........................... [[32mCREATE VIEW[0m in 0.07s]
[0m18:13:40.036821 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.legal_types
[0m18:13:40.037826 [debug] [Thread-1 (]: Began running node model.merchant_data_project.merchant_categories
[0m18:13:40.037826 [info ] [Thread-1 (]: 4 of 19 START sql view model public.merchant_categories ........................ [RUN]
[0m18:13:40.038822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.merchant_data_project.legal_types, now model.merchant_data_project.merchant_categories)
[0m18:13:40.039822 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.merchant_categories
[0m18:13:40.041907 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.merchant_categories"
[0m18:13:40.043820 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.merchant_categories
[0m18:13:40.046822 [debug] [Thread-1 (]: Writing runtime sql for node "model.merchant_data_project.merchant_categories"
[0m18:13:40.048822 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.merchant_categories"
[0m18:13:40.048822 [debug] [Thread-1 (]: On model.merchant_data_project.merchant_categories: BEGIN
[0m18:13:40.048822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:40.084912 [debug] [Thread-1 (]: SQL status: BEGIN in 0.035 seconds
[0m18:13:40.084912 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.merchant_categories"
[0m18:13:40.084912 [debug] [Thread-1 (]: On model.merchant_data_project.merchant_categories: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.merchant_categories"} */

  create view "merchant_data"."public"."merchant_categories__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "merchant_data"."public"."merchant_categories"
)
SELECT
    id::INTEGER AS id,
    code::INTEGER AS code,
    description::VARCHAR(255) AS description,
    src_created_at::TIMESTAMPTZ AS src_created_at,
    src_updated_at::TIMESTAMPTZ AS src_updated_at,
    section_id::INTEGER AS section_id,
    vat_inclusive::BOOLEAN AS vat_inclusive,
    enabled::BOOLEAN AS enabled,
    created_at::TIMESTAMPTZ AS created_at,
    updated_at::TIMESTAMPTZ AS updated_at
   
FROM source
  );
[0m18:13:40.091918 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m18:13:40.093934 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.merchant_categories"
[0m18:13:40.094933 [debug] [Thread-1 (]: On model.merchant_data_project.merchant_categories: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.merchant_categories"} */
alter table "merchant_data"."public"."merchant_categories" rename to "merchant_categories__dbt_backup"
[0m18:13:40.094933 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:13:40.096932 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.merchant_categories"
[0m18:13:40.097911 [debug] [Thread-1 (]: On model.merchant_data_project.merchant_categories: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.merchant_categories"} */
alter table "merchant_data"."public"."merchant_categories__dbt_tmp" rename to "merchant_categories"
[0m18:13:40.097911 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:13:40.098934 [debug] [Thread-1 (]: On model.merchant_data_project.merchant_categories: COMMIT
[0m18:13:40.099912 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.merchant_categories"
[0m18:13:40.099912 [debug] [Thread-1 (]: On model.merchant_data_project.merchant_categories: COMMIT
[0m18:13:40.101912 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:13:40.103911 [debug] [Thread-1 (]: Applying DROP to: "merchant_data"."public"."merchant_categories__dbt_backup"
[0m18:13:40.104910 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.merchant_categories"
[0m18:13:40.104910 [debug] [Thread-1 (]: On model.merchant_data_project.merchant_categories: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.merchant_categories"} */
drop table if exists "merchant_data"."public"."merchant_categories__dbt_backup" cascade
[0m18:13:40.109913 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m18:13:40.110931 [debug] [Thread-1 (]: On model.merchant_data_project.merchant_categories: Close
[0m18:13:40.110931 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6706406b-7262-422b-94a1-04972133d152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BA2043740>]}
[0m18:13:40.111924 [info ] [Thread-1 (]: 4 of 19 OK created sql view model public.merchant_categories ................... [[32mCREATE VIEW[0m in 0.07s]
[0m18:13:40.112928 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.merchant_categories
[0m18:13:40.112928 [debug] [Thread-1 (]: Began running node model.merchant_data_project.merchants
[0m18:13:40.113915 [info ] [Thread-1 (]: 5 of 19 START sql view model public.merchants .................................. [RUN]
[0m18:13:40.113915 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.merchant_data_project.merchant_categories, now model.merchant_data_project.merchants)
[0m18:13:40.114912 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.merchants
[0m18:13:40.116932 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.merchants"
[0m18:13:40.117912 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.merchants
[0m18:13:40.120913 [debug] [Thread-1 (]: Writing runtime sql for node "model.merchant_data_project.merchants"
[0m18:13:40.121914 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.merchants"
[0m18:13:40.121914 [debug] [Thread-1 (]: On model.merchant_data_project.merchants: BEGIN
[0m18:13:40.122914 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:40.156911 [debug] [Thread-1 (]: SQL status: BEGIN in 0.034 seconds
[0m18:13:40.156911 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.merchants"
[0m18:13:40.156911 [debug] [Thread-1 (]: On model.merchant_data_project.merchants: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.merchants"} */

  create view "merchant_data"."public"."merchants__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "merchant_data"."public"."merchants"
)
SELECT
    merchant_id::BIGINT AS merchant_id,
    src_created_at::TIMESTAMPTZ AS src_created_at,
    src_updated_at::TIMESTAMPTZ AS src_updated_at,
    primary_user_id::BIGINT AS primary_user_id,
    country_id::INTEGER AS country_id,
    merchant_category_id::INTEGER AS merchant_category_id,
    sign_up_time::TIMESTAMPTZ AS sign_up_time,
    is_test_account::BOOLEAN AS is_test_account,
    address_detail_id::BIGINT AS address_detail_id,
    business_detail_id::BIGINT AS business_detail_id,
    payout_zone_id::INTEGER AS payout_zone_id,
    payout_detail_id::INTEGER AS payout_detail_id,
    created_at::TIMESTAMPTZ AS created_at,
    updated_at::TIMESTAMPTZ AS updated_at
   
FROM source
  );
[0m18:13:40.164919 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m18:13:40.167918 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.merchants"
[0m18:13:40.167918 [debug] [Thread-1 (]: On model.merchant_data_project.merchants: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.merchants"} */
alter table "merchant_data"."public"."merchants" rename to "merchants__dbt_backup"
[0m18:13:40.168963 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:13:40.171012 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.merchants"
[0m18:13:40.171012 [debug] [Thread-1 (]: On model.merchant_data_project.merchants: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.merchants"} */
alter table "merchant_data"."public"."merchants__dbt_tmp" rename to "merchants"
[0m18:13:40.171920 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:13:40.172920 [debug] [Thread-1 (]: On model.merchant_data_project.merchants: COMMIT
[0m18:13:40.172920 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.merchants"
[0m18:13:40.172920 [debug] [Thread-1 (]: On model.merchant_data_project.merchants: COMMIT
[0m18:13:40.175332 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:13:40.177413 [debug] [Thread-1 (]: Applying DROP to: "merchant_data"."public"."merchants__dbt_backup"
[0m18:13:40.178418 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.merchants"
[0m18:13:40.178418 [debug] [Thread-1 (]: On model.merchant_data_project.merchants: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.merchants"} */
drop table if exists "merchant_data"."public"."merchants__dbt_backup" cascade
[0m18:13:40.182429 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m18:13:40.183516 [debug] [Thread-1 (]: On model.merchant_data_project.merchants: Close
[0m18:13:40.184511 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6706406b-7262-422b-94a1-04972133d152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BA1EA6B10>]}
[0m18:13:40.184511 [info ] [Thread-1 (]: 5 of 19 OK created sql view model public.merchants ............................. [[32mCREATE VIEW[0m in 0.07s]
[0m18:13:40.185428 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.merchants
[0m18:13:40.186429 [debug] [Thread-1 (]: Began running node model.merchant_data_project.payment_types
[0m18:13:40.186429 [info ] [Thread-1 (]: 6 of 19 START sql view model public.payment_types .............................. [RUN]
[0m18:13:40.187434 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.merchant_data_project.merchants, now model.merchant_data_project.payment_types)
[0m18:13:40.188430 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.payment_types
[0m18:13:40.191515 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.payment_types"
[0m18:13:40.192492 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.payment_types
[0m18:13:40.196518 [debug] [Thread-1 (]: Writing runtime sql for node "model.merchant_data_project.payment_types"
[0m18:13:40.197431 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.payment_types"
[0m18:13:40.198429 [debug] [Thread-1 (]: On model.merchant_data_project.payment_types: BEGIN
[0m18:13:40.198429 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:40.234885 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m18:13:40.235884 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.payment_types"
[0m18:13:40.235884 [debug] [Thread-1 (]: On model.merchant_data_project.payment_types: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.payment_types"} */

  create view "merchant_data"."public"."payment_types__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "merchant_data"."public"."payment_types"
)
SELECT
    id::INTEGER AS id,
    code::INTEGER AS code,
    description::VARCHAR(255) AS description,
    is_active::BOOLEAN AS is_active,
    src_created_at::TIMESTAMPTZ AS src_created_at,
    src_updated_at::TIMESTAMPTZ AS src_updated_at,
    created_at::TIMESTAMPTZ AS created_at,
    updated_at::TIMESTAMPTZ AS updated_at
   
FROM source
  );
[0m18:13:40.240905 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m18:13:40.243885 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.payment_types"
[0m18:13:40.243885 [debug] [Thread-1 (]: On model.merchant_data_project.payment_types: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.payment_types"} */
alter table "merchant_data"."public"."payment_types" rename to "payment_types__dbt_backup"
[0m18:13:40.244883 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:13:40.247947 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.payment_types"
[0m18:13:40.247947 [debug] [Thread-1 (]: On model.merchant_data_project.payment_types: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.payment_types"} */
alter table "merchant_data"."public"."payment_types__dbt_tmp" rename to "payment_types"
[0m18:13:40.248883 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:13:40.249888 [debug] [Thread-1 (]: On model.merchant_data_project.payment_types: COMMIT
[0m18:13:40.249888 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.payment_types"
[0m18:13:40.249888 [debug] [Thread-1 (]: On model.merchant_data_project.payment_types: COMMIT
[0m18:13:40.251884 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:13:40.253976 [debug] [Thread-1 (]: Applying DROP to: "merchant_data"."public"."payment_types__dbt_backup"
[0m18:13:40.253976 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.payment_types"
[0m18:13:40.254983 [debug] [Thread-1 (]: On model.merchant_data_project.payment_types: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.payment_types"} */
drop table if exists "merchant_data"."public"."payment_types__dbt_backup" cascade
[0m18:13:40.258886 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m18:13:40.259971 [debug] [Thread-1 (]: On model.merchant_data_project.payment_types: Close
[0m18:13:40.259971 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6706406b-7262-422b-94a1-04972133d152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BA1FBDAC0>]}
[0m18:13:40.260896 [info ] [Thread-1 (]: 6 of 19 OK created sql view model public.payment_types ......................... [[32mCREATE VIEW[0m in 0.07s]
[0m18:13:40.261895 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.payment_types
[0m18:13:40.261895 [debug] [Thread-1 (]: Began running node model.merchant_data_project.transaction_states
[0m18:13:40.262892 [info ] [Thread-1 (]: 7 of 19 START sql view model public.transaction_states ......................... [RUN]
[0m18:13:40.263895 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.merchant_data_project.payment_types, now model.merchant_data_project.transaction_states)
[0m18:13:40.263895 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.transaction_states
[0m18:13:40.265980 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.transaction_states"
[0m18:13:40.266980 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.transaction_states
[0m18:13:40.270970 [debug] [Thread-1 (]: Writing runtime sql for node "model.merchant_data_project.transaction_states"
[0m18:13:40.271942 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.transaction_states"
[0m18:13:40.272906 [debug] [Thread-1 (]: On model.merchant_data_project.transaction_states: BEGIN
[0m18:13:40.272906 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:40.409375 [debug] [Thread-1 (]: SQL status: BEGIN in 0.136 seconds
[0m18:13:40.410456 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.transaction_states"
[0m18:13:40.410456 [debug] [Thread-1 (]: On model.merchant_data_project.transaction_states: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.transaction_states"} */

  create view "merchant_data"."public"."transaction_states__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "merchant_data"."public"."transaction_states"
)
SELECT
    id::BIGINT AS id,
    transaction_id::BIGINT AS transaction_id,
    insert_time::TIMESTAMPTZ AS insert_time,
    settlement_run_id::BIGINT AS settlement_run_id,
    src_created_at::TIMESTAMPTZ AS src_created_at,
    src_updated_at::TIMESTAMPTZ AS src_updated_at,
    comment::TEXT AS comment,
    payout_event_id::BIGINT AS payout_event_id,
    transaction_status::INTEGER AS transaction_status,
    transaction_status_id::INTEGER AS transaction_status_id,
    created_at::TIMESTAMPTZ AS created_at,
    updated_at::TIMESTAMPTZ AS updated_at
   
FROM source
  );
[0m18:13:40.416413 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m18:13:40.419487 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.transaction_states"
[0m18:13:40.419487 [debug] [Thread-1 (]: On model.merchant_data_project.transaction_states: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.transaction_states"} */
alter table "merchant_data"."public"."transaction_states" rename to "transaction_states__dbt_backup"
[0m18:13:40.420376 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:13:40.422467 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.transaction_states"
[0m18:13:40.422467 [debug] [Thread-1 (]: On model.merchant_data_project.transaction_states: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.transaction_states"} */
alter table "merchant_data"."public"."transaction_states__dbt_tmp" rename to "transaction_states"
[0m18:13:40.423389 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:13:40.424380 [debug] [Thread-1 (]: On model.merchant_data_project.transaction_states: COMMIT
[0m18:13:40.424380 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.transaction_states"
[0m18:13:40.424380 [debug] [Thread-1 (]: On model.merchant_data_project.transaction_states: COMMIT
[0m18:13:40.426452 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:13:40.428412 [debug] [Thread-1 (]: Applying DROP to: "merchant_data"."public"."transaction_states__dbt_backup"
[0m18:13:40.428412 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.transaction_states"
[0m18:13:40.429469 [debug] [Thread-1 (]: On model.merchant_data_project.transaction_states: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.transaction_states"} */
drop table if exists "merchant_data"."public"."transaction_states__dbt_backup" cascade
[0m18:13:40.434375 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m18:13:40.435482 [debug] [Thread-1 (]: On model.merchant_data_project.transaction_states: Close
[0m18:13:40.435482 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6706406b-7262-422b-94a1-04972133d152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BA1F425D0>]}
[0m18:13:40.436381 [info ] [Thread-1 (]: 7 of 19 OK created sql view model public.transaction_states .................... [[32mCREATE VIEW[0m in 0.17s]
[0m18:13:40.437376 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.transaction_states
[0m18:13:40.437376 [debug] [Thread-1 (]: Began running node model.merchant_data_project.transaction_statuses
[0m18:13:40.438375 [info ] [Thread-1 (]: 8 of 19 START sql view model public.transaction_statuses ....................... [RUN]
[0m18:13:40.438375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.merchant_data_project.transaction_states, now model.merchant_data_project.transaction_statuses)
[0m18:13:40.439379 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.transaction_statuses
[0m18:13:40.441379 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.transaction_statuses"
[0m18:13:40.442382 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.transaction_statuses
[0m18:13:40.446387 [debug] [Thread-1 (]: Writing runtime sql for node "model.merchant_data_project.transaction_statuses"
[0m18:13:40.447380 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.transaction_statuses"
[0m18:13:40.448382 [debug] [Thread-1 (]: On model.merchant_data_project.transaction_statuses: BEGIN
[0m18:13:40.448382 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:40.485937 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m18:13:40.485937 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.transaction_statuses"
[0m18:13:40.485937 [debug] [Thread-1 (]: On model.merchant_data_project.transaction_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.transaction_statuses"} */

  create view "merchant_data"."public"."transaction_statuses__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "merchant_data"."public"."transaction_statuses"
)
SELECT
    id::INTEGER AS id,
    name::VARCHAR(255) AS name,
    created_at::TIMESTAMPTZ AS created_at,
    updated_at::TIMESTAMPTZ AS updated_at
    
FROM source
  );
[0m18:13:40.491896 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m18:13:40.494893 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.transaction_statuses"
[0m18:13:40.494893 [debug] [Thread-1 (]: On model.merchant_data_project.transaction_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.transaction_statuses"} */
alter table "merchant_data"."public"."transaction_statuses" rename to "transaction_statuses__dbt_backup"
[0m18:13:40.495933 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:13:40.497893 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.transaction_statuses"
[0m18:13:40.497893 [debug] [Thread-1 (]: On model.merchant_data_project.transaction_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.transaction_statuses"} */
alter table "merchant_data"."public"."transaction_statuses__dbt_tmp" rename to "transaction_statuses"
[0m18:13:40.498893 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:13:40.499893 [debug] [Thread-1 (]: On model.merchant_data_project.transaction_statuses: COMMIT
[0m18:13:40.499893 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.transaction_statuses"
[0m18:13:40.500894 [debug] [Thread-1 (]: On model.merchant_data_project.transaction_statuses: COMMIT
[0m18:13:40.501954 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:13:40.503985 [debug] [Thread-1 (]: Applying DROP to: "merchant_data"."public"."transaction_statuses__dbt_backup"
[0m18:13:40.503985 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.transaction_statuses"
[0m18:13:40.504988 [debug] [Thread-1 (]: On model.merchant_data_project.transaction_statuses: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.transaction_statuses"} */
drop table if exists "merchant_data"."public"."transaction_statuses__dbt_backup" cascade
[0m18:13:40.507893 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m18:13:40.509974 [debug] [Thread-1 (]: On model.merchant_data_project.transaction_statuses: Close
[0m18:13:40.510976 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6706406b-7262-422b-94a1-04972133d152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BA1FD23F0>]}
[0m18:13:40.511893 [info ] [Thread-1 (]: 8 of 19 OK created sql view model public.transaction_statuses .................. [[32mCREATE VIEW[0m in 0.07s]
[0m18:13:40.512895 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.transaction_statuses
[0m18:13:40.512895 [debug] [Thread-1 (]: Began running node model.merchant_data_project.transactions
[0m18:13:40.513898 [info ] [Thread-1 (]: 9 of 19 START sql view model public.transactions ............................... [RUN]
[0m18:13:40.513898 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.merchant_data_project.transaction_statuses, now model.merchant_data_project.transactions)
[0m18:13:40.514895 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.transactions
[0m18:13:40.517009 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.transactions"
[0m18:13:40.517961 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.transactions
[0m18:13:40.520998 [debug] [Thread-1 (]: Writing runtime sql for node "model.merchant_data_project.transactions"
[0m18:13:40.521901 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.transactions"
[0m18:13:40.521901 [debug] [Thread-1 (]: On model.merchant_data_project.transactions: BEGIN
[0m18:13:40.522893 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:40.560238 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m18:13:40.561242 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.transactions"
[0m18:13:40.561242 [debug] [Thread-1 (]: On model.merchant_data_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.transactions"} */

  create view "merchant_data"."public"."transactions__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "merchant_data"."public"."transactions"
)
SELECT
    transaction_id::BIGINT AS transaction_id,
    merchant_id::BIGINT AS merchant_id,
    user_id::BIGINT AS user_id,
    server_time_created_at::TIMESTAMPTZ AS server_time_created_at,
    src_created_at::TIMESTAMPTZ AS src_created_at,
    src_updated_at::TIMESTAMPTZ AS src_updated_at,
    created_at::TIMESTAMPTZ AS created_at,
    updated_at::TIMESTAMPTZ AS updated_at,
    amount::DECIMAL(10, 2) AS amount,
    vat_amount::DECIMAL(10, 2) AS vat_amount,
    tip_amount::DECIMAL(10, 2) AS tip_amount,
    payment_type_code::INTEGER AS payment_type_code,
    currency::CHAR(3) AS currency,
    entry_mode_id::INTEGER AS entry_mode_id,
    tx_result::INTEGER AS tx_result,
    acquirer_code::INTEGER AS acquirer_code,
    current_status_id::INTEGER AS current_status_id,
    device_id::BIGINT AS device_id,
    cardholder_verification_method_id::INTEGER AS cardholder_verification_method_id,
    card_id::BIGINT AS card_id,
    card_reader_id::BIGINT AS card_reader_id,
    tax_enabled::BOOLEAN AS tax_enabled
   
FROM source
  );
[0m18:13:40.570240 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m18:13:40.575752 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.transactions"
[0m18:13:40.575752 [debug] [Thread-1 (]: On model.merchant_data_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.transactions"} */
alter table "merchant_data"."public"."transactions" rename to "transactions__dbt_backup"
[0m18:13:40.577752 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:13:40.580749 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.transactions"
[0m18:13:40.580749 [debug] [Thread-1 (]: On model.merchant_data_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.transactions"} */
alter table "merchant_data"."public"."transactions__dbt_tmp" rename to "transactions"
[0m18:13:40.581752 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:13:40.583749 [debug] [Thread-1 (]: On model.merchant_data_project.transactions: COMMIT
[0m18:13:40.583749 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.transactions"
[0m18:13:40.583749 [debug] [Thread-1 (]: On model.merchant_data_project.transactions: COMMIT
[0m18:13:40.585756 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:13:40.589768 [debug] [Thread-1 (]: Applying DROP to: "merchant_data"."public"."transactions__dbt_backup"
[0m18:13:40.590752 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.transactions"
[0m18:13:40.591750 [debug] [Thread-1 (]: On model.merchant_data_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.transactions"} */
drop table if exists "merchant_data"."public"."transactions__dbt_backup" cascade
[0m18:13:40.597757 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m18:13:40.599751 [debug] [Thread-1 (]: On model.merchant_data_project.transactions: Close
[0m18:13:40.600750 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6706406b-7262-422b-94a1-04972133d152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BA2035310>]}
[0m18:13:40.600750 [info ] [Thread-1 (]: 9 of 19 OK created sql view model public.transactions .......................... [[32mCREATE VIEW[0m in 0.09s]
[0m18:13:40.601750 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.transactions
[0m18:13:40.602837 [debug] [Thread-1 (]: Began running node model.merchant_data_project.questionA
[0m18:13:40.603755 [info ] [Thread-1 (]: 10 of 19 START sql view model public.questionA ................................. [RUN]
[0m18:13:40.604750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.merchant_data_project.transactions, now model.merchant_data_project.questionA)
[0m18:13:40.604750 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.questionA
[0m18:13:40.608749 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.questionA"
[0m18:13:40.609845 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.questionA
[0m18:13:40.614263 [debug] [Thread-1 (]: Writing runtime sql for node "model.merchant_data_project.questionA"
[0m18:13:40.616173 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.questionA"
[0m18:13:40.617183 [debug] [Thread-1 (]: On model.merchant_data_project.questionA: BEGIN
[0m18:13:40.617183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:40.661738 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m18:13:40.661738 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.questionA"
[0m18:13:40.661738 [debug] [Thread-1 (]: On model.merchant_data_project.questionA: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.questionA"} */

  create view "merchant_data"."public"."questionA__dbt_tmp"
    
    
  as (
    SELECT
    m.merchant_id AS merchant_id,
    m.sign_up_time
FROM "merchant_data"."public"."merchants" m
  );
[0m18:13:40.662731 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.merchants" does not exist
LINE 10: FROM "merchant_data"."public"."merchants" m
              ^

[0m18:13:40.662731 [debug] [Thread-1 (]: On model.merchant_data_project.questionA: ROLLBACK
[0m18:13:40.663729 [debug] [Thread-1 (]: On model.merchant_data_project.questionA: Close
[0m18:13:40.668726 [debug] [Thread-1 (]: Database Error in model questionA (models\curated\questionA.sql)
  relation "public.merchants" does not exist
  LINE 10: FROM "merchant_data"."public"."merchants" m
                ^
  compiled code at target\run\merchant_data_project\models\curated\questionA.sql
[0m18:13:40.669879 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6706406b-7262-422b-94a1-04972133d152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BA1FC7C80>]}
[0m18:13:40.670884 [error] [Thread-1 (]: 10 of 19 ERROR creating sql view model public.questionA ........................ [[31mERROR[0m in 0.07s]
[0m18:13:40.671984 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.questionA
[0m18:13:40.671984 [debug] [Thread-1 (]: Began running node model.merchant_data_project.curated_merchant_data
[0m18:13:40.672995 [info ] [Thread-1 (]: 11 of 19 START sql view model public.curated_merchant_data ..................... [RUN]
[0m18:13:40.674501 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.merchant_data_project.questionA, now model.merchant_data_project.curated_merchant_data)
[0m18:13:40.675509 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.curated_merchant_data
[0m18:13:40.682508 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.curated_merchant_data"
[0m18:13:40.684508 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.curated_merchant_data
[0m18:13:40.688508 [debug] [Thread-1 (]: Writing runtime sql for node "model.merchant_data_project.curated_merchant_data"
[0m18:13:40.690518 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.curated_merchant_data"
[0m18:13:40.691514 [debug] [Thread-1 (]: On model.merchant_data_project.curated_merchant_data: BEGIN
[0m18:13:40.691514 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:40.733434 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m18:13:40.734440 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.curated_merchant_data"
[0m18:13:40.734440 [debug] [Thread-1 (]: On model.merchant_data_project.curated_merchant_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.curated_merchant_data"} */

  create view "merchant_data"."public"."curated_merchant_data__dbt_tmp"
    
    
  as (
    WITH merchant_signup AS (
    -- Define the 7, 30, 90, 180, 365 day periods after signup for each merchant
    SELECT
        merchant_id,
        sign_up_time,
        sign_up_time + INTERVAL '7 days' AS signup_plus_7_days,
        sign_up_time + INTERVAL '30 days' AS signup_plus_30_days,
        sign_up_time + INTERVAL '90 days' AS signup_plus_90_days,
        sign_up_time + INTERVAL '180 days' AS signup_plus_180_days,
        sign_up_time + INTERVAL '365 days' AS signup_plus_365_days
    FROM "merchant_data"."public"."merchants"
),

-- Checking the output of merchant signup information
-- select * from merchant_signup
successful_transactions AS (
    -- Get successful transactions per merchant
    SELECT
        t.merchant_id,
        t.server_time_created_at,
        row_number() OVER (PARTITION BY t.merchant_id ORDER BY t.server_time_created_at) AS transaction_rank
    FROM "merchant_data"."public"."transactions" t
    WHERE t.tx_result = 11  -- Only successful transactions
),

first_successful_transaction AS (
    -- Get first successful transaction date for each merchant
    SELECT
        st.merchant_id,
        min(st.server_time_created_at) AS first_successful_transaction_date
    FROM successful_transactions st
    WHERE st.transaction_rank = 1
    GROUP BY st.merchant_id
),

-- Checking the output of the first successful transaction
-- select * from first_successful_transaction

successful_card_present_transactions AS (
    SELECT
        t.merchant_id,
        t.server_time_created_at,
        row_number() OVER (PARTITION BY t.merchant_id ORDER BY t.server_time_created_at) AS transaction_rank
    FROM "merchant_data"."public"."transactions" t
    JOIN "merchant_data"."public"."payment_types" pt
        ON t.payment_type_code = pt.code  -- Joining ON the payment type code
    WHERE t.tx_result = 11  -- Successful transaction (tx_result = 11)
      AND NOT pt.code IN (8,9,12,14)  -- Card-not-present transaction codes
),

first_card_present_transaction AS (
    -- Get first card-present transaction date for each merchant
    SELECT
        st.merchant_id,
        min(st.server_time_created_at) AS first_card_present_transaction_date
    FROM successful_card_present_transactions st
    WHERE st.transaction_rank = 1  -- Get the first card-present transaction
    GROUP BY st.merchant_id
),

-- Checking the output of the first card-present transaction
-- select * from first_card_present_transaction

fifth_successful_transaction AS (
    -- Get fifth successful transaction date for each merchant
    SELECT
        st.merchant_id,
        min(st.server_time_created_at) AS fifth_successful_transaction_date
    FROM successful_transactions st
    WHERE st.transaction_rank = 5
    GROUP BY st.merchant_id
),

-- Checking the output of the fifth successful transaction
-- select * from fifth_successful_transaction


last_successful_transaction AS (
    -- Get last successful transaction date for each merchant
    SELECT
        st.merchant_id,
        max(st.server_time_created_at) AS last_successful_transaction_date
    FROM successful_transactions st
    WHERE st.transaction_rank = 1
    GROUP BY st.merchant_id
),

-- Checking the output of the fifth successful transaction
-- select * from last_successful_transaction

all_time_successful_transactions AS (
    -- Get all time successful transaction for each merchant
   SELECT
        t.merchant_id,
        count(*) AS all_time_successful_transactions
    FROM "merchant_data"."public"."transactions" t
    WHERE t.tx_result = 11  -- Successful transaction (tx_result = 11)
    GROUP BY t.merchant_id
),

-- Checking the output of the all time successful transactions
-- select * from all_time_successful_transactions

all_time_failed_transactions AS (
    -- Get all time failed transaction for each merchant
   SELECT
        t.merchant_id,
        count(*) AS all_time_failed_transactions
    FROM "merchant_data"."public"."transactions" t
    WHERE t.tx_result != 11  -- failed transaction (tx_result != 11)
    GROUP BY t.merchant_id
),

-- Checking the output of the all time failed transactions
-- select * from all_time_failed_transactions

transactions_in_period AS (
    -- Join transactions WITH calculated periods, filtering by successful transactions within 365 days of signup
    SELECT
        m.merchant_id,
        t.amount,
        t.vat_amount,
        t.tip_amount,
        t.currency,
        CASE
            WHEN t.server_time_created_at >= m.sign_up_time 
                 AND t.server_time_created_at < m.signup_plus_7_days THEN '7_day'
            WHEN t.server_time_created_at >= m.sign_up_time
                 AND t.server_time_created_at < m.signup_plus_30_days THEN '30_day'
            WHEN t.server_time_created_at >= m.sign_up_time
                 AND t.server_time_created_at < m.signup_plus_90_days THEN '90_day'
            WHEN t.server_time_created_at >= m.sign_up_time
                 AND t.server_time_created_at < m.signup_plus_180_days THEN '180_day'
            WHEN t.server_time_created_at >= m.sign_up_time
                 AND t.server_time_created_at < m.signup_plus_365_days THEN '365_day'
        END AS PERIOD
    FROM merchant_signup m
    JOIN "merchant_data"."public"."transactions" t
        ON m.merchant_id = t.merchant_id
    WHERE t.tx_result = 11  -- Only successful transactions
      AND t.server_time_created_at < m.signup_plus_365_days
),

tpv_summary AS (
    SELECT
        merchant_id,
        sum(CASE WHEN PERIOD = '7_day' THEN amount + vat_amount + tip_amount ELSE 0 END) AS tpv_7_day,
        sum(CASE WHEN PERIOD IN ('7_day', '30_day') THEN amount + vat_amount + tip_amount ELSE 0 END) AS tpv_30_day,
        sum(CASE WHEN PERIOD IN ('7_day', '30_day', '90_day') THEN amount + vat_amount + tip_amount ELSE 0 END) AS tpv_90_day,
        sum(CASE WHEN PERIOD IN ('7_day', '30_day','90_day','180_day') THEN amount + vat_amount + tip_amount ELSE 0 END) AS tpv_180_day,
        sum(CASE WHEN PERIOD IN ('7_day', '30_day','90_day','180_day','365_day') THEN amount + vat_amount + tip_amount ELSE 0 END) AS tpv_365_day
    FROM transactions_in_period
    WHERE PERIOD IS NOT NULL
    GROUP BY merchant_id
)

-- Final selection combining all computed metrics

SELECT
    ms.merchant_id,
    ms.sign_up_time,
    fst.first_successful_transaction_date,
    fcpt.first_card_present_transaction_date,
    fifth.fifth_successful_transaction_date,
    lst.last_successful_transaction_date,
    atst.all_time_successful_transactions,
    atft.all_time_failed_transactions,
    tpv.tpv_7_day,
    tpv.tpv_30_day,
    tpv.tpv_90_day,
    tpv.tpv_180_day,
    tpv.tpv_365_day

FROM merchant_signup ms
LEFT JOIN first_successful_transaction fst ON ms.merchant_id = fst.merchant_id
LEFT JOIN first_card_present_transaction fcpt ON ms.merchant_id = fcpt.merchant_id
LEFT JOIN fifth_successful_transaction fifth ON ms.merchant_id = fifth.merchant_id
LEFT JOIN last_successful_transaction lst ON ms.merchant_id = lst.merchant_id
LEFT JOIN all_time_successful_transactions atst ON ms.merchant_id = atst.merchant_id
LEFT JOIN all_time_failed_transactions atft ON ms.merchant_id = atft.merchant_id
LEFT JOIN tpv_summary tpv ON ms.merchant_id = tpv.merchant_id

ORDER BY sign_up_time;
  );
[0m18:13:40.735438 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 189: ORDER BY sign_up_time;
                               ^

[0m18:13:40.735438 [debug] [Thread-1 (]: On model.merchant_data_project.curated_merchant_data: ROLLBACK
[0m18:13:40.736438 [debug] [Thread-1 (]: On model.merchant_data_project.curated_merchant_data: Close
[0m18:13:40.738434 [debug] [Thread-1 (]: Database Error in model curated_merchant_data (models\curated\curated_merchant_data.sql)
  syntax error at or near ";"
  LINE 189: ORDER BY sign_up_time;
                                 ^
  compiled code at target\run\merchant_data_project\models\curated\curated_merchant_data.sql
[0m18:13:40.739434 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6706406b-7262-422b-94a1-04972133d152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BA1FD2F00>]}
[0m18:13:40.739434 [error] [Thread-1 (]: 11 of 19 ERROR creating sql view model public.curated_merchant_data ............ [[31mERROR[0m in 0.06s]
[0m18:13:40.740434 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.curated_merchant_data
[0m18:13:40.741434 [debug] [Thread-1 (]: Began running node model.merchant_data_project.questionB
[0m18:13:40.741434 [info ] [Thread-1 (]: 12 of 19 START sql view model public.questionB ................................. [RUN]
[0m18:13:40.742435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.merchant_data_project.curated_merchant_data, now model.merchant_data_project.questionB)
[0m18:13:40.742435 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.questionB
[0m18:13:40.745455 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.questionB"
[0m18:13:40.746435 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.questionB
[0m18:13:40.749434 [debug] [Thread-1 (]: Writing runtime sql for node "model.merchant_data_project.questionB"
[0m18:13:40.751434 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.questionB"
[0m18:13:40.751434 [debug] [Thread-1 (]: On model.merchant_data_project.questionB: BEGIN
[0m18:13:40.751434 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:40.927725 [debug] [Thread-1 (]: SQL status: BEGIN in 0.176 seconds
[0m18:13:40.927725 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.questionB"
[0m18:13:40.927725 [debug] [Thread-1 (]: On model.merchant_data_project.questionB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.questionB"} */

  create view "merchant_data"."public"."questionB__dbt_tmp"
    
    
  as (
    WITH successful_transactions AS (
    SELECT
        t.merchant_id,
        t.server_time_created_at,
        row_number() OVER (PARTITION BY t.merchant_id ORDER BY t.server_time_created_at) AS transaction_rank
    FROM "merchant_data"."public"."transactions" t
    WHERE t.tx_result = 11  -- Successful transaction (tx_result = 11)
)
SELECT
    st.merchant_id,
    min(st.server_time_created_at) AS first_successful_transaction_date
FROM successful_transactions st
WHERE st.transaction_rank = 1  -- Get the first successful transaction for each merchant
GROUP BY st.merchant_id
  );
[0m18:13:40.928802 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.transactions" does not exist
LINE 12:     FROM "merchant_data"."public"."transactions" t
                  ^

[0m18:13:40.929805 [debug] [Thread-1 (]: On model.merchant_data_project.questionB: ROLLBACK
[0m18:13:40.929805 [debug] [Thread-1 (]: On model.merchant_data_project.questionB: Close
[0m18:13:40.932724 [debug] [Thread-1 (]: Database Error in model questionB (models\curated\questionB.sql)
  relation "public.transactions" does not exist
  LINE 12:     FROM "merchant_data"."public"."transactions" t
                    ^
  compiled code at target\run\merchant_data_project\models\curated\questionB.sql
[0m18:13:40.932724 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6706406b-7262-422b-94a1-04972133d152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BA2048200>]}
[0m18:13:40.933728 [error] [Thread-1 (]: 12 of 19 ERROR creating sql view model public.questionB ........................ [[31mERROR[0m in 0.19s]
[0m18:13:40.934725 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.questionB
[0m18:13:40.934725 [debug] [Thread-1 (]: Began running node model.merchant_data_project.questionC
[0m18:13:40.935811 [info ] [Thread-1 (]: 13 of 19 START sql view model public.questionC ................................. [RUN]
[0m18:13:40.936727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.merchant_data_project.questionB, now model.merchant_data_project.questionC)
[0m18:13:40.937811 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.questionC
[0m18:13:40.941841 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.questionC"
[0m18:13:40.943723 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.questionC
[0m18:13:40.946745 [debug] [Thread-1 (]: Writing runtime sql for node "model.merchant_data_project.questionC"
[0m18:13:40.948742 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.questionC"
[0m18:13:40.949724 [debug] [Thread-1 (]: On model.merchant_data_project.questionC: BEGIN
[0m18:13:40.950726 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:40.992467 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m18:13:40.993469 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.questionC"
[0m18:13:40.993469 [debug] [Thread-1 (]: On model.merchant_data_project.questionC: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.questionC"} */

  create view "merchant_data"."public"."questionC__dbt_tmp"
    
    
  as (
    WITH successful_card_present_transactions AS (
    SELECT
        t.merchant_id,
        t.server_time_created_at,
        row_number() OVER (PARTITION BY t.merchant_id ORDER BY t.server_time_created_at) AS transaction_rank
    FROM "merchant_data"."public"."transactions" t
    JOIN "merchant_data"."public"."payment_types" pt
        ON t.payment_type_code = pt.code  -- Joining on the payment type code
    WHERE t.tx_result = 11  -- Successful transaction (tx_result = 11)
      AND NOT pt.code IN (8,9,12,14)  -- Card-not-present transaction codes
)
SELECT
    st.merchant_id,
    min(st.server_time_created_at) AS first_card_present_transaction_date
FROM successful_card_present_transactions st
WHERE st.transaction_rank = 1  -- Get the first successful card-present transaction
GROUP BY st.merchant_id
  );
[0m18:13:40.994507 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.transactions" does not exist
LINE 12:     FROM "merchant_data"."public"."transactions" t
                  ^

[0m18:13:40.994507 [debug] [Thread-1 (]: On model.merchant_data_project.questionC: ROLLBACK
[0m18:13:40.995471 [debug] [Thread-1 (]: On model.merchant_data_project.questionC: Close
[0m18:13:40.997466 [debug] [Thread-1 (]: Database Error in model questionC (models\curated\questionC.sql)
  relation "public.transactions" does not exist
  LINE 12:     FROM "merchant_data"."public"."transactions" t
                    ^
  compiled code at target\run\merchant_data_project\models\curated\questionC.sql
[0m18:13:40.998476 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6706406b-7262-422b-94a1-04972133d152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BA20FCEC0>]}
[0m18:13:40.999467 [error] [Thread-1 (]: 13 of 19 ERROR creating sql view model public.questionC ........................ [[31mERROR[0m in 0.06s]
[0m18:13:41.000469 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.questionC
[0m18:13:41.001472 [debug] [Thread-1 (]: Began running node model.merchant_data_project.questionD
[0m18:13:41.001472 [info ] [Thread-1 (]: 14 of 19 START sql view model public.questionD ................................. [RUN]
[0m18:13:41.002466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.merchant_data_project.questionC, now model.merchant_data_project.questionD)
[0m18:13:41.002466 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.questionD
[0m18:13:41.005834 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.questionD"
[0m18:13:41.007844 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.questionD
[0m18:13:41.010839 [debug] [Thread-1 (]: Writing runtime sql for node "model.merchant_data_project.questionD"
[0m18:13:41.012845 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.questionD"
[0m18:13:41.013840 [debug] [Thread-1 (]: On model.merchant_data_project.questionD: BEGIN
[0m18:13:41.013840 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:41.049003 [debug] [Thread-1 (]: SQL status: BEGIN in 0.035 seconds
[0m18:13:41.050008 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.questionD"
[0m18:13:41.050008 [debug] [Thread-1 (]: On model.merchant_data_project.questionD: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.questionD"} */

  create view "merchant_data"."public"."questionD__dbt_tmp"
    
    
  as (
    WITH successful_transactions AS (
    SELECT
        t.merchant_id,
        t.server_time_created_at,
        row_number() OVER (PARTITION BY t.merchant_id ORDER BY t.server_time_created_at) AS transaction_rank
    FROM "merchant_data"."public"."transactions" t
    WHERE t.tx_result = 11  -- Successful transaction (tx_result = 11)
)
SELECT
    st.merchant_id,
    min(st.server_time_created_at) AS fifth_successful_transaction_date
FROM successful_transactions st
WHERE st.transaction_rank = 5  -- Get the fifth successful transaction for each merchant
GROUP BY st.merchant_id
  );
[0m18:13:41.051042 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.transactions" does not exist
LINE 12:     FROM "merchant_data"."public"."transactions" t
                  ^

[0m18:13:41.051042 [debug] [Thread-1 (]: On model.merchant_data_project.questionD: ROLLBACK
[0m18:13:41.052005 [debug] [Thread-1 (]: On model.merchant_data_project.questionD: Close
[0m18:13:41.054008 [debug] [Thread-1 (]: Database Error in model questionD (models\curated\questionD.sql)
  relation "public.transactions" does not exist
  LINE 12:     FROM "merchant_data"."public"."transactions" t
                    ^
  compiled code at target\run\merchant_data_project\models\curated\questionD.sql
[0m18:13:41.054008 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6706406b-7262-422b-94a1-04972133d152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BA200B710>]}
[0m18:13:41.055414 [error] [Thread-1 (]: 14 of 19 ERROR creating sql view model public.questionD ........................ [[31mERROR[0m in 0.05s]
[0m18:13:41.055414 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.questionD
[0m18:13:41.056425 [debug] [Thread-1 (]: Began running node model.merchant_data_project.questionE
[0m18:13:41.057427 [info ] [Thread-1 (]: 15 of 19 START sql view model public.questionE ................................. [RUN]
[0m18:13:41.058423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.merchant_data_project.questionD, now model.merchant_data_project.questionE)
[0m18:13:41.058423 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.questionE
[0m18:13:41.061429 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.questionE"
[0m18:13:41.062429 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.questionE
[0m18:13:41.065428 [debug] [Thread-1 (]: Writing runtime sql for node "model.merchant_data_project.questionE"
[0m18:13:41.067430 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.questionE"
[0m18:13:41.067430 [debug] [Thread-1 (]: On model.merchant_data_project.questionE: BEGIN
[0m18:13:41.068429 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:41.105143 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m18:13:41.105143 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.questionE"
[0m18:13:41.106145 [debug] [Thread-1 (]: On model.merchant_data_project.questionE: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.questionE"} */

  create view "merchant_data"."public"."questionE__dbt_tmp"
    
    
  as (
    WITH successful_transactions AS (
    SELECT
        t.merchant_id,
        t.server_time_created_at,
        row_number() OVER (PARTITION BY t.merchant_id ORDER BY t.server_time_created_at DESC) AS transaction_rank
    FROM "merchant_data"."public"."transactions" t
    WHERE t.tx_result = 11  -- Successful transaction (tx_result = 11)
)
SELECT
    st.merchant_id,
    min(st.server_time_created_at) AS last_successful_transaction_date
FROM successful_transactions st
WHERE st.transaction_rank = 1  -- Get the most recent successful transaction for each merchant
GROUP BY st.merchant_id
  );
[0m18:13:41.107473 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.transactions" does not exist
LINE 12:     FROM "merchant_data"."public"."transactions" t
                  ^

[0m18:13:41.108516 [debug] [Thread-1 (]: On model.merchant_data_project.questionE: ROLLBACK
[0m18:13:41.108516 [debug] [Thread-1 (]: On model.merchant_data_project.questionE: Close
[0m18:13:41.112481 [debug] [Thread-1 (]: Database Error in model questionE (models\curated\questionE.sql)
  relation "public.transactions" does not exist
  LINE 12:     FROM "merchant_data"."public"."transactions" t
                    ^
  compiled code at target\run\merchant_data_project\models\curated\questionE.sql
[0m18:13:41.113486 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6706406b-7262-422b-94a1-04972133d152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BA1FD8740>]}
[0m18:13:41.114505 [error] [Thread-1 (]: 15 of 19 ERROR creating sql view model public.questionE ........................ [[31mERROR[0m in 0.06s]
[0m18:13:41.115482 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.questionE
[0m18:13:41.115482 [debug] [Thread-1 (]: Began running node model.merchant_data_project.questionF
[0m18:13:41.115482 [info ] [Thread-1 (]: 16 of 19 START sql view model public.questionF ................................. [RUN]
[0m18:13:41.116484 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.merchant_data_project.questionE, now model.merchant_data_project.questionF)
[0m18:13:41.116484 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.questionF
[0m18:13:41.119480 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.questionF"
[0m18:13:41.120487 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.questionF
[0m18:13:41.123480 [debug] [Thread-1 (]: Writing runtime sql for node "model.merchant_data_project.questionF"
[0m18:13:41.124482 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.questionF"
[0m18:13:41.125491 [debug] [Thread-1 (]: On model.merchant_data_project.questionF: BEGIN
[0m18:13:41.125491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:41.158114 [debug] [Thread-1 (]: SQL status: BEGIN in 0.033 seconds
[0m18:13:41.159132 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.questionF"
[0m18:13:41.160156 [debug] [Thread-1 (]: On model.merchant_data_project.questionF: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.questionF"} */

  create view "merchant_data"."public"."questionF__dbt_tmp"
    
    
  as (
    SELECT
    t.merchant_id,
    count(*) AS all_time_successful_transactions
FROM "merchant_data"."public"."transactions" t
WHERE t.tx_result = 11  -- Successful transaction (tx_result = 11)
GROUP BY t.merchant_id
  );
[0m18:13:41.161138 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.transactions" does not exist
LINE 10: FROM "merchant_data"."public"."transactions" t
              ^

[0m18:13:41.161138 [debug] [Thread-1 (]: On model.merchant_data_project.questionF: ROLLBACK
[0m18:13:41.161138 [debug] [Thread-1 (]: On model.merchant_data_project.questionF: Close
[0m18:13:41.163138 [debug] [Thread-1 (]: Database Error in model questionF (models\curated\questionF.sql)
  relation "public.transactions" does not exist
  LINE 10: FROM "merchant_data"."public"."transactions" t
                ^
  compiled code at target\run\merchant_data_project\models\curated\questionF.sql
[0m18:13:41.164137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6706406b-7262-422b-94a1-04972133d152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BA18B8410>]}
[0m18:13:41.164137 [error] [Thread-1 (]: 16 of 19 ERROR creating sql view model public.questionF ........................ [[31mERROR[0m in 0.05s]
[0m18:13:41.165137 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.questionF
[0m18:13:41.165137 [debug] [Thread-1 (]: Began running node model.merchant_data_project.questionG
[0m18:13:41.166161 [info ] [Thread-1 (]: 17 of 19 START sql view model public.questionG ................................. [RUN]
[0m18:13:41.167138 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.merchant_data_project.questionF, now model.merchant_data_project.questionG)
[0m18:13:41.167138 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.questionG
[0m18:13:41.169138 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.questionG"
[0m18:13:41.171135 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.questionG
[0m18:13:41.175138 [debug] [Thread-1 (]: Writing runtime sql for node "model.merchant_data_project.questionG"
[0m18:13:41.176673 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.questionG"
[0m18:13:41.176673 [debug] [Thread-1 (]: On model.merchant_data_project.questionG: BEGIN
[0m18:13:41.177667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:41.209677 [debug] [Thread-1 (]: SQL status: BEGIN in 0.032 seconds
[0m18:13:41.209677 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.questionG"
[0m18:13:41.209677 [debug] [Thread-1 (]: On model.merchant_data_project.questionG: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.questionG"} */

  create view "merchant_data"."public"."questionG__dbt_tmp"
    
    
  as (
    SELECT
    t.merchant_id,
    count(*) AS all_time_failed_transactions
FROM "merchant_data"."public"."transactions" t
WHERE t.tx_result != 11  -- failed transaction (tx_result != 11)
GROUP BY t.merchant_id
  );
[0m18:13:41.210671 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.transactions" does not exist
LINE 10: FROM "merchant_data"."public"."transactions" t
              ^

[0m18:13:41.210671 [debug] [Thread-1 (]: On model.merchant_data_project.questionG: ROLLBACK
[0m18:13:41.211671 [debug] [Thread-1 (]: On model.merchant_data_project.questionG: Close
[0m18:13:41.213675 [debug] [Thread-1 (]: Database Error in model questionG (models\curated\questionG.sql)
  relation "public.transactions" does not exist
  LINE 10: FROM "merchant_data"."public"."transactions" t
                ^
  compiled code at target\run\merchant_data_project\models\curated\questionG.sql
[0m18:13:41.214898 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6706406b-7262-422b-94a1-04972133d152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BA18BC3B0>]}
[0m18:13:41.214898 [error] [Thread-1 (]: 17 of 19 ERROR creating sql view model public.questionG ........................ [[31mERROR[0m in 0.05s]
[0m18:13:41.215908 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.questionG
[0m18:13:41.216907 [debug] [Thread-1 (]: Began running node model.merchant_data_project.questionH
[0m18:13:41.216907 [info ] [Thread-1 (]: 18 of 19 START sql view model public.questionH ................................. [RUN]
[0m18:13:41.217904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.merchant_data_project.questionG, now model.merchant_data_project.questionH)
[0m18:13:41.217904 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.questionH
[0m18:13:41.220923 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.questionH"
[0m18:13:41.221913 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.questionH
[0m18:13:41.225903 [debug] [Thread-1 (]: Writing runtime sql for node "model.merchant_data_project.questionH"
[0m18:13:41.227910 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.questionH"
[0m18:13:41.228902 [debug] [Thread-1 (]: On model.merchant_data_project.questionH: BEGIN
[0m18:13:41.228902 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:41.266437 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m18:13:41.266437 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.questionH"
[0m18:13:41.267442 [debug] [Thread-1 (]: On model.merchant_data_project.questionH: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.questionH"} */

  create view "merchant_data"."public"."questionH__dbt_tmp"
    
    
  as (
    WITH merchant_signup AS (
    -- Define the 7,30,90,180,365 day periods after signup for each merchant
    SELECT
        merchant_id,
        sign_up_time,
        sign_up_time + INTERVAL '7 days' AS signup_plus_7_days,
        sign_up_time + INTERVAL '30 days' AS signup_plus_30_days,
        sign_up_time + INTERVAL '90 days' AS signup_plus_90_days,
        sign_up_time + INTERVAL '180 days' AS signup_plus_180_days,
        sign_up_time + INTERVAL '365 days' AS signup_plus_365_days
    FROM "merchant_data"."public"."merchants"
),

transactions_in_period AS (
    -- Join transactions WITH calculated periods, filtering by successful transactions within 365 days of signup
    SELECT
        m.merchant_id,
        t.amount,
        t.vat_amount,
        t.tip_amount,
        t.currency,
        CASE
            WHEN t.server_time_created_at >= m.sign_up_time 
                 AND t.server_time_created_at < m.signup_plus_7_days THEN '7_day'
            WHEN t.server_time_created_at >= m.sign_up_time
                 AND t.server_time_created_at < m.signup_plus_30_days THEN '30_day'
            WHEN t.server_time_created_at >= m.sign_up_time
                 AND t.server_time_created_at < m.signup_plus_90_days THEN '90_day'
            WHEN t.server_time_created_at >= m.sign_up_time
                 AND t.server_time_created_at < m.signup_plus_180_days THEN '180_day'
            WHEN t.server_time_created_at >= m.sign_up_time
                 AND t.server_time_created_at < m.signup_plus_365_days THEN '365_day'
        END AS PERIOD
    FROM merchant_signup m
    JOIN "merchant_data"."public"."transactions" t
        ON m.merchant_id = t.merchant_id
    WHERE t.tx_result = 11  -- Only successful transactions
      AND t.server_time_created_at < m.signup_plus_365_days
)

-- Final aggregation, calculating TPV for both 7-day AND 30-day periods
SELECT
    merchant_id,
    currency,
    sum(CASE WHEN PERIOD = '7_day' THEN amount + vat_amount + tip_amount ELSE 0 END) AS tpv_7_day,
    sum(CASE WHEN PERIOD IN ('7_day', '30_day') THEN amount + vat_amount + tip_amount ELSE 0 END) AS tpv_30_day,
    sum(CASE WHEN PERIOD IN ('7_day', '30_day', '90_day') THEN amount + vat_amount + tip_amount ELSE 0 END) AS tpv_90_day,
    sum(CASE WHEN PERIOD IN ('7_day', '30_day','90_day','180_day') THEN amount + vat_amount + tip_amount ELSE 0 END) AS tpv_180_day,
    sum(CASE WHEN PERIOD IN ('7_day', '30_day','90_day','180_day','365_day') THEN amount + vat_amount + tip_amount ELSE 0 END) AS tpv_365_day
FROM transactions_in_period
WHERE PERIOD IS NOT NULL  -- Only transactions within 7 or 30 days of signup
GROUP BY merchant_id, currency
ORDER BY merchant_id;
  );
[0m18:13:41.267442 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 59: ORDER BY merchant_id;
                             ^

[0m18:13:41.268540 [debug] [Thread-1 (]: On model.merchant_data_project.questionH: ROLLBACK
[0m18:13:41.268540 [debug] [Thread-1 (]: On model.merchant_data_project.questionH: Close
[0m18:13:41.270914 [debug] [Thread-1 (]: Database Error in model questionH (models\curated\questionH.sql)
  syntax error at or near ";"
  LINE 59: ORDER BY merchant_id;
                               ^
  compiled code at target\run\merchant_data_project\models\curated\questionH.sql
[0m18:13:41.270914 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6706406b-7262-422b-94a1-04972133d152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BA202EF90>]}
[0m18:13:41.272166 [error] [Thread-1 (]: 18 of 19 ERROR creating sql view model public.questionH ........................ [[31mERROR[0m in 0.05s]
[0m18:13:41.273171 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.questionH
[0m18:13:41.273171 [debug] [Thread-1 (]: Began running node model.merchant_data_project.merchant_summary
[0m18:13:41.274175 [info ] [Thread-1 (]: 19 of 19 SKIP relation public.merchant_summary ................................. [[33mSKIP[0m]
[0m18:13:41.275174 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.merchant_summary
[0m18:13:41.276699 [debug] [MainThread]: Using postgres connection "master"
[0m18:13:41.276699 [debug] [MainThread]: On master: BEGIN
[0m18:13:41.276699 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:13:41.308564 [debug] [MainThread]: SQL status: BEGIN in 0.032 seconds
[0m18:13:41.309565 [debug] [MainThread]: On master: COMMIT
[0m18:13:41.309565 [debug] [MainThread]: Using postgres connection "master"
[0m18:13:41.310563 [debug] [MainThread]: On master: COMMIT
[0m18:13:41.310563 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:13:41.310563 [debug] [MainThread]: On master: Close
[0m18:13:41.311563 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:13:41.311563 [debug] [MainThread]: Connection 'list_merchant_data' was properly closed.
[0m18:13:41.311563 [debug] [MainThread]: Connection 'list_merchant_data_public' was properly closed.
[0m18:13:41.312564 [debug] [MainThread]: Connection 'model.merchant_data_project.questionH' was properly closed.
[0m18:13:41.312564 [info ] [MainThread]: 
[0m18:13:41.313563 [info ] [MainThread]: Finished running 19 view models in 0 hours 0 minutes and 1.76 seconds (1.76s).
[0m18:13:41.316572 [debug] [MainThread]: Command end result
[0m18:13:41.351318 [info ] [MainThread]: 
[0m18:13:41.352300 [info ] [MainThread]: [31mCompleted with 9 errors and 0 warnings:[0m
[0m18:13:41.353302 [info ] [MainThread]: 
[0m18:13:41.354303 [error] [MainThread]:   Database Error in model questionA (models\curated\questionA.sql)
  relation "public.merchants" does not exist
  LINE 10: FROM "merchant_data"."public"."merchants" m
                ^
  compiled code at target\run\merchant_data_project\models\curated\questionA.sql
[0m18:13:41.358303 [info ] [MainThread]: 
[0m18:13:41.382816 [error] [MainThread]:   Database Error in model curated_merchant_data (models\curated\curated_merchant_data.sql)
  syntax error at or near ";"
  LINE 189: ORDER BY sign_up_time;
                                 ^
  compiled code at target\run\merchant_data_project\models\curated\curated_merchant_data.sql
[0m18:13:41.385112 [info ] [MainThread]: 
[0m18:13:41.392112 [error] [MainThread]:   Database Error in model questionB (models\curated\questionB.sql)
  relation "public.transactions" does not exist
  LINE 12:     FROM "merchant_data"."public"."transactions" t
                    ^
  compiled code at target\run\merchant_data_project\models\curated\questionB.sql
[0m18:13:41.392112 [info ] [MainThread]: 
[0m18:13:41.393420 [error] [MainThread]:   Database Error in model questionC (models\curated\questionC.sql)
  relation "public.transactions" does not exist
  LINE 12:     FROM "merchant_data"."public"."transactions" t
                    ^
  compiled code at target\run\merchant_data_project\models\curated\questionC.sql
[0m18:13:41.394427 [info ] [MainThread]: 
[0m18:13:41.394427 [error] [MainThread]:   Database Error in model questionD (models\curated\questionD.sql)
  relation "public.transactions" does not exist
  LINE 12:     FROM "merchant_data"."public"."transactions" t
                    ^
  compiled code at target\run\merchant_data_project\models\curated\questionD.sql
[0m18:13:41.395432 [info ] [MainThread]: 
[0m18:13:41.395432 [error] [MainThread]:   Database Error in model questionE (models\curated\questionE.sql)
  relation "public.transactions" does not exist
  LINE 12:     FROM "merchant_data"."public"."transactions" t
                    ^
  compiled code at target\run\merchant_data_project\models\curated\questionE.sql
[0m18:13:41.396686 [info ] [MainThread]: 
[0m18:13:41.396686 [error] [MainThread]:   Database Error in model questionF (models\curated\questionF.sql)
  relation "public.transactions" does not exist
  LINE 10: FROM "merchant_data"."public"."transactions" t
                ^
  compiled code at target\run\merchant_data_project\models\curated\questionF.sql
[0m18:13:41.397768 [info ] [MainThread]: 
[0m18:13:41.398921 [error] [MainThread]:   Database Error in model questionG (models\curated\questionG.sql)
  relation "public.transactions" does not exist
  LINE 10: FROM "merchant_data"."public"."transactions" t
                ^
  compiled code at target\run\merchant_data_project\models\curated\questionG.sql
[0m18:13:41.398921 [info ] [MainThread]: 
[0m18:13:41.399930 [error] [MainThread]:   Database Error in model questionH (models\curated\questionH.sql)
  syntax error at or near ";"
  LINE 59: ORDER BY merchant_id;
                               ^
  compiled code at target\run\merchant_data_project\models\curated\questionH.sql
[0m18:13:41.400925 [info ] [MainThread]: 
[0m18:13:41.400925 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=9 SKIP=1 TOTAL=19
[0m18:13:41.404932 [debug] [MainThread]: Command `dbt run` failed at 18:13:41.403927 after 3.21 seconds
[0m18:13:41.404932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BA20F5790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B9D4F2FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BA0CCCF20>]}
[0m18:13:41.405927 [debug] [MainThread]: Flushing usage events
[0m18:17:51.265840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299C470CDA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299C4EC0BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299C5395940>]}


============================== 18:17:51.269844 | cc1cfd05-dc21-411d-9313-886b4a9182cf ==============================
[0m18:17:51.269844 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m18:17:51.270845 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\alvaro\\.dbt', 'log_path': 'c:\\Users\\alvaro\\Desktop\\sumup_assignment\\merchant_data_project\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m18:17:51.411862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc1cfd05-dc21-411d-9313-886b4a9182cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299C2EA8DD0>]}
[0m18:17:51.460674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc1cfd05-dc21-411d-9313-886b4a9182cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299C4F30470>]}
[0m18:17:51.461670 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:17:51.468556 [debug] [MainThread]: checksum: 1baa5f065c32405924ece49854556a24cca39209e299ad6824f7dd821d22edfd, vars: {}, profile: , target: dev, version: 1.9.0b4
[0m18:17:51.537644 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:17:51.538643 [debug] [MainThread]: previous checksum: 1baa5f065c32405924ece49854556a24cca39209e299ad6824f7dd821d22edfd, current checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d
[0m18:17:51.538643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cc1cfd05-dc21-411d-9313-886b4a9182cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299C6193AA0>]}
[0m18:17:52.473583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc1cfd05-dc21-411d-9313-886b4a9182cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299C653B500>]}
[0m18:17:52.515588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc1cfd05-dc21-411d-9313-886b4a9182cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299C60A2390>]}
[0m18:17:52.515588 [info ] [MainThread]: Found 19 models, 11 sources, 428 macros
[0m18:17:52.516588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc1cfd05-dc21-411d-9313-886b4a9182cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299C65E8DA0>]}
[0m18:17:52.519925 [info ] [MainThread]: 
[0m18:17:52.519925 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:17:52.519925 [info ] [MainThread]: 
[0m18:17:52.520918 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:17:52.524913 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merchant_data_public'
[0m18:17:52.615557 [debug] [ThreadPool]: Using postgres connection "list_merchant_data_public"
[0m18:17:52.616551 [debug] [ThreadPool]: On list_merchant_data_public: BEGIN
[0m18:17:52.616551 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:17:52.657548 [debug] [ThreadPool]: SQL status: BEGIN in 0.041 seconds
[0m18:17:52.657548 [debug] [ThreadPool]: Using postgres connection "list_merchant_data_public"
[0m18:17:52.657548 [debug] [ThreadPool]: On list_merchant_data_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "list_merchant_data_public"} */
select
      'merchant_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'merchant_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'merchant_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:17:52.664549 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.006 seconds
[0m18:17:52.665657 [debug] [ThreadPool]: On list_merchant_data_public: ROLLBACK
[0m18:17:52.665657 [debug] [ThreadPool]: On list_merchant_data_public: Close
[0m18:17:52.673130 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:52.673130 [debug] [MainThread]: On master: BEGIN
[0m18:17:52.673130 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:17:52.818036 [debug] [MainThread]: SQL status: BEGIN in 0.144 seconds
[0m18:17:52.818036 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:52.819034 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:17:52.826038 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m18:17:52.827125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc1cfd05-dc21-411d-9313-886b4a9182cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299C68AAAB0>]}
[0m18:17:52.827125 [debug] [MainThread]: On master: ROLLBACK
[0m18:17:52.828162 [debug] [MainThread]: On master: Close
[0m18:17:52.831038 [debug] [Thread-1 (]: Began running node model.merchant_data_project.account_statuses
[0m18:17:52.832037 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.merchant_data_project.account_statuses'
[0m18:17:52.832037 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.account_statuses
[0m18:17:52.838148 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.account_statuses"
[0m18:17:52.839711 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.account_statuses
[0m18:17:52.840839 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.account_statuses
[0m18:17:52.840839 [debug] [Thread-1 (]: Began running node model.merchant_data_project.card_reader_types
[0m18:17:52.840839 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.merchant_data_project.account_statuses, now model.merchant_data_project.card_reader_types)
[0m18:17:52.841870 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.card_reader_types
[0m18:17:52.843935 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.card_reader_types"
[0m18:17:52.844845 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.card_reader_types
[0m18:17:52.844845 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.card_reader_types
[0m18:17:52.845933 [debug] [Thread-1 (]: Began running node model.merchant_data_project.legal_types
[0m18:17:52.845933 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.merchant_data_project.card_reader_types, now model.merchant_data_project.legal_types)
[0m18:17:52.845933 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.legal_types
[0m18:17:52.847941 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.legal_types"
[0m18:17:52.849843 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.legal_types
[0m18:17:52.849843 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.legal_types
[0m18:17:52.850844 [debug] [Thread-1 (]: Began running node model.merchant_data_project.merchant_categories
[0m18:17:52.850844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.merchant_data_project.legal_types, now model.merchant_data_project.merchant_categories)
[0m18:17:52.851843 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.merchant_categories
[0m18:17:52.854933 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.merchant_categories"
[0m18:17:52.855861 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.merchant_categories
[0m18:17:52.856847 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.merchant_categories
[0m18:17:52.856847 [debug] [Thread-1 (]: Began running node model.merchant_data_project.merchants
[0m18:17:52.857943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.merchant_data_project.merchant_categories, now model.merchant_data_project.merchants)
[0m18:17:52.857943 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.merchants
[0m18:17:52.859933 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.merchants"
[0m18:17:52.860847 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.merchants
[0m18:17:52.861846 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.merchants
[0m18:17:52.861846 [debug] [Thread-1 (]: Began running node model.merchant_data_project.payment_types
[0m18:17:52.861846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.merchant_data_project.merchants, now model.merchant_data_project.payment_types)
[0m18:17:52.862843 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.payment_types
[0m18:17:52.864843 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.payment_types"
[0m18:17:52.864843 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.payment_types
[0m18:17:52.865846 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.payment_types
[0m18:17:52.866930 [debug] [Thread-1 (]: Began running node model.merchant_data_project.transaction_states
[0m18:17:52.866930 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.merchant_data_project.payment_types, now model.merchant_data_project.transaction_states)
[0m18:17:52.866930 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.transaction_states
[0m18:17:52.869934 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.transaction_states"
[0m18:17:52.870866 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.transaction_states
[0m18:17:52.871910 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.transaction_states
[0m18:17:52.871910 [debug] [Thread-1 (]: Began running node model.merchant_data_project.transaction_statuses
[0m18:17:52.872925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.merchant_data_project.transaction_states, now model.merchant_data_project.transaction_statuses)
[0m18:17:52.872925 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.transaction_statuses
[0m18:17:52.875932 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.transaction_statuses"
[0m18:17:52.876849 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.transaction_statuses
[0m18:17:52.877852 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.transaction_statuses
[0m18:17:52.877852 [debug] [Thread-1 (]: Began running node model.merchant_data_project.transactions
[0m18:17:52.877852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.merchant_data_project.transaction_statuses, now model.merchant_data_project.transactions)
[0m18:17:52.877852 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.transactions
[0m18:17:52.879938 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.transactions"
[0m18:17:52.880935 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.transactions
[0m18:17:52.881850 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.transactions
[0m18:17:52.881850 [debug] [Thread-1 (]: Began running node model.merchant_data_project.questionA
[0m18:17:52.881850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.merchant_data_project.transactions, now model.merchant_data_project.questionA)
[0m18:17:52.882931 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.questionA
[0m18:17:52.884848 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.questionA"
[0m18:17:52.886847 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.questionA
[0m18:17:52.887884 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.questionA
[0m18:17:52.887884 [debug] [Thread-1 (]: Began running node model.merchant_data_project.curated_merchant_data
[0m18:17:52.887884 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.merchant_data_project.questionA, now model.merchant_data_project.curated_merchant_data)
[0m18:17:52.887884 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.curated_merchant_data
[0m18:17:52.891943 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.curated_merchant_data"
[0m18:17:52.892986 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.curated_merchant_data
[0m18:17:52.893846 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.curated_merchant_data
[0m18:17:52.893846 [debug] [Thread-1 (]: Began running node model.merchant_data_project.questionB
[0m18:17:52.893846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.merchant_data_project.curated_merchant_data, now model.merchant_data_project.questionB)
[0m18:17:52.894935 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.questionB
[0m18:17:52.896934 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.questionB"
[0m18:17:52.897851 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.questionB
[0m18:17:52.897851 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.questionB
[0m18:17:52.898843 [debug] [Thread-1 (]: Began running node model.merchant_data_project.questionC
[0m18:17:52.898843 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.merchant_data_project.questionB, now model.merchant_data_project.questionC)
[0m18:17:52.898843 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.questionC
[0m18:17:52.901844 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.questionC"
[0m18:17:52.902844 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.questionC
[0m18:17:52.903851 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.questionC
[0m18:17:52.904844 [debug] [Thread-1 (]: Began running node model.merchant_data_project.questionD
[0m18:17:52.904844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.merchant_data_project.questionC, now model.merchant_data_project.questionD)
[0m18:17:52.904844 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.questionD
[0m18:17:52.906843 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.questionD"
[0m18:17:52.907843 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.questionD
[0m18:17:52.908846 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.questionD
[0m18:17:52.908846 [debug] [Thread-1 (]: Began running node model.merchant_data_project.questionE
[0m18:17:52.909843 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.merchant_data_project.questionD, now model.merchant_data_project.questionE)
[0m18:17:52.909843 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.questionE
[0m18:17:52.911843 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.questionE"
[0m18:17:52.912846 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.questionE
[0m18:17:52.912846 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.questionE
[0m18:17:52.913843 [debug] [Thread-1 (]: Began running node model.merchant_data_project.questionF
[0m18:17:52.913843 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.merchant_data_project.questionE, now model.merchant_data_project.questionF)
[0m18:17:52.913843 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.questionF
[0m18:17:52.915843 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.questionF"
[0m18:17:52.916846 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.questionF
[0m18:17:52.917845 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.questionF
[0m18:17:52.917845 [debug] [Thread-1 (]: Began running node model.merchant_data_project.questionG
[0m18:17:52.918886 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.merchant_data_project.questionF, now model.merchant_data_project.questionG)
[0m18:17:52.919850 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.questionG
[0m18:17:52.922923 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.questionG"
[0m18:17:52.923847 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.questionG
[0m18:17:52.924845 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.questionG
[0m18:17:52.924845 [debug] [Thread-1 (]: Began running node model.merchant_data_project.questionH
[0m18:17:52.924845 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.merchant_data_project.questionG, now model.merchant_data_project.questionH)
[0m18:17:52.924845 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.questionH
[0m18:17:52.928015 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.questionH"
[0m18:17:52.928939 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.questionH
[0m18:17:52.929938 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.questionH
[0m18:17:52.929938 [debug] [Thread-1 (]: Began running node model.merchant_data_project.merchant_summary
[0m18:17:52.929938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.merchant_data_project.questionH, now model.merchant_data_project.merchant_summary)
[0m18:17:52.929938 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.merchant_summary
[0m18:17:52.932019 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.merchant_summary"
[0m18:17:52.933041 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.merchant_summary
[0m18:17:52.935399 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.merchant_summary
[0m18:17:52.936405 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:17:52.937399 [debug] [MainThread]: Connection 'list_merchant_data_public' was properly closed.
[0m18:17:52.937399 [debug] [MainThread]: Connection 'model.merchant_data_project.merchant_summary' was properly closed.
[0m18:17:52.939397 [debug] [MainThread]: Command end result
[0m18:17:52.994995 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\alvaro\Desktop\sumup_assignment\merchant_data_project\target\manifest.json
[0m18:17:53.008910 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\alvaro\Desktop\sumup_assignment\merchant_data_project\target\semantic_manifest.json
[0m18:17:53.016933 [debug] [MainThread]: Wrote artifact RunExecutionResult to c:\Users\alvaro\Desktop\sumup_assignment\merchant_data_project\target\run_results.json
[0m18:17:53.447176 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m18:17:53.448308 [info ] [MainThread]: Building catalog
[0m18:17:53.458365 [debug] [ThreadPool]: Acquiring new postgres connection 'merchant_data.information_schema'
[0m18:17:53.464408 [debug] [ThreadPool]: Using postgres connection "merchant_data.information_schema"
[0m18:17:53.464408 [debug] [ThreadPool]: On merchant_data.information_schema: BEGIN
[0m18:17:53.464408 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:17:53.502889 [debug] [ThreadPool]: SQL status: BEGIN in 0.038 seconds
[0m18:17:53.503888 [debug] [ThreadPool]: Using postgres connection "merchant_data.information_schema"
[0m18:17:53.503888 [debug] [ThreadPool]: On merchant_data.information_schema: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "merchant_data.information_schema"} */

    
    

    select
        'merchant_data' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('questionH')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('questionE')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('questionB')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('merchant_categories')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('transaction_states')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('curated_merchant_data')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('questionC')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('merchants')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('payment_types')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('account_statuses')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('questionF')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('card_reader_types')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('merchant_account_statuses')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('transaction_statuses')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('transactions')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('questionA')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('questionG')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('legal_types')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('questionD')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('merchant_summary')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m18:17:53.514966 [debug] [ThreadPool]: SQL status: SELECT 97 in 0.010 seconds
[0m18:17:53.521878 [debug] [ThreadPool]: On merchant_data.information_schema: ROLLBACK
[0m18:17:53.521878 [debug] [ThreadPool]: On merchant_data.information_schema: Close
[0m18:17:53.535891 [debug] [MainThread]: Wrote artifact CatalogArtifact to c:\Users\alvaro\Desktop\sumup_assignment\merchant_data_project\target\catalog.json
[0m18:17:53.555587 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\alvaro\Desktop\sumup_assignment\merchant_data_project\target\manifest.json
[0m18:17:53.557587 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\alvaro\Desktop\sumup_assignment\merchant_data_project\target\semantic_manifest.json
[0m18:17:53.558587 [info ] [MainThread]: Catalog written to c:\Users\alvaro\Desktop\sumup_assignment\merchant_data_project\target\catalog.json
[0m18:17:53.559645 [debug] [MainThread]: Command `cli docs generate` succeeded at 18:17:53.559645 after 2.43 seconds
[0m18:17:53.560593 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m18:17:53.560593 [debug] [MainThread]: Connection 'merchant_data.information_schema' was properly closed.
[0m18:17:53.560593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299C56704A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299C59FE0F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299C59FD730>]}
[0m18:17:53.560593 [debug] [MainThread]: Flushing usage events
[0m18:17:54.042302 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:19:35.306105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219092963F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219058DD820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219092378C0>]}


============================== 18:19:35.309108 | f18fd60d-8a95-4a25-9d93-7da36d01b014 ==============================
[0m18:19:35.309108 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m18:19:35.310105 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'c:\\Users\\alvaro\\Desktop\\sumup_assignment\\merchant_data_project\\logs', 'profiles_dir': 'C:\\Users\\alvaro\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:19:35.451035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f18fd60d-8a95-4a25-9d93-7da36d01b014', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021909CA1940>]}
[0m18:19:35.500035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f18fd60d-8a95-4a25-9d93-7da36d01b014', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219058DD820>]}
[0m18:19:35.501062 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:19:35.507044 [debug] [MainThread]: checksum: 1baa5f065c32405924ece49854556a24cca39209e299ad6824f7dd821d22edfd, vars: {}, profile: , target: dev, version: 1.9.0b4
[0m18:19:35.631581 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:19:35.632646 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:19:35.658143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f18fd60d-8a95-4a25-9d93-7da36d01b014', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021909D58DA0>]}
[0m18:19:35.717488 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\alvaro\Desktop\sumup_assignment\merchant_data_project\target\manifest.json
[0m18:19:35.720401 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\alvaro\Desktop\sumup_assignment\merchant_data_project\target\semantic_manifest.json
[0m18:19:35.746820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f18fd60d-8a95-4a25-9d93-7da36d01b014', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021909D1DB50>]}
[0m18:19:35.746820 [info ] [MainThread]: Found 19 models, 11 sources, 428 macros
[0m18:19:35.746820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f18fd60d-8a95-4a25-9d93-7da36d01b014', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002190A376780>]}
[0m18:19:35.747821 [warn ] [MainThread]: The selection criterion '+src_payment.yml' does not match any enabled nodes
[0m18:19:35.749821 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m18:19:35.750816 [debug] [MainThread]: Command end result
[0m18:19:35.773816 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\alvaro\Desktop\sumup_assignment\merchant_data_project\target\manifest.json
[0m18:19:35.776819 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\alvaro\Desktop\sumup_assignment\merchant_data_project\target\semantic_manifest.json
[0m18:19:35.779815 [debug] [MainThread]: Wrote artifact RunExecutionResult to c:\Users\alvaro\Desktop\sumup_assignment\merchant_data_project\target\run_results.json
[0m18:19:35.781816 [debug] [MainThread]: Command `cli run` succeeded at 18:19:35.781816 after 0.61 seconds
[0m18:19:35.781816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021905932A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219097D59D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021909AFD280>]}
[0m18:19:35.782832 [debug] [MainThread]: Flushing usage events
[0m18:19:36.274310 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:54:58.755720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F383F6A780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F383F68EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F383F6B290>]}


============================== 21:54:58.758746 | 147271f9-3f1a-48ff-a1fe-39fbafedf8db ==============================
[0m21:54:58.758746 [info ] [MainThread]: Running with dbt=1.8.8
[0m21:54:58.759725 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alvaro\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\alvaro\\Desktop\\sumup_assignment\\merchant_data_project\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:54:58.770810 [info ] [MainThread]: dbt version: 1.8.8
[0m21:54:58.770810 [info ] [MainThread]: python version: 3.12.7
[0m21:54:58.771727 [info ] [MainThread]: python path: C:\Users\alvaro\Desktop\sumup_assignment\dbt-sumup\Scripts\python.exe
[0m21:54:58.771727 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m21:54:58.850910 [info ] [MainThread]: Using profiles dir at C:\Users\alvaro\.dbt
[0m21:54:58.851842 [info ] [MainThread]: Using profiles.yml file at C:\Users\alvaro\.dbt\profiles.yml
[0m21:54:58.851842 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\alvaro\Desktop\sumup_assignment\merchant_data_project\dbt_project.yml
[0m21:54:58.852817 [info ] [MainThread]: adapter type: postgres
[0m21:54:58.853924 [info ] [MainThread]: adapter version: 1.8.2
[0m21:54:58.925456 [info ] [MainThread]: Configuration:
[0m21:54:58.926457 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:54:58.926457 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:54:58.927462 [info ] [MainThread]: Required dependencies:
[0m21:54:58.928457 [debug] [MainThread]: Executing "git --help"
[0m21:54:58.957076 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:54:58.958079 [debug] [MainThread]: STDERR: "b''"
[0m21:54:58.958079 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:54:58.959078 [info ] [MainThread]: Connection:
[0m21:54:58.959078 [info ] [MainThread]:   host: localhost
[0m21:54:58.960076 [info ] [MainThread]:   port: 5432
[0m21:54:58.961078 [info ] [MainThread]:   user: postgres
[0m21:54:58.961078 [info ] [MainThread]:   database: merchant_data
[0m21:54:58.962105 [info ] [MainThread]:   schema: public
[0m21:54:58.962105 [info ] [MainThread]:   connect_timeout: 10
[0m21:54:58.963075 [info ] [MainThread]:   role: None
[0m21:54:58.963075 [info ] [MainThread]:   search_path: None
[0m21:54:58.964075 [info ] [MainThread]:   keepalives_idle: 0
[0m21:54:58.964075 [info ] [MainThread]:   sslmode: None
[0m21:54:58.965074 [info ] [MainThread]:   sslcert: None
[0m21:54:58.965074 [info ] [MainThread]:   sslkey: None
[0m21:54:58.965074 [info ] [MainThread]:   sslrootcert: None
[0m21:54:58.966074 [info ] [MainThread]:   application_name: dbt
[0m21:54:58.966074 [info ] [MainThread]:   retries: 1
[0m21:54:58.967076 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:54:58.968075 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m21:54:59.014116 [debug] [MainThread]: Using postgres connection "debug"
[0m21:54:59.014116 [debug] [MainThread]: On debug: select 1 as id
[0m21:54:59.014116 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:54:59.051086 [debug] [MainThread]: SQL status: SELECT 1 in 0.037 seconds
[0m21:54:59.052194 [debug] [MainThread]: On debug: Close
[0m21:54:59.052194 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:54:59.053088 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:54:59.054191 [debug] [MainThread]: Command `dbt debug` succeeded at 21:54:59.054191 after 0.40 seconds
[0m21:54:59.055699 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:54:59.055699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3849555E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F384FFB890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F384EC8B30>]}
[0m21:54:59.055699 [debug] [MainThread]: Flushing usage events
[0m22:13:03.307323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0FB4F2F60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0FE887A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0FE885640>]}


============================== 22:13:03.310329 | c950d3be-d8fb-4f0a-a763-388fdb2a38e1 ==============================
[0m22:13:03.310329 [info ] [MainThread]: Running with dbt=1.8.8
[0m22:13:03.311328 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\alvaro\\Desktop\\sumup_assignment\\merchant_data_project\\logs', 'profiles_dir': 'C:\\Users\\alvaro\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select curated_merchant_data', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:13:03.467664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c950d3be-d8fb-4f0a-a763-388fdb2a38e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0FEC7F7A0>]}
[0m22:13:03.510659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c950d3be-d8fb-4f0a-a763-388fdb2a38e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0FE99FBC0>]}
[0m22:13:03.511659 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:13:03.528806 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m22:13:03.613400 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m22:13:03.613400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c950d3be-d8fb-4f0a-a763-388fdb2a38e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0FF4FEDB0>]}
[0m22:13:05.047794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c950d3be-d8fb-4f0a-a763-388fdb2a38e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0FF1C8A10>]}
[0m22:13:05.163927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c950d3be-d8fb-4f0a-a763-388fdb2a38e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0FFA31130>]}
[0m22:13:05.164923 [info ] [MainThread]: Found 11 models, 11 sources, 423 macros
[0m22:13:05.165924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c950d3be-d8fb-4f0a-a763-388fdb2a38e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0FF117410>]}
[0m22:13:05.167923 [info ] [MainThread]: 
[0m22:13:05.167923 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:13:05.168923 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merchant_data'
[0m22:13:05.279477 [debug] [ThreadPool]: Using postgres connection "list_merchant_data"
[0m22:13:05.279477 [debug] [ThreadPool]: On list_merchant_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "list_merchant_data"} */

    select distinct nspname from pg_namespace
  
[0m22:13:05.279477 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:13:05.442044 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.162 seconds
[0m22:13:05.443137 [debug] [ThreadPool]: On list_merchant_data: Close
[0m22:13:05.448040 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merchant_data_public'
[0m22:13:05.452338 [debug] [ThreadPool]: Using postgres connection "list_merchant_data_public"
[0m22:13:05.453356 [debug] [ThreadPool]: On list_merchant_data_public: BEGIN
[0m22:13:05.453356 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:13:05.592430 [debug] [ThreadPool]: SQL status: BEGIN in 0.139 seconds
[0m22:13:05.592430 [debug] [ThreadPool]: Using postgres connection "list_merchant_data_public"
[0m22:13:05.593479 [debug] [ThreadPool]: On list_merchant_data_public: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "list_merchant_data_public"} */
select
      'merchant_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'merchant_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'merchant_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:13:05.599461 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.006 seconds
[0m22:13:05.600446 [debug] [ThreadPool]: On list_merchant_data_public: ROLLBACK
[0m22:13:05.600446 [debug] [ThreadPool]: On list_merchant_data_public: Close
[0m22:13:05.605426 [debug] [MainThread]: Using postgres connection "master"
[0m22:13:05.606531 [debug] [MainThread]: On master: BEGIN
[0m22:13:05.606531 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:13:05.639982 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m22:13:05.639982 [debug] [MainThread]: Using postgres connection "master"
[0m22:13:05.641069 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:13:05.647984 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m22:13:05.649069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c950d3be-d8fb-4f0a-a763-388fdb2a38e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0FD2D1040>]}
[0m22:13:05.650069 [debug] [MainThread]: On master: ROLLBACK
[0m22:13:05.650069 [debug] [MainThread]: Using postgres connection "master"
[0m22:13:05.650069 [debug] [MainThread]: On master: BEGIN
[0m22:13:05.651064 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:13:05.651064 [debug] [MainThread]: On master: COMMIT
[0m22:13:05.652090 [debug] [MainThread]: Using postgres connection "master"
[0m22:13:05.652090 [debug] [MainThread]: On master: COMMIT
[0m22:13:05.652090 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:13:05.652090 [debug] [MainThread]: On master: Close
[0m22:13:05.653077 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:13:05.653983 [info ] [MainThread]: 
[0m22:13:05.658117 [debug] [Thread-1 (]: Began running node model.merchant_data_project.curated_merchant_data
[0m22:13:05.659206 [info ] [Thread-1 (]: 1 of 1 START sql table model public.curated_merchant_data ...................... [RUN]
[0m22:13:05.660125 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.merchant_data_project.curated_merchant_data'
[0m22:13:05.660125 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.curated_merchant_data
[0m22:13:05.667232 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.curated_merchant_data"
[0m22:13:05.668122 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.curated_merchant_data
[0m22:13:05.699812 [debug] [Thread-1 (]: Writing runtime sql for node "model.merchant_data_project.curated_merchant_data"
[0m22:13:05.700821 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.curated_merchant_data"
[0m22:13:05.701809 [debug] [Thread-1 (]: On model.merchant_data_project.curated_merchant_data: BEGIN
[0m22:13:05.701809 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:13:05.732982 [debug] [Thread-1 (]: SQL status: BEGIN in 0.031 seconds
[0m22:13:05.732982 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.curated_merchant_data"
[0m22:13:05.732982 [debug] [Thread-1 (]: On model.merchant_data_project.curated_merchant_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.curated_merchant_data"} */

  
    

  create  table "merchant_data"."public"."curated_merchant_data__dbt_tmp"
  
  
    as
  
  (
    WITH merchant_signup AS (
    -- Define the 7, 30, 90, 180, 365 day periods after signup for each merchant
    SELECT
        merchant_id,
        sign_up_time,
        sign_up_time + INTERVAL '7 days' AS signup_plus_7_days,
        sign_up_time + INTERVAL '30 days' AS signup_plus_30_days,
        sign_up_time + INTERVAL '90 days' AS signup_plus_90_days,
        sign_up_time + INTERVAL '180 days' AS signup_plus_180_days,
        sign_up_time + INTERVAL '365 days' AS signup_plus_365_days
    FROM "merchant_data"."public"."merchants"
),

-- Checking the output of merchant signup information
-- select * from merchant_signup
successful_transactions AS (
    -- Get successful transactions per merchant
    SELECT
        t.merchant_id,
        t.server_time_created_at,
        row_number() OVER (PARTITION BY t.merchant_id ORDER BY t.server_time_created_at) AS transaction_rank
    FROM "merchant_data"."public"."transactions" t
    WHERE t.tx_result = 11  -- Only successful transactions
),

first_successful_transaction AS (
    -- Get first successful transaction date for each merchant
    SELECT
        st.merchant_id,
        min(st.server_time_created_at) AS first_successful_transaction_date
    FROM successful_transactions st
    WHERE st.transaction_rank = 1
    GROUP BY st.merchant_id
),

-- Checking the output of the first successful transaction
-- select * from first_successful_transaction

successful_card_present_transactions AS (
    SELECT
        t.merchant_id,
        t.server_time_created_at,
        row_number() OVER (PARTITION BY t.merchant_id ORDER BY t.server_time_created_at) AS transaction_rank
    FROM "merchant_data"."public"."transactions" t
    JOIN "merchant_data"."public"."payment_types" pt
        ON t.payment_type_code = pt.code  -- Joining ON the payment type code
    WHERE t.tx_result = 11  -- Successful transaction (tx_result = 11)
      AND NOT pt.code IN (8,9,12,14)  -- Card-not-present transaction codes
),

first_card_present_transaction AS (
    -- Get first card-present transaction date for each merchant
    SELECT
        st.merchant_id,
        min(st.server_time_created_at) AS first_card_present_transaction_date
    FROM successful_card_present_transactions st
    WHERE st.transaction_rank = 1  -- Get the first card-present transaction
    GROUP BY st.merchant_id
),

-- Checking the output of the first card-present transaction
-- select * from first_card_present_transaction

fifth_successful_transaction AS (
    -- Get fifth successful transaction date for each merchant
    SELECT
        st.merchant_id,
        min(st.server_time_created_at) AS fifth_successful_transaction_date
    FROM successful_transactions st
    WHERE st.transaction_rank = 5
    GROUP BY st.merchant_id
),

-- Checking the output of the fifth successful transaction
-- select * from fifth_successful_transaction


last_successful_transaction AS (
    -- Get last successful transaction date for each merchant
    SELECT
        st.merchant_id,
        max(st.server_time_created_at) AS last_successful_transaction_date
    FROM successful_transactions st
    WHERE st.transaction_rank = 1
    GROUP BY st.merchant_id
),

-- Checking the output of the fifth successful transaction
-- select * from last_successful_transaction

all_time_successful_transactions AS (
    -- Get all time successful transaction for each merchant
   SELECT
        t.merchant_id,
        count(*) AS all_time_successful_transactions
    FROM "merchant_data"."public"."transactions" t
    WHERE t.tx_result = 11  -- Successful transaction (tx_result = 11)
    GROUP BY t.merchant_id
),

-- Checking the output of the all time successful transactions
-- select * from all_time_successful_transactions

all_time_failed_transactions AS (
    -- Get all time failed transaction for each merchant
   SELECT
        t.merchant_id,
        count(*) AS all_time_failed_transactions
    FROM "merchant_data"."public"."transactions" t
    WHERE t.tx_result != 11  -- failed transaction (tx_result != 11)
    GROUP BY t.merchant_id
),

-- Checking the output of the all time failed transactions
-- select * from all_time_failed_transactions

transactions_in_period AS (
    -- Join transactions WITH calculated periods, filtering by successful transactions within 365 days of signup
    SELECT
        m.merchant_id,
        t.amount,
        t.vat_amount,
        t.tip_amount,
        t.currency,
        CASE
            WHEN t.server_time_created_at >= m.sign_up_time 
                 AND t.server_time_created_at < m.signup_plus_7_days THEN '7_day'
            WHEN t.server_time_created_at >= m.sign_up_time
                 AND t.server_time_created_at < m.signup_plus_30_days THEN '30_day'
            WHEN t.server_time_created_at >= m.sign_up_time
                 AND t.server_time_created_at < m.signup_plus_90_days THEN '90_day'
            WHEN t.server_time_created_at >= m.sign_up_time
                 AND t.server_time_created_at < m.signup_plus_180_days THEN '180_day'
            WHEN t.server_time_created_at >= m.sign_up_time
                 AND t.server_time_created_at < m.signup_plus_365_days THEN '365_day'
        END AS PERIOD
    FROM merchant_signup m
    JOIN "merchant_data"."public"."transactions" t
        ON m.merchant_id = t.merchant_id
    WHERE t.tx_result = 11  -- Only successful transactions
      AND t.server_time_created_at < m.signup_plus_365_days
),

tpv_summary AS (
    SELECT
        merchant_id,
        sum(CASE WHEN PERIOD = '7_day' THEN amount + vat_amount + tip_amount ELSE 0 END) AS tpv_7_day,
        sum(CASE WHEN PERIOD IN ('7_day', '30_day') THEN amount + vat_amount + tip_amount ELSE 0 END) AS tpv_30_day,
        sum(CASE WHEN PERIOD IN ('7_day', '30_day', '90_day') THEN amount + vat_amount + tip_amount ELSE 0 END) AS tpv_90_day,
        sum(CASE WHEN PERIOD IN ('7_day', '30_day','90_day','180_day') THEN amount + vat_amount + tip_amount ELSE 0 END) AS tpv_180_day,
        sum(CASE WHEN PERIOD IN ('7_day', '30_day','90_day','180_day','365_day') THEN amount + vat_amount + tip_amount ELSE 0 END) AS tpv_365_day
    FROM transactions_in_period
    WHERE PERIOD IS NOT NULL
    GROUP BY merchant_id
)

-- Final selection combining all computed metrics

SELECT
    ms.merchant_id,
    ms.sign_up_time,
    fst.first_successful_transaction_date,
    fcpt.first_card_present_transaction_date,
    fifth.fifth_successful_transaction_date,
    lst.last_successful_transaction_date,
    atst.all_time_successful_transactions,
    atft.all_time_failed_transactions,
    tpv.tpv_7_day,
    tpv.tpv_30_day,
    tpv.tpv_90_day,
    tpv.tpv_180_day,
    tpv.tpv_365_day

FROM merchant_signup ms
LEFT JOIN first_successful_transaction fst ON ms.merchant_id = fst.merchant_id
LEFT JOIN first_card_present_transaction fcpt ON ms.merchant_id = fcpt.merchant_id
LEFT JOIN fifth_successful_transaction fifth ON ms.merchant_id = fifth.merchant_id
LEFT JOIN last_successful_transaction lst ON ms.merchant_id = lst.merchant_id
LEFT JOIN all_time_successful_transactions atst ON ms.merchant_id = atst.merchant_id
LEFT JOIN all_time_failed_transactions atft ON ms.merchant_id = atft.merchant_id
LEFT JOIN tpv_summary tpv ON ms.merchant_id = tpv.merchant_id

ORDER BY sign_up_time
  );
  
[0m22:13:05.765639 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.032 seconds
[0m22:13:05.770552 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.curated_merchant_data"
[0m22:13:05.770552 [debug] [Thread-1 (]: On model.merchant_data_project.curated_merchant_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.curated_merchant_data"} */
alter table "merchant_data"."public"."curated_merchant_data__dbt_tmp" rename to "curated_merchant_data"
[0m22:13:05.771552 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:13:05.784551 [debug] [Thread-1 (]: On model.merchant_data_project.curated_merchant_data: COMMIT
[0m22:13:05.785552 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.curated_merchant_data"
[0m22:13:05.785552 [debug] [Thread-1 (]: On model.merchant_data_project.curated_merchant_data: COMMIT
[0m22:13:05.787738 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m22:13:05.793745 [debug] [Thread-1 (]: Applying DROP to: "merchant_data"."public"."curated_merchant_data__dbt_backup"
[0m22:13:05.796825 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.curated_merchant_data"
[0m22:13:05.796825 [debug] [Thread-1 (]: On model.merchant_data_project.curated_merchant_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.curated_merchant_data"} */
drop table if exists "merchant_data"."public"."curated_merchant_data__dbt_backup" cascade
[0m22:13:05.797833 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m22:13:05.799828 [debug] [Thread-1 (]: On model.merchant_data_project.curated_merchant_data: Close
[0m22:13:05.800747 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c950d3be-d8fb-4f0a-a763-388fdb2a38e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0FBA2C830>]}
[0m22:13:05.800747 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.curated_merchant_data ................. [[32mSELECT 1000[0m in 0.14s]
[0m22:13:05.801745 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.curated_merchant_data
[0m22:13:05.803747 [debug] [MainThread]: Using postgres connection "master"
[0m22:13:05.803747 [debug] [MainThread]: On master: BEGIN
[0m22:13:05.803747 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:13:05.834756 [debug] [MainThread]: SQL status: BEGIN in 0.031 seconds
[0m22:13:05.835751 [debug] [MainThread]: On master: COMMIT
[0m22:13:05.835751 [debug] [MainThread]: Using postgres connection "master"
[0m22:13:05.835751 [debug] [MainThread]: On master: COMMIT
[0m22:13:05.836751 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:13:05.836751 [debug] [MainThread]: On master: Close
[0m22:13:05.837752 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:13:05.837752 [debug] [MainThread]: Connection 'list_merchant_data' was properly closed.
[0m22:13:05.837752 [debug] [MainThread]: Connection 'list_merchant_data_public' was properly closed.
[0m22:13:05.837752 [debug] [MainThread]: Connection 'model.merchant_data_project.curated_merchant_data' was properly closed.
[0m22:13:05.839255 [info ] [MainThread]: 
[0m22:13:05.839255 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m22:13:05.840665 [debug] [MainThread]: Command end result
[0m22:13:05.866190 [info ] [MainThread]: 
[0m22:13:05.867189 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:13:05.867189 [info ] [MainThread]: 
[0m22:13:05.868189 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:13:05.869292 [debug] [MainThread]: Command `dbt run` succeeded at 22:13:05.869292 after 2.66 seconds
[0m22:13:05.869292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0FEDC6F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0FEC47FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0FD3EB560>]}
[0m22:13:05.869292 [debug] [MainThread]: Flushing usage events
[0m22:21:03.224238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177E0D416A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177E4633650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177E50A4D40>]}


============================== 22:21:03.228264 | 2497977b-c72f-4c63-bd48-0494758d30e3 ==============================
[0m22:21:03.228264 [info ] [MainThread]: Running with dbt=1.8.8
[0m22:21:03.228264 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alvaro\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\alvaro\\Desktop\\sumup_assignment\\merchant_data_project\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select curated_merchant_data', 'send_anonymous_usage_stats': 'True'}
[0m22:21:03.409793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2497977b-c72f-4c63-bd48-0494758d30e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177E3710800>]}
[0m22:21:03.455595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2497977b-c72f-4c63-bd48-0494758d30e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177E51C6DE0>]}
[0m22:21:03.456663 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:21:03.463595 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m22:21:03.548104 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m22:21:03.549294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2497977b-c72f-4c63-bd48-0494758d30e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177E43D4140>]}
[0m22:21:04.401024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2497977b-c72f-4c63-bd48-0494758d30e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177E55AC5F0>]}
[0m22:21:04.476820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2497977b-c72f-4c63-bd48-0494758d30e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177E5AFEAB0>]}
[0m22:21:04.476820 [info ] [MainThread]: Found 11 models, 11 sources, 423 macros
[0m22:21:04.477822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2497977b-c72f-4c63-bd48-0494758d30e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177E5A4F0B0>]}
[0m22:21:04.478904 [info ] [MainThread]: 
[0m22:21:04.479910 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:21:04.480862 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merchant_data'
[0m22:21:04.568583 [debug] [ThreadPool]: Using postgres connection "list_merchant_data"
[0m22:21:04.569583 [debug] [ThreadPool]: On list_merchant_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "list_merchant_data"} */

    select distinct nspname from pg_namespace
  
[0m22:21:04.569583 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:21:04.607579 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.038 seconds
[0m22:21:04.608659 [debug] [ThreadPool]: On list_merchant_data: Close
[0m22:21:04.612580 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merchant_data_public'
[0m22:21:04.618578 [debug] [ThreadPool]: Using postgres connection "list_merchant_data_public"
[0m22:21:04.618578 [debug] [ThreadPool]: On list_merchant_data_public: BEGIN
[0m22:21:04.618578 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:21:04.654680 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m22:21:04.654680 [debug] [ThreadPool]: Using postgres connection "list_merchant_data_public"
[0m22:21:04.654680 [debug] [ThreadPool]: On list_merchant_data_public: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "list_merchant_data_public"} */
select
      'merchant_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'merchant_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'merchant_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:21:04.661685 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.006 seconds
[0m22:21:04.662761 [debug] [ThreadPool]: On list_merchant_data_public: ROLLBACK
[0m22:21:04.662761 [debug] [ThreadPool]: On list_merchant_data_public: Close
[0m22:21:04.668777 [debug] [MainThread]: Using postgres connection "master"
[0m22:21:04.668777 [debug] [MainThread]: On master: BEGIN
[0m22:21:04.668777 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:21:04.700104 [debug] [MainThread]: SQL status: BEGIN in 0.032 seconds
[0m22:21:04.701101 [debug] [MainThread]: Using postgres connection "master"
[0m22:21:04.701101 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:21:04.709120 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m22:21:04.710118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2497977b-c72f-4c63-bd48-0494758d30e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177E5AFD850>]}
[0m22:21:04.710118 [debug] [MainThread]: On master: ROLLBACK
[0m22:21:04.710118 [debug] [MainThread]: Using postgres connection "master"
[0m22:21:04.711119 [debug] [MainThread]: On master: BEGIN
[0m22:21:04.711119 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:21:04.711119 [debug] [MainThread]: On master: COMMIT
[0m22:21:04.712118 [debug] [MainThread]: Using postgres connection "master"
[0m22:21:04.712118 [debug] [MainThread]: On master: COMMIT
[0m22:21:04.712118 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:21:04.712118 [debug] [MainThread]: On master: Close
[0m22:21:04.713118 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:21:04.713118 [info ] [MainThread]: 
[0m22:21:04.717119 [debug] [Thread-1 (]: Began running node model.merchant_data_project.curated_merchant_data
[0m22:21:04.718218 [info ] [Thread-1 (]: 1 of 1 START sql table model public.curated_merchant_data ...................... [RUN]
[0m22:21:04.719122 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.merchant_data_project.curated_merchant_data'
[0m22:21:04.719122 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.curated_merchant_data
[0m22:21:04.726254 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.curated_merchant_data"
[0m22:21:04.727338 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.curated_merchant_data
[0m22:21:04.759658 [debug] [Thread-1 (]: Writing runtime sql for node "model.merchant_data_project.curated_merchant_data"
[0m22:21:04.760734 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.curated_merchant_data"
[0m22:21:04.761658 [debug] [Thread-1 (]: On model.merchant_data_project.curated_merchant_data: BEGIN
[0m22:21:04.761658 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:21:04.906933 [debug] [Thread-1 (]: SQL status: BEGIN in 0.145 seconds
[0m22:21:04.907988 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.curated_merchant_data"
[0m22:21:04.907988 [debug] [Thread-1 (]: On model.merchant_data_project.curated_merchant_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.curated_merchant_data"} */

  
    

  create  table "merchant_data"."public"."curated_merchant_data__dbt_tmp"
  
  
    as
  
  (
    WITH merchant_signup AS (
    -- Define the 7, 30, 90, 180, 365 day periods after signup for each merchant
    SELECT
        merchant_id,
        sign_up_time,
        sign_up_time + INTERVAL '7 days' AS signup_plus_7_days,
        sign_up_time + INTERVAL '30 days' AS signup_plus_30_days,
        sign_up_time + INTERVAL '90 days' AS signup_plus_90_days,
        sign_up_time + INTERVAL '180 days' AS signup_plus_180_days,
        sign_up_time + INTERVAL '365 days' AS signup_plus_365_days
    FROM "merchant_data"."public"."merchants"
),

-- Checking the output of merchant signup information
-- select * from merchant_signup
successful_transactions AS (
    -- Get successful transactions per merchant
    SELECT
        t.merchant_id,
        t.server_time_created_at,
        row_number() OVER (PARTITION BY t.merchant_id ORDER BY t.server_time_created_at) AS transaction_rank
    FROM "merchant_data"."public"."transactions" t
    WHERE t.tx_result = 11  -- Only successful transactions
),

first_successful_transaction AS (
    -- Get first successful transaction date for each merchant
    SELECT
        st.merchant_id,
        min(st.server_time_created_at) AS first_successful_transaction_date
    FROM successful_transactions st
    WHERE st.transaction_rank = 1
    GROUP BY st.merchant_id
),

-- Checking the output of the first successful transaction
-- select * from first_successful_transaction

successful_card_present_transactions AS (
    SELECT
        t.merchant_id,
        t.server_time_created_at,
        row_number() OVER (PARTITION BY t.merchant_id ORDER BY t.server_time_created_at) AS transaction_rank
    FROM "merchant_data"."public"."transactions" t
    JOIN "merchant_data"."public"."payment_types" pt
        ON t.payment_type_code = pt.code  -- Joining ON the payment type code
    WHERE t.tx_result = 11  -- Successful transaction (tx_result = 11)
      AND NOT pt.code IN (8,9,12,14)  -- Card-not-present transaction codes
),

first_card_present_transaction AS (
    -- Get first card-present transaction date for each merchant
    SELECT
        st.merchant_id,
        min(st.server_time_created_at) AS first_card_present_transaction_date
    FROM successful_card_present_transactions st
    WHERE st.transaction_rank = 1  -- Get the first card-present transaction
    GROUP BY st.merchant_id
),

-- Checking the output of the first card-present transaction
-- select * from first_card_present_transaction

fifth_successful_transaction AS (
    -- Get fifth successful transaction date for each merchant
    SELECT
        st.merchant_id,
        min(st.server_time_created_at) AS fifth_successful_transaction_date
    FROM successful_transactions st
    WHERE st.transaction_rank = 5
    GROUP BY st.merchant_id
),

-- Checking the output of the fifth successful transaction
-- select * from fifth_successful_transaction


last_successful_transaction AS (
    -- Get last successful transaction date for each merchant
    SELECT
        st.merchant_id,
        max(st.server_time_created_at) AS last_successful_transaction_date
    FROM successful_transactions st
    WHERE st.transaction_rank = 1
    GROUP BY st.merchant_id
),

-- Checking the output of the fifth successful transaction
-- select * from last_successful_transaction

all_time_successful_transactions AS (
    -- Get all time successful transaction for each merchant
   SELECT
        t.merchant_id,
        count(*) AS all_time_successful_transactions
    FROM "merchant_data"."public"."transactions" t
    WHERE t.tx_result = 11  -- Successful transaction (tx_result = 11)
    GROUP BY t.merchant_id
),

-- Checking the output of the all time successful transactions
-- select * from all_time_successful_transactions

all_time_failed_transactions AS (
    -- Get all time failed transaction for each merchant
   SELECT
        t.merchant_id,
        count(*) AS all_time_failed_transactions
    FROM "merchant_data"."public"."transactions" t
    WHERE t.tx_result != 11  -- failed transaction (tx_result != 11)
    GROUP BY t.merchant_id
),

-- Checking the output of the all time failed transactions
-- select * from all_time_failed_transactions

transactions_in_period AS (
    -- Join transactions WITH calculated periods, filtering by successful transactions within 365 days of signup
    SELECT
        m.merchant_id,
        t.amount,
        t.vat_amount,
        t.tip_amount,
        t.currency,
        CASE
            WHEN t.server_time_created_at >= m.sign_up_time 
                 AND t.server_time_created_at < m.signup_plus_7_days THEN '7_day'
            WHEN t.server_time_created_at >= m.sign_up_time
                 AND t.server_time_created_at < m.signup_plus_30_days THEN '30_day'
            WHEN t.server_time_created_at >= m.sign_up_time
                 AND t.server_time_created_at < m.signup_plus_90_days THEN '90_day'
            WHEN t.server_time_created_at >= m.sign_up_time
                 AND t.server_time_created_at < m.signup_plus_180_days THEN '180_day'
            WHEN t.server_time_created_at >= m.sign_up_time
                 AND t.server_time_created_at < m.signup_plus_365_days THEN '365_day'
        END AS PERIOD
    FROM merchant_signup m
    JOIN "merchant_data"."public"."transactions" t
        ON m.merchant_id = t.merchant_id
    WHERE t.tx_result = 11  -- Only successful transactions
      AND t.server_time_created_at < m.signup_plus_365_days
),

tpv_summary AS (
    SELECT
        merchant_id,
        sum(CASE WHEN PERIOD = '7_day' THEN amount + vat_amount + tip_amount ELSE 0 END) AS tpv_7_day,
        sum(CASE WHEN PERIOD IN ('7_day', '30_day') THEN amount + vat_amount + tip_amount ELSE 0 END) AS tpv_30_day,
        sum(CASE WHEN PERIOD IN ('7_day', '30_day', '90_day') THEN amount + vat_amount + tip_amount ELSE 0 END) AS tpv_90_day,
        sum(CASE WHEN PERIOD IN ('7_day', '30_day','90_day','180_day') THEN amount + vat_amount + tip_amount ELSE 0 END) AS tpv_180_day,
        sum(CASE WHEN PERIOD IN ('7_day', '30_day','90_day','180_day','365_day') THEN amount + vat_amount + tip_amount ELSE 0 END) AS tpv_365_day
    FROM transactions_in_period
    WHERE PERIOD IS NOT NULL
    GROUP BY merchant_id
)

-- Final selection combining all computed metrics

SELECT
    ms.merchant_id,
    ms.sign_up_time,
    fst.first_successful_transaction_date,
    fcpt.first_card_present_transaction_date,
    fifth.fifth_successful_transaction_date,
    lst.last_successful_transaction_date,
    atst.all_time_successful_transactions,
    atft.all_time_failed_transactions,
    tpv.tpv_7_day,
    tpv.tpv_30_day,
    tpv.tpv_90_day,
    tpv.tpv_180_day,
    tpv.tpv_365_day

FROM merchant_signup ms
LEFT JOIN first_successful_transaction fst ON ms.merchant_id = fst.merchant_id
LEFT JOIN first_card_present_transaction fcpt ON ms.merchant_id = fcpt.merchant_id
LEFT JOIN fifth_successful_transaction fifth ON ms.merchant_id = fifth.merchant_id
LEFT JOIN last_successful_transaction lst ON ms.merchant_id = lst.merchant_id
LEFT JOIN all_time_successful_transactions atst ON ms.merchant_id = atst.merchant_id
LEFT JOIN all_time_failed_transactions atft ON ms.merchant_id = atft.merchant_id
LEFT JOIN tpv_summary tpv ON ms.merchant_id = tpv.merchant_id

ORDER BY merchant_id;
  );
  
[0m22:21:04.909021 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 194: ORDER BY merchant_id;
                              ^

[0m22:21:04.909941 [debug] [Thread-1 (]: On model.merchant_data_project.curated_merchant_data: ROLLBACK
[0m22:21:04.909941 [debug] [Thread-1 (]: On model.merchant_data_project.curated_merchant_data: Close
[0m22:21:04.986200 [debug] [Thread-1 (]: Database Error in model curated_merchant_data (models\curated\curated_merchant_data.sql)
  syntax error at or near ";"
  LINE 194: ORDER BY merchant_id;
                                ^
  compiled code at target\run\merchant_data_project\models\curated\curated_merchant_data.sql
[0m22:21:04.987169 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2497977b-c72f-4c63-bd48-0494758d30e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177E54FAD50>]}
[0m22:21:04.988168 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.curated_merchant_data ............. [[31mERROR[0m in 0.27s]
[0m22:21:04.989168 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.curated_merchant_data
[0m22:21:04.991172 [debug] [MainThread]: Using postgres connection "master"
[0m22:21:04.991172 [debug] [MainThread]: On master: BEGIN
[0m22:21:04.991172 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:21:05.024689 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m22:21:05.024689 [debug] [MainThread]: On master: COMMIT
[0m22:21:05.025706 [debug] [MainThread]: Using postgres connection "master"
[0m22:21:05.025706 [debug] [MainThread]: On master: COMMIT
[0m22:21:05.025706 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:21:05.026722 [debug] [MainThread]: On master: Close
[0m22:21:05.026722 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:21:05.026722 [debug] [MainThread]: Connection 'list_merchant_data' was properly closed.
[0m22:21:05.026722 [debug] [MainThread]: Connection 'list_merchant_data_public' was properly closed.
[0m22:21:05.027694 [debug] [MainThread]: Connection 'model.merchant_data_project.curated_merchant_data' was properly closed.
[0m22:21:05.027694 [info ] [MainThread]: 
[0m22:21:05.028694 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m22:21:05.028694 [debug] [MainThread]: Command end result
[0m22:21:05.055213 [info ] [MainThread]: 
[0m22:21:05.056210 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:21:05.057214 [info ] [MainThread]: 
[0m22:21:05.058208 [error] [MainThread]:   Database Error in model curated_merchant_data (models\curated\curated_merchant_data.sql)
  syntax error at or near ";"
  LINE 194: ORDER BY merchant_id;
                                ^
  compiled code at target\run\merchant_data_project\models\curated\curated_merchant_data.sql
[0m22:21:05.059321 [info ] [MainThread]: 
[0m22:21:05.060238 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m22:21:05.062298 [debug] [MainThread]: Command `dbt run` failed at 22:21:05.062298 after 1.93 seconds
[0m22:21:05.062298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177E5D0EF30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177E5C12720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177E0D416A0>]}
[0m22:21:05.062298 [debug] [MainThread]: Flushing usage events
[0m22:21:22.281138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001383E3223C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001383E3206B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001383915BCB0>]}


============================== 22:21:22.285189 | 23ee4971-da37-44fc-b2f0-9dfe957bf939 ==============================
[0m22:21:22.285189 [info ] [MainThread]: Running with dbt=1.8.8
[0m22:21:22.285189 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\alvaro\\.dbt', 'log_path': 'C:\\Users\\alvaro\\Desktop\\sumup_assignment\\merchant_data_project\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select curated_merchant_data', 'send_anonymous_usage_stats': 'True'}
[0m22:21:22.438063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '23ee4971-da37-44fc-b2f0-9dfe957bf939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001383E4ECB60>]}
[0m22:21:22.480368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '23ee4971-da37-44fc-b2f0-9dfe957bf939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001383E572450>]}
[0m22:21:22.481396 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:21:22.487281 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m22:21:22.551383 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m22:21:22.552281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '23ee4971-da37-44fc-b2f0-9dfe957bf939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001383E816030>]}
[0m22:21:23.440196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '23ee4971-da37-44fc-b2f0-9dfe957bf939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001383EEDE570>]}
[0m22:21:23.511790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '23ee4971-da37-44fc-b2f0-9dfe957bf939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001383F098920>]}
[0m22:21:23.512789 [info ] [MainThread]: Found 11 models, 11 sources, 423 macros
[0m22:21:23.513791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23ee4971-da37-44fc-b2f0-9dfe957bf939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001383E4D25D0>]}
[0m22:21:23.514791 [info ] [MainThread]: 
[0m22:21:23.515797 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:21:23.516808 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merchant_data'
[0m22:21:23.604360 [debug] [ThreadPool]: Using postgres connection "list_merchant_data"
[0m22:21:23.604360 [debug] [ThreadPool]: On list_merchant_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "list_merchant_data"} */

    select distinct nspname from pg_namespace
  
[0m22:21:23.605471 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:21:23.643735 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.038 seconds
[0m22:21:23.644734 [debug] [ThreadPool]: On list_merchant_data: Close
[0m22:21:23.650815 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merchant_data_public'
[0m22:21:23.655737 [debug] [ThreadPool]: Using postgres connection "list_merchant_data_public"
[0m22:21:23.655737 [debug] [ThreadPool]: On list_merchant_data_public: BEGIN
[0m22:21:23.655737 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:21:23.688167 [debug] [ThreadPool]: SQL status: BEGIN in 0.033 seconds
[0m22:21:23.689210 [debug] [ThreadPool]: Using postgres connection "list_merchant_data_public"
[0m22:21:23.689210 [debug] [ThreadPool]: On list_merchant_data_public: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "list_merchant_data_public"} */
select
      'merchant_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'merchant_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'merchant_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:21:23.695336 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.006 seconds
[0m22:21:23.696399 [debug] [ThreadPool]: On list_merchant_data_public: ROLLBACK
[0m22:21:23.697407 [debug] [ThreadPool]: On list_merchant_data_public: Close
[0m22:21:23.702380 [debug] [MainThread]: Using postgres connection "master"
[0m22:21:23.702380 [debug] [MainThread]: On master: BEGIN
[0m22:21:23.702380 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:21:23.734461 [debug] [MainThread]: SQL status: BEGIN in 0.031 seconds
[0m22:21:23.734461 [debug] [MainThread]: Using postgres connection "master"
[0m22:21:23.734461 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:21:23.742476 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m22:21:23.743567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23ee4971-da37-44fc-b2f0-9dfe957bf939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001383E9E01A0>]}
[0m22:21:23.743567 [debug] [MainThread]: On master: ROLLBACK
[0m22:21:23.744475 [debug] [MainThread]: Using postgres connection "master"
[0m22:21:23.744475 [debug] [MainThread]: On master: BEGIN
[0m22:21:23.745479 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:21:23.745479 [debug] [MainThread]: On master: COMMIT
[0m22:21:23.745479 [debug] [MainThread]: Using postgres connection "master"
[0m22:21:23.745479 [debug] [MainThread]: On master: COMMIT
[0m22:21:23.746667 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:21:23.746667 [debug] [MainThread]: On master: Close
[0m22:21:23.746667 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:21:23.747676 [info ] [MainThread]: 
[0m22:21:23.750997 [debug] [Thread-1 (]: Began running node model.merchant_data_project.curated_merchant_data
[0m22:21:23.752079 [info ] [Thread-1 (]: 1 of 1 START sql table model public.curated_merchant_data ...................... [RUN]
[0m22:21:23.752969 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.merchant_data_project.curated_merchant_data'
[0m22:21:23.752969 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.curated_merchant_data
[0m22:21:23.760993 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.curated_merchant_data"
[0m22:21:23.761992 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.curated_merchant_data
[0m22:21:23.792672 [debug] [Thread-1 (]: Writing runtime sql for node "model.merchant_data_project.curated_merchant_data"
[0m22:21:23.794667 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.curated_merchant_data"
[0m22:21:23.795670 [debug] [Thread-1 (]: On model.merchant_data_project.curated_merchant_data: BEGIN
[0m22:21:23.795670 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:21:23.937023 [debug] [Thread-1 (]: SQL status: BEGIN in 0.141 seconds
[0m22:21:23.937023 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.curated_merchant_data"
[0m22:21:23.938114 [debug] [Thread-1 (]: On model.merchant_data_project.curated_merchant_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.curated_merchant_data"} */

  
    

  create  table "merchant_data"."public"."curated_merchant_data__dbt_tmp"
  
  
    as
  
  (
    WITH merchant_signup AS (
    -- Define the 7, 30, 90, 180, 365 day periods after signup for each merchant
    SELECT
        merchant_id,
        sign_up_time,
        sign_up_time + INTERVAL '7 days' AS signup_plus_7_days,
        sign_up_time + INTERVAL '30 days' AS signup_plus_30_days,
        sign_up_time + INTERVAL '90 days' AS signup_plus_90_days,
        sign_up_time + INTERVAL '180 days' AS signup_plus_180_days,
        sign_up_time + INTERVAL '365 days' AS signup_plus_365_days
    FROM "merchant_data"."public"."merchants"
),

-- Checking the output of merchant signup information
-- select * from merchant_signup
successful_transactions AS (
    -- Get successful transactions per merchant
    SELECT
        t.merchant_id,
        t.server_time_created_at,
        row_number() OVER (PARTITION BY t.merchant_id ORDER BY t.server_time_created_at) AS transaction_rank
    FROM "merchant_data"."public"."transactions" t
    WHERE t.tx_result = 11  -- Only successful transactions
),

first_successful_transaction AS (
    -- Get first successful transaction date for each merchant
    SELECT
        st.merchant_id,
        min(st.server_time_created_at) AS first_successful_transaction_date
    FROM successful_transactions st
    WHERE st.transaction_rank = 1
    GROUP BY st.merchant_id
),

-- Checking the output of the first successful transaction
-- select * from first_successful_transaction

successful_card_present_transactions AS (
    SELECT
        t.merchant_id,
        t.server_time_created_at,
        row_number() OVER (PARTITION BY t.merchant_id ORDER BY t.server_time_created_at) AS transaction_rank
    FROM "merchant_data"."public"."transactions" t
    JOIN "merchant_data"."public"."payment_types" pt
        ON t.payment_type_code = pt.code  -- Joining ON the payment type code
    WHERE t.tx_result = 11  -- Successful transaction (tx_result = 11)
      AND NOT pt.code IN (8,9,12,14)  -- Card-not-present transaction codes
),

first_card_present_transaction AS (
    -- Get first card-present transaction date for each merchant
    SELECT
        st.merchant_id,
        min(st.server_time_created_at) AS first_card_present_transaction_date
    FROM successful_card_present_transactions st
    WHERE st.transaction_rank = 1  -- Get the first card-present transaction
    GROUP BY st.merchant_id
),

-- Checking the output of the first card-present transaction
-- select * from first_card_present_transaction

fifth_successful_transaction AS (
    -- Get fifth successful transaction date for each merchant
    SELECT
        st.merchant_id,
        min(st.server_time_created_at) AS fifth_successful_transaction_date
    FROM successful_transactions st
    WHERE st.transaction_rank = 5
    GROUP BY st.merchant_id
),

-- Checking the output of the fifth successful transaction
-- select * from fifth_successful_transaction


last_successful_transaction AS (
    -- Get last successful transaction date for each merchant
    SELECT
        st.merchant_id,
        max(st.server_time_created_at) AS last_successful_transaction_date
    FROM successful_transactions st
    WHERE st.transaction_rank = 1
    GROUP BY st.merchant_id
),

-- Checking the output of the fifth successful transaction
-- select * from last_successful_transaction

all_time_successful_transactions AS (
    -- Get all time successful transaction for each merchant
   SELECT
        t.merchant_id,
        count(*) AS all_time_successful_transactions
    FROM "merchant_data"."public"."transactions" t
    WHERE t.tx_result = 11  -- Successful transaction (tx_result = 11)
    GROUP BY t.merchant_id
),

-- Checking the output of the all time successful transactions
-- select * from all_time_successful_transactions

all_time_failed_transactions AS (
    -- Get all time failed transaction for each merchant
   SELECT
        t.merchant_id,
        count(*) AS all_time_failed_transactions
    FROM "merchant_data"."public"."transactions" t
    WHERE t.tx_result != 11  -- failed transaction (tx_result != 11)
    GROUP BY t.merchant_id
),

-- Checking the output of the all time failed transactions
-- select * from all_time_failed_transactions

transactions_in_period AS (
    -- Join transactions WITH calculated periods, filtering by successful transactions within 365 days of signup
    SELECT
        m.merchant_id,
        t.amount,
        t.vat_amount,
        t.tip_amount,
        t.currency,
        CASE
            WHEN t.server_time_created_at >= m.sign_up_time 
                 AND t.server_time_created_at < m.signup_plus_7_days THEN '7_day'
            WHEN t.server_time_created_at >= m.sign_up_time
                 AND t.server_time_created_at < m.signup_plus_30_days THEN '30_day'
            WHEN t.server_time_created_at >= m.sign_up_time
                 AND t.server_time_created_at < m.signup_plus_90_days THEN '90_day'
            WHEN t.server_time_created_at >= m.sign_up_time
                 AND t.server_time_created_at < m.signup_plus_180_days THEN '180_day'
            WHEN t.server_time_created_at >= m.sign_up_time
                 AND t.server_time_created_at < m.signup_plus_365_days THEN '365_day'
        END AS PERIOD
    FROM merchant_signup m
    JOIN "merchant_data"."public"."transactions" t
        ON m.merchant_id = t.merchant_id
    WHERE t.tx_result = 11  -- Only successful transactions
      AND t.server_time_created_at < m.signup_plus_365_days
),

tpv_summary AS (
    SELECT
        merchant_id,
        sum(CASE WHEN PERIOD = '7_day' THEN amount + vat_amount + tip_amount ELSE 0 END) AS tpv_7_day,
        sum(CASE WHEN PERIOD IN ('7_day', '30_day') THEN amount + vat_amount + tip_amount ELSE 0 END) AS tpv_30_day,
        sum(CASE WHEN PERIOD IN ('7_day', '30_day', '90_day') THEN amount + vat_amount + tip_amount ELSE 0 END) AS tpv_90_day,
        sum(CASE WHEN PERIOD IN ('7_day', '30_day','90_day','180_day') THEN amount + vat_amount + tip_amount ELSE 0 END) AS tpv_180_day,
        sum(CASE WHEN PERIOD IN ('7_day', '30_day','90_day','180_day','365_day') THEN amount + vat_amount + tip_amount ELSE 0 END) AS tpv_365_day
    FROM transactions_in_period
    WHERE PERIOD IS NOT NULL
    GROUP BY merchant_id
)

-- Final selection combining all computed metrics

SELECT
    ms.merchant_id,
    ms.sign_up_time,
    fst.first_successful_transaction_date,
    fcpt.first_card_present_transaction_date,
    fifth.fifth_successful_transaction_date,
    lst.last_successful_transaction_date,
    atst.all_time_successful_transactions,
    atft.all_time_failed_transactions,
    tpv.tpv_7_day,
    tpv.tpv_30_day,
    tpv.tpv_90_day,
    tpv.tpv_180_day,
    tpv.tpv_365_day

FROM merchant_signup ms
LEFT JOIN first_successful_transaction fst ON ms.merchant_id = fst.merchant_id
LEFT JOIN first_card_present_transaction fcpt ON ms.merchant_id = fcpt.merchant_id
LEFT JOIN fifth_successful_transaction fifth ON ms.merchant_id = fifth.merchant_id
LEFT JOIN last_successful_transaction lst ON ms.merchant_id = lst.merchant_id
LEFT JOIN all_time_successful_transactions atst ON ms.merchant_id = atst.merchant_id
LEFT JOIN all_time_failed_transactions atft ON ms.merchant_id = atft.merchant_id
LEFT JOIN tpv_summary tpv ON ms.merchant_id = tpv.merchant_id

ORDER BY merchant_id
  );
  
[0m22:21:23.968032 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.030 seconds
[0m22:21:23.973113 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.curated_merchant_data"
[0m22:21:23.973113 [debug] [Thread-1 (]: On model.merchant_data_project.curated_merchant_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.curated_merchant_data"} */
alter table "merchant_data"."public"."curated_merchant_data__dbt_tmp" rename to "curated_merchant_data"
[0m22:21:23.973113 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:21:23.986718 [debug] [Thread-1 (]: On model.merchant_data_project.curated_merchant_data: COMMIT
[0m22:21:23.986718 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.curated_merchant_data"
[0m22:21:23.987797 [debug] [Thread-1 (]: On model.merchant_data_project.curated_merchant_data: COMMIT
[0m22:21:23.993220 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m22:21:23.999232 [debug] [Thread-1 (]: Applying DROP to: "merchant_data"."public"."curated_merchant_data__dbt_backup"
[0m22:21:24.003226 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.curated_merchant_data"
[0m22:21:24.003226 [debug] [Thread-1 (]: On model.merchant_data_project.curated_merchant_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.curated_merchant_data"} */
drop table if exists "merchant_data"."public"."curated_merchant_data__dbt_backup" cascade
[0m22:21:24.004226 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m22:21:24.006226 [debug] [Thread-1 (]: On model.merchant_data_project.curated_merchant_data: Close
[0m22:21:24.007226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23ee4971-da37-44fc-b2f0-9dfe957bf939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001383D7D1490>]}
[0m22:21:24.008226 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.curated_merchant_data ................. [[32mSELECT 1000[0m in 0.25s]
[0m22:21:24.009233 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.curated_merchant_data
[0m22:21:24.011228 [debug] [MainThread]: Using postgres connection "master"
[0m22:21:24.011228 [debug] [MainThread]: On master: BEGIN
[0m22:21:24.011228 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:21:24.048678 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m22:21:24.048678 [debug] [MainThread]: On master: COMMIT
[0m22:21:24.048678 [debug] [MainThread]: Using postgres connection "master"
[0m22:21:24.049636 [debug] [MainThread]: On master: COMMIT
[0m22:21:24.049636 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:21:24.049636 [debug] [MainThread]: On master: Close
[0m22:21:24.050636 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:21:24.050636 [debug] [MainThread]: Connection 'list_merchant_data' was properly closed.
[0m22:21:24.050636 [debug] [MainThread]: Connection 'list_merchant_data_public' was properly closed.
[0m22:21:24.051643 [debug] [MainThread]: Connection 'model.merchant_data_project.curated_merchant_data' was properly closed.
[0m22:21:24.051643 [info ] [MainThread]: 
[0m22:21:24.052638 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m22:21:24.053724 [debug] [MainThread]: Command end result
[0m22:21:24.083644 [info ] [MainThread]: 
[0m22:21:24.084642 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:21:24.085639 [info ] [MainThread]: 
[0m22:21:24.086638 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:21:24.088639 [debug] [MainThread]: Command `dbt run` succeeded at 22:21:24.087640 after 1.90 seconds
[0m22:21:24.088639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001383EF32D20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001383E07BDA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001383E07BA70>]}
[0m22:21:24.089638 [debug] [MainThread]: Flushing usage events
[0m01:19:02.387230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001713DEB0C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001713DEB1E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001713B70BCB0>]}


============================== 01:19:02.391248 | 6bc14199-854e-4362-83f6-01bb24fbe249 ==============================
[0m01:19:02.391248 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:19:02.392230 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alvaro\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\alvaro\\Desktop\\sumup_assignment\\merchant_data_project\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:19:02.403315 [info ] [MainThread]: dbt version: 1.8.8
[0m01:19:02.403315 [info ] [MainThread]: python version: 3.12.7
[0m01:19:02.404233 [info ] [MainThread]: python path: C:\Users\alvaro\Desktop\sumup_assignment\dbt-sumup\Scripts\python.exe
[0m01:19:02.404233 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m01:19:02.483997 [info ] [MainThread]: Using profiles dir at C:\Users\alvaro\.dbt
[0m01:19:02.484998 [info ] [MainThread]: Using profiles.yml file at C:\Users\alvaro\.dbt\profiles.yml
[0m01:19:02.485995 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\alvaro\Desktop\sumup_assignment\merchant_data_project\dbt_project.yml
[0m01:19:02.486997 [info ] [MainThread]: adapter type: postgres
[0m01:19:02.486997 [info ] [MainThread]: adapter version: 1.8.2
[0m01:19:02.552908 [info ] [MainThread]: Configuration:
[0m01:19:02.553849 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m01:19:02.554827 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m01:19:02.555773 [info ] [MainThread]: Required dependencies:
[0m01:19:02.555773 [debug] [MainThread]: Executing "git --help"
[0m01:19:02.584787 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:19:02.584787 [debug] [MainThread]: STDERR: "b''"
[0m01:19:02.585860 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m01:19:02.586772 [info ] [MainThread]: Connection:
[0m01:19:02.586772 [info ] [MainThread]:   host: localhost
[0m01:19:02.587771 [info ] [MainThread]:   port: 5432
[0m01:19:02.587771 [info ] [MainThread]:   user: postgres
[0m01:19:02.588774 [info ] [MainThread]:   database: merchant_data
[0m01:19:02.589774 [info ] [MainThread]:   schema: public
[0m01:19:02.589774 [info ] [MainThread]:   connect_timeout: 10
[0m01:19:02.590773 [info ] [MainThread]:   role: None
[0m01:19:02.590773 [info ] [MainThread]:   search_path: None
[0m01:19:02.590773 [info ] [MainThread]:   keepalives_idle: 0
[0m01:19:02.591772 [info ] [MainThread]:   sslmode: None
[0m01:19:02.591772 [info ] [MainThread]:   sslcert: None
[0m01:19:02.591772 [info ] [MainThread]:   sslkey: None
[0m01:19:02.592770 [info ] [MainThread]:   sslrootcert: None
[0m01:19:02.592770 [info ] [MainThread]:   application_name: dbt
[0m01:19:02.593771 [info ] [MainThread]:   retries: 1
[0m01:19:02.593771 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m01:19:02.594771 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m01:19:02.637597 [debug] [MainThread]: Using postgres connection "debug"
[0m01:19:02.637597 [debug] [MainThread]: On debug: select 1 as id
[0m01:19:02.638679 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:19:02.674124 [debug] [MainThread]: SQL status: SELECT 1 in 0.036 seconds
[0m01:19:02.675131 [debug] [MainThread]: On debug: Close
[0m01:19:02.675131 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m01:19:02.676132 [info ] [MainThread]: [32mAll checks passed![0m
[0m01:19:02.677132 [debug] [MainThread]: Command `dbt debug` succeeded at 01:19:02.677132 after 0.39 seconds
[0m01:19:02.677132 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m01:19:02.678224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001713DEEAF30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171406F3FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001713FD2E030>]}
[0m01:19:02.678224 [debug] [MainThread]: Flushing usage events
[0m02:18:55.321624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D187669AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D18766BB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D187EEC7A0>]}


============================== 02:18:55.325152 | 1ca95d93-e190-4f4c-a486-8b993c95c48f ==============================
[0m02:18:55.325152 [info ] [MainThread]: Running with dbt=1.8.8
[0m02:18:55.326158 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\alvaro\\Desktop\\sumup_assignment\\merchant_data_project\\logs', 'profiles_dir': 'C:\\Users\\alvaro\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select curated_merchant_data', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:18:55.480690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ca95d93-e190-4f4c-a486-8b993c95c48f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D184D2D640>]}
[0m02:18:55.521446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ca95d93-e190-4f4c-a486-8b993c95c48f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1875F7BF0>]}
[0m02:18:55.522447 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m02:18:55.543601 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m02:18:55.604739 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m02:18:55.605325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1ca95d93-e190-4f4c-a486-8b993c95c48f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D188AFF0E0>]}
[0m02:18:57.031974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': '1ca95d93-e190-4f4c-a486-8b993c95c48f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D188BDC590>]}
[0m02:18:57.264951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ca95d93-e190-4f4c-a486-8b993c95c48f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D188AB7EC0>]}
[0m02:18:57.427493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ca95d93-e190-4f4c-a486-8b993c95c48f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D183468FB0>]}
[0m02:18:57.428493 [info ] [MainThread]: Found 11 models, 11 sources, 423 macros
[0m02:18:57.429535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ca95d93-e190-4f4c-a486-8b993c95c48f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D18693E2D0>]}
[0m02:18:57.430492 [info ] [MainThread]: 
[0m02:18:57.431509 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:18:57.432508 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merchant_data'
[0m02:18:57.485617 [debug] [ThreadPool]: Using postgres connection "list_merchant_data"
[0m02:18:57.486622 [debug] [ThreadPool]: On list_merchant_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "list_merchant_data"} */

    select distinct nspname from pg_namespace
  
[0m02:18:57.486622 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:18:57.641283 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.155 seconds
[0m02:18:57.642266 [debug] [ThreadPool]: On list_merchant_data: Close
[0m02:18:57.646759 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merchant_data_public'
[0m02:18:57.651872 [debug] [ThreadPool]: Using postgres connection "list_merchant_data_public"
[0m02:18:57.651872 [debug] [ThreadPool]: On list_merchant_data_public: BEGIN
[0m02:18:57.651872 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:18:57.685815 [debug] [ThreadPool]: SQL status: BEGIN in 0.033 seconds
[0m02:18:57.685815 [debug] [ThreadPool]: Using postgres connection "list_merchant_data_public"
[0m02:18:57.685815 [debug] [ThreadPool]: On list_merchant_data_public: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "list_merchant_data_public"} */
select
      'merchant_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'merchant_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'merchant_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m02:18:57.692901 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.006 seconds
[0m02:18:57.692901 [debug] [ThreadPool]: On list_merchant_data_public: ROLLBACK
[0m02:18:57.694508 [debug] [ThreadPool]: On list_merchant_data_public: Close
[0m02:18:57.699493 [debug] [MainThread]: Using postgres connection "master"
[0m02:18:57.699493 [debug] [MainThread]: On master: BEGIN
[0m02:18:57.699493 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:18:57.733647 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m02:18:57.733647 [debug] [MainThread]: Using postgres connection "master"
[0m02:18:57.733647 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:18:57.742247 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m02:18:57.743355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ca95d93-e190-4f4c-a486-8b993c95c48f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D188EFA480>]}
[0m02:18:57.743355 [debug] [MainThread]: On master: ROLLBACK
[0m02:18:57.744243 [debug] [MainThread]: Using postgres connection "master"
[0m02:18:57.744850 [debug] [MainThread]: On master: BEGIN
[0m02:18:57.744850 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m02:18:57.745857 [debug] [MainThread]: On master: COMMIT
[0m02:18:57.745857 [debug] [MainThread]: Using postgres connection "master"
[0m02:18:57.745857 [debug] [MainThread]: On master: COMMIT
[0m02:18:57.746864 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:18:57.746864 [debug] [MainThread]: On master: Close
[0m02:18:57.746864 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:18:57.747866 [info ] [MainThread]: 
[0m02:18:57.752186 [debug] [Thread-1 (]: Began running node model.merchant_data_project.curated_merchant_data
[0m02:18:57.752186 [info ] [Thread-1 (]: 1 of 1 START sql view model public.curated_merchant_data ....................... [RUN]
[0m02:18:57.753186 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.merchant_data_project.curated_merchant_data'
[0m02:18:57.753186 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.curated_merchant_data
[0m02:18:57.763699 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.curated_merchant_data"
[0m02:18:57.765203 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.curated_merchant_data
[0m02:18:57.792803 [debug] [Thread-1 (]: Writing runtime sql for node "model.merchant_data_project.curated_merchant_data"
[0m02:18:57.795313 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.curated_merchant_data"
[0m02:18:57.796312 [debug] [Thread-1 (]: On model.merchant_data_project.curated_merchant_data: BEGIN
[0m02:18:57.796312 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:18:57.829673 [debug] [Thread-1 (]: SQL status: BEGIN in 0.033 seconds
[0m02:18:57.829673 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.curated_merchant_data"
[0m02:18:57.830673 [debug] [Thread-1 (]: On model.merchant_data_project.curated_merchant_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.curated_merchant_data"} */

  create view "merchant_data"."public"."curated_merchant_data__dbt_tmp"
    
    
  as (
    WITH merchant_signup AS (
    -- Define the 7, 30, 90, 180, 365 day periods after signup for each merchant
    SELECT
        merchant_id,
        sign_up_time,
        sign_up_time + INTERVAL '7 days' AS signup_plus_7_days,
        sign_up_time + INTERVAL '30 days' AS signup_plus_30_days,
        sign_up_time + INTERVAL '90 days' AS signup_plus_90_days,
        sign_up_time + INTERVAL '180 days' AS signup_plus_180_days,
        sign_up_time + INTERVAL '365 days' AS signup_plus_365_days
    FROM "merchant_data"."public"."merchants"
),

-- Checking the output of merchant signup information
-- select * from merchant_signup
successful_transactions AS (
    -- Get successful transactions per merchant
    SELECT
        t.merchant_id,
        t.server_time_created_at,
        row_number() OVER (PARTITION BY t.merchant_id ORDER BY t.server_time_created_at) AS transaction_rank
    FROM "merchant_data"."public"."transactions" t
    WHERE t.tx_result = 11  -- Only successful transactions
),

first_successful_transaction AS (
    -- Get first successful transaction date for each merchant
    SELECT
        st.merchant_id,
        min(st.server_time_created_at) AS first_successful_transaction_date
    FROM successful_transactions st
    WHERE st.transaction_rank = 1
    GROUP BY st.merchant_id
),

-- Checking the output of the first successful transaction
-- select * from first_successful_transaction

successful_card_present_transactions AS (
    SELECT
        t.merchant_id,
        t.server_time_created_at,
        row_number() OVER (PARTITION BY t.merchant_id ORDER BY t.server_time_created_at) AS transaction_rank
    FROM "merchant_data"."public"."transactions" t
    JOIN "merchant_data"."public"."payment_types" pt
        ON t.payment_type_code = pt.code  -- Joining ON the payment type code
    WHERE t.tx_result = 11  -- Successful transaction (tx_result = 11)
      AND NOT pt.code IN (1,8,9,12,14)  -- Card-not-present transaction codes and code 1 for Cash payment
),

first_card_present_transaction AS (
    -- Get first card-present transaction date for each merchant
    SELECT
        st.merchant_id,
        min(st.server_time_created_at) AS first_card_present_transaction_date
    FROM successful_card_present_transactions st
    WHERE st.transaction_rank = 1  -- Get the first card-present transaction
    GROUP BY st.merchant_id
),

-- Checking the output of the first card-present transaction
-- select * from first_card_present_transaction

fifth_successful_transaction AS (
    -- Get fifth successful transaction date for each merchant
    SELECT
        st.merchant_id,
        min(st.server_time_created_at) AS fifth_successful_transaction_date
    FROM successful_transactions st
    WHERE st.transaction_rank = 5
    GROUP BY st.merchant_id
),

-- Checking the output of the fifth successful transaction
-- select * from fifth_successful_transaction


last_successful_transaction AS (
    -- Get last successful transaction date for each merchant
    SELECT
        st.merchant_id,
        max(st.server_time_created_at) AS last_successful_transaction_date
    FROM successful_transactions st
    WHERE st.transaction_rank = 1
    GROUP BY st.merchant_id
),

-- Checking the output of the fifth successful transaction
-- select * from last_successful_transaction

all_time_successful_transactions AS (
    -- Get all time successful transaction for each merchant
   SELECT
        t.merchant_id,
        count(*) AS all_time_successful_transactions
    FROM "merchant_data"."public"."transactions" t
    WHERE t.tx_result = 11  -- Successful transaction (tx_result = 11)
    GROUP BY t.merchant_id
),

-- Checking the output of the all time successful transactions
-- select * from all_time_successful_transactions

all_time_failed_transactions AS (
    -- Get all time failed transaction for each merchant
   SELECT
        t.merchant_id,
        count(*) AS all_time_failed_transactions
    FROM "merchant_data"."public"."transactions" t
    WHERE t.tx_result != 11  -- failed transaction (tx_result != 11)
    GROUP BY t.merchant_id
),

-- Checking the output of the all time failed transactions
-- select * from all_time_failed_transactions

transactions_in_period AS (
    -- Join transactions WITH calculated periods, filtering by successful transactions within 365 days of signup
    SELECT
        m.merchant_id,
        t.amount,
        CASE
            WHEN t.server_time_created_at >= m.sign_up_time 
                 AND t.server_time_created_at < m.signup_plus_7_days THEN '7_day'
            WHEN t.server_time_created_at >= m.sign_up_time
                 AND t.server_time_created_at < m.signup_plus_30_days THEN '30_day'
            WHEN t.server_time_created_at >= m.sign_up_time
                 AND t.server_time_created_at < m.signup_plus_90_days THEN '90_day'
            WHEN t.server_time_created_at >= m.sign_up_time
                 AND t.server_time_created_at < m.signup_plus_180_days THEN '180_day'
            WHEN t.server_time_created_at >= m.sign_up_time
                 AND t.server_time_created_at < m.signup_plus_365_days THEN '365_day'
        END AS PERIOD
    FROM merchant_signup m
    JOIN "merchant_data"."public"."transactions" t
        ON m.merchant_id = t.merchant_id
    WHERE t.tx_result = 11  -- Only successful transactions
      AND t.server_time_created_at < m.signup_plus_365_days
),

tpv_summary AS (
    SELECT
        merchant_id,
        sum(CASE WHEN PERIOD = '7_day' THEN amount ELSE 0 END) AS tpv_7_day,
        sum(CASE WHEN PERIOD IN ('7_day', '30_day') THEN amount ELSE 0 END) AS tpv_30_day,
        sum(CASE WHEN PERIOD IN ('7_day', '30_day', '90_day') THEN amount ELSE 0 END) AS tpv_90_day,
        sum(CASE WHEN PERIOD IN ('7_day', '30_day','90_day','180_day') THEN amount ELSE 0 END) AS tpv_180_day,
        sum(CASE WHEN PERIOD IN ('7_day', '30_day','90_day','180_day','365_day') THEN amount ELSE 0 END) AS tpv_365_day
    FROM transactions_in_period
    WHERE PERIOD IS NOT NULL
    GROUP BY merchant_id
)

-- Final selection combining all computed metrics

SELECT
    ms.merchant_id,
    ms.sign_up_time,
    fst.first_successful_transaction_date,
    fcpt.first_card_present_transaction_date,
    fifth.fifth_successful_transaction_date,
    lst.last_successful_transaction_date,
    atst.all_time_successful_transactions,
    atft.all_time_failed_transactions,
    tpv.tpv_7_day,
    tpv.tpv_30_day,
    tpv.tpv_90_day,
    tpv.tpv_180_day,
    tpv.tpv_365_day

FROM merchant_signup ms
LEFT JOIN first_successful_transaction fst ON ms.merchant_id = fst.merchant_id
LEFT JOIN first_card_present_transaction fcpt ON ms.merchant_id = fcpt.merchant_id
LEFT JOIN fifth_successful_transaction fifth ON ms.merchant_id = fifth.merchant_id
LEFT JOIN last_successful_transaction lst ON ms.merchant_id = lst.merchant_id
LEFT JOIN all_time_successful_transactions atst ON ms.merchant_id = atst.merchant_id
LEFT JOIN all_time_failed_transactions atft ON ms.merchant_id = atft.merchant_id
LEFT JOIN tpv_summary tpv ON ms.merchant_id = tpv.merchant_id

ORDER BY fifth.fifth_successful_transaction_date NULLS LAST
  );
[0m02:18:57.840353 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m02:18:57.845025 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.curated_merchant_data"
[0m02:18:57.846032 [debug] [Thread-1 (]: On model.merchant_data_project.curated_merchant_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.curated_merchant_data"} */
alter table "merchant_data"."public"."curated_merchant_data__dbt_tmp" rename to "curated_merchant_data"
[0m02:18:57.847033 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:18:57.858384 [debug] [Thread-1 (]: On model.merchant_data_project.curated_merchant_data: COMMIT
[0m02:18:57.859333 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.curated_merchant_data"
[0m02:18:57.859333 [debug] [Thread-1 (]: On model.merchant_data_project.curated_merchant_data: COMMIT
[0m02:18:57.861482 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m02:18:57.865887 [debug] [Thread-1 (]: Applying DROP to: "merchant_data"."public"."curated_merchant_data__dbt_backup"
[0m02:18:57.869891 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.curated_merchant_data"
[0m02:18:57.869891 [debug] [Thread-1 (]: On model.merchant_data_project.curated_merchant_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.curated_merchant_data"} */
drop view if exists "merchant_data"."public"."curated_merchant_data__dbt_backup" cascade
[0m02:18:57.870936 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m02:18:57.871891 [debug] [Thread-1 (]: On model.merchant_data_project.curated_merchant_data: Close
[0m02:18:57.872891 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ca95d93-e190-4f4c-a486-8b993c95c48f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D184D2C800>]}
[0m02:18:57.874479 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.curated_merchant_data .................. [[32mCREATE VIEW[0m in 0.12s]
[0m02:18:57.875401 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.curated_merchant_data
[0m02:18:57.877403 [debug] [MainThread]: Using postgres connection "master"
[0m02:18:57.877403 [debug] [MainThread]: On master: BEGIN
[0m02:18:57.877403 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:18:58.017548 [debug] [MainThread]: SQL status: BEGIN in 0.140 seconds
[0m02:18:58.018636 [debug] [MainThread]: On master: COMMIT
[0m02:18:58.018636 [debug] [MainThread]: Using postgres connection "master"
[0m02:18:58.018636 [debug] [MainThread]: On master: COMMIT
[0m02:18:58.019553 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:18:58.019553 [debug] [MainThread]: On master: Close
[0m02:18:58.019553 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:18:58.019553 [debug] [MainThread]: Connection 'list_merchant_data' was properly closed.
[0m02:18:58.020556 [debug] [MainThread]: Connection 'list_merchant_data_public' was properly closed.
[0m02:18:58.020556 [debug] [MainThread]: Connection 'model.merchant_data_project.curated_merchant_data' was properly closed.
[0m02:18:58.020556 [info ] [MainThread]: 
[0m02:18:58.021557 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m02:18:58.021557 [debug] [MainThread]: Command end result
[0m02:18:58.057299 [info ] [MainThread]: 
[0m02:18:58.058305 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:18:58.058305 [info ] [MainThread]: 
[0m02:18:58.059304 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:18:58.060306 [debug] [MainThread]: Command `dbt run` succeeded at 02:18:58.060306 after 2.83 seconds
[0m02:18:58.061413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D18827F7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D18406B860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1883A1190>]}
[0m02:18:58.061413 [debug] [MainThread]: Flushing usage events
[0m02:19:40.546547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209B7E44EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209B3C71100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209B7269730>]}


============================== 02:19:40.550519 | 23c785cd-b4c4-4df4-bf0f-8197130d908d ==============================
[0m02:19:40.550519 [info ] [MainThread]: Running with dbt=1.8.8
[0m02:19:40.550519 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alvaro\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\alvaro\\Desktop\\sumup_assignment\\merchant_data_project\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select curated_merchant_data', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:19:40.714908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '23c785cd-b4c4-4df4-bf0f-8197130d908d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209B7FED7F0>]}
[0m02:19:40.760733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '23c785cd-b4c4-4df4-bf0f-8197130d908d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209B80C4CE0>]}
[0m02:19:40.761619 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m02:19:40.769620 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m02:19:40.836421 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m02:19:40.837421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '23c785cd-b4c4-4df4-bf0f-8197130d908d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209B86FE9F0>]}
[0m02:19:41.715891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '23c785cd-b4c4-4df4-bf0f-8197130d908d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209B8A30230>]}
[0m02:19:41.794376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '23c785cd-b4c4-4df4-bf0f-8197130d908d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209B86918E0>]}
[0m02:19:41.795374 [info ] [MainThread]: Found 11 models, 11 sources, 423 macros
[0m02:19:41.796385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23c785cd-b4c4-4df4-bf0f-8197130d908d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209B8BAC770>]}
[0m02:19:41.797372 [info ] [MainThread]: 
[0m02:19:41.798423 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:19:41.799372 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merchant_data'
[0m02:19:41.890623 [debug] [ThreadPool]: Using postgres connection "list_merchant_data"
[0m02:19:41.890623 [debug] [ThreadPool]: On list_merchant_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "list_merchant_data"} */

    select distinct nspname from pg_namespace
  
[0m02:19:41.890623 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:19:41.928429 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.038 seconds
[0m02:19:41.929500 [debug] [ThreadPool]: On list_merchant_data: Close
[0m02:19:41.933947 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merchant_data_public'
[0m02:19:41.938944 [debug] [ThreadPool]: Using postgres connection "list_merchant_data_public"
[0m02:19:41.938944 [debug] [ThreadPool]: On list_merchant_data_public: BEGIN
[0m02:19:41.938944 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:19:42.088411 [debug] [ThreadPool]: SQL status: BEGIN in 0.149 seconds
[0m02:19:42.088411 [debug] [ThreadPool]: Using postgres connection "list_merchant_data_public"
[0m02:19:42.088411 [debug] [ThreadPool]: On list_merchant_data_public: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "list_merchant_data_public"} */
select
      'merchant_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'merchant_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'merchant_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m02:19:42.094509 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.006 seconds
[0m02:19:42.095561 [debug] [ThreadPool]: On list_merchant_data_public: ROLLBACK
[0m02:19:42.096612 [debug] [ThreadPool]: On list_merchant_data_public: Close
[0m02:19:42.102012 [debug] [MainThread]: Using postgres connection "master"
[0m02:19:42.102012 [debug] [MainThread]: On master: BEGIN
[0m02:19:42.102012 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:19:42.135090 [debug] [MainThread]: SQL status: BEGIN in 0.032 seconds
[0m02:19:42.135090 [debug] [MainThread]: Using postgres connection "master"
[0m02:19:42.136096 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:19:42.143699 [debug] [MainThread]: SQL status: SELECT 3 in 0.008 seconds
[0m02:19:42.145596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23c785cd-b4c4-4df4-bf0f-8197130d908d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209B8A302F0>]}
[0m02:19:42.145596 [debug] [MainThread]: On master: ROLLBACK
[0m02:19:42.146597 [debug] [MainThread]: Using postgres connection "master"
[0m02:19:42.146597 [debug] [MainThread]: On master: BEGIN
[0m02:19:42.147597 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m02:19:42.147597 [debug] [MainThread]: On master: COMMIT
[0m02:19:42.147597 [debug] [MainThread]: Using postgres connection "master"
[0m02:19:42.147597 [debug] [MainThread]: On master: COMMIT
[0m02:19:42.148597 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:19:42.148597 [debug] [MainThread]: On master: Close
[0m02:19:42.148597 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:19:42.149598 [info ] [MainThread]: 
[0m02:19:42.153094 [debug] [Thread-1 (]: Began running node model.merchant_data_project.curated_merchant_data
[0m02:19:42.153094 [info ] [Thread-1 (]: 1 of 1 START sql table model public.curated_merchant_data ...................... [RUN]
[0m02:19:42.154094 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.merchant_data_project.curated_merchant_data'
[0m02:19:42.155091 [debug] [Thread-1 (]: Began compiling node model.merchant_data_project.curated_merchant_data
[0m02:19:42.162609 [debug] [Thread-1 (]: Writing injected SQL for node "model.merchant_data_project.curated_merchant_data"
[0m02:19:42.163707 [debug] [Thread-1 (]: Began executing node model.merchant_data_project.curated_merchant_data
[0m02:19:42.195737 [debug] [Thread-1 (]: Writing runtime sql for node "model.merchant_data_project.curated_merchant_data"
[0m02:19:42.196716 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.curated_merchant_data"
[0m02:19:42.197624 [debug] [Thread-1 (]: On model.merchant_data_project.curated_merchant_data: BEGIN
[0m02:19:42.197624 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:19:42.229315 [debug] [Thread-1 (]: SQL status: BEGIN in 0.032 seconds
[0m02:19:42.229315 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.curated_merchant_data"
[0m02:19:42.230908 [debug] [Thread-1 (]: On model.merchant_data_project.curated_merchant_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.curated_merchant_data"} */

  
    

  create  table "merchant_data"."public"."curated_merchant_data__dbt_tmp"
  
  
    as
  
  (
    WITH merchant_signup AS (
    -- Define the 7, 30, 90, 180, 365 day periods after signup for each merchant
    SELECT
        merchant_id,
        sign_up_time,
        sign_up_time + INTERVAL '7 days' AS signup_plus_7_days,
        sign_up_time + INTERVAL '30 days' AS signup_plus_30_days,
        sign_up_time + INTERVAL '90 days' AS signup_plus_90_days,
        sign_up_time + INTERVAL '180 days' AS signup_plus_180_days,
        sign_up_time + INTERVAL '365 days' AS signup_plus_365_days
    FROM "merchant_data"."public"."merchants"
),

-- Checking the output of merchant signup information
-- select * from merchant_signup
successful_transactions AS (
    -- Get successful transactions per merchant
    SELECT
        t.merchant_id,
        t.server_time_created_at,
        row_number() OVER (PARTITION BY t.merchant_id ORDER BY t.server_time_created_at) AS transaction_rank
    FROM "merchant_data"."public"."transactions" t
    WHERE t.tx_result = 11  -- Only successful transactions
),

first_successful_transaction AS (
    -- Get first successful transaction date for each merchant
    SELECT
        st.merchant_id,
        min(st.server_time_created_at) AS first_successful_transaction_date
    FROM successful_transactions st
    WHERE st.transaction_rank = 1
    GROUP BY st.merchant_id
),

-- Checking the output of the first successful transaction
-- select * from first_successful_transaction

successful_card_present_transactions AS (
    SELECT
        t.merchant_id,
        t.server_time_created_at,
        row_number() OVER (PARTITION BY t.merchant_id ORDER BY t.server_time_created_at) AS transaction_rank
    FROM "merchant_data"."public"."transactions" t
    JOIN "merchant_data"."public"."payment_types" pt
        ON t.payment_type_code = pt.code  -- Joining ON the payment type code
    WHERE t.tx_result = 11  -- Successful transaction (tx_result = 11)
      AND NOT pt.code IN (1,8,9,12,14)  -- Card-not-present transaction codes and code 1 for Cash payment
),

first_card_present_transaction AS (
    -- Get first card-present transaction date for each merchant
    SELECT
        st.merchant_id,
        min(st.server_time_created_at) AS first_card_present_transaction_date
    FROM successful_card_present_transactions st
    WHERE st.transaction_rank = 1  -- Get the first card-present transaction
    GROUP BY st.merchant_id
),

-- Checking the output of the first card-present transaction
-- select * from first_card_present_transaction

fifth_successful_transaction AS (
    -- Get fifth successful transaction date for each merchant
    SELECT
        st.merchant_id,
        min(st.server_time_created_at) AS fifth_successful_transaction_date
    FROM successful_transactions st
    WHERE st.transaction_rank = 5
    GROUP BY st.merchant_id
),

-- Checking the output of the fifth successful transaction
-- select * from fifth_successful_transaction


last_successful_transaction AS (
    -- Get last successful transaction date for each merchant
    SELECT
        st.merchant_id,
        max(st.server_time_created_at) AS last_successful_transaction_date
    FROM successful_transactions st
    WHERE st.transaction_rank = 1
    GROUP BY st.merchant_id
),

-- Checking the output of the fifth successful transaction
-- select * from last_successful_transaction

all_time_successful_transactions AS (
    -- Get all time successful transaction for each merchant
   SELECT
        t.merchant_id,
        count(*) AS all_time_successful_transactions
    FROM "merchant_data"."public"."transactions" t
    WHERE t.tx_result = 11  -- Successful transaction (tx_result = 11)
    GROUP BY t.merchant_id
),

-- Checking the output of the all time successful transactions
-- select * from all_time_successful_transactions

all_time_failed_transactions AS (
    -- Get all time failed transaction for each merchant
   SELECT
        t.merchant_id,
        count(*) AS all_time_failed_transactions
    FROM "merchant_data"."public"."transactions" t
    WHERE t.tx_result != 11  -- failed transaction (tx_result != 11)
    GROUP BY t.merchant_id
),

-- Checking the output of the all time failed transactions
-- select * from all_time_failed_transactions

transactions_in_period AS (
    -- Join transactions WITH calculated periods, filtering by successful transactions within 365 days of signup
    SELECT
        m.merchant_id,
        t.amount,
        CASE
            WHEN t.server_time_created_at >= m.sign_up_time 
                 AND t.server_time_created_at < m.signup_plus_7_days THEN '7_day'
            WHEN t.server_time_created_at >= m.sign_up_time
                 AND t.server_time_created_at < m.signup_plus_30_days THEN '30_day'
            WHEN t.server_time_created_at >= m.sign_up_time
                 AND t.server_time_created_at < m.signup_plus_90_days THEN '90_day'
            WHEN t.server_time_created_at >= m.sign_up_time
                 AND t.server_time_created_at < m.signup_plus_180_days THEN '180_day'
            WHEN t.server_time_created_at >= m.sign_up_time
                 AND t.server_time_created_at < m.signup_plus_365_days THEN '365_day'
        END AS PERIOD
    FROM merchant_signup m
    JOIN "merchant_data"."public"."transactions" t
        ON m.merchant_id = t.merchant_id
    WHERE t.tx_result = 11  -- Only successful transactions
      AND t.server_time_created_at < m.signup_plus_365_days
),

tpv_summary AS (
    SELECT
        merchant_id,
        sum(CASE WHEN PERIOD = '7_day' THEN amount ELSE 0 END) AS tpv_7_day,
        sum(CASE WHEN PERIOD IN ('7_day', '30_day') THEN amount ELSE 0 END) AS tpv_30_day,
        sum(CASE WHEN PERIOD IN ('7_day', '30_day', '90_day') THEN amount ELSE 0 END) AS tpv_90_day,
        sum(CASE WHEN PERIOD IN ('7_day', '30_day','90_day','180_day') THEN amount ELSE 0 END) AS tpv_180_day,
        sum(CASE WHEN PERIOD IN ('7_day', '30_day','90_day','180_day','365_day') THEN amount ELSE 0 END) AS tpv_365_day
    FROM transactions_in_period
    WHERE PERIOD IS NOT NULL
    GROUP BY merchant_id
)

-- Final selection combining all computed metrics

SELECT
    ms.merchant_id,
    ms.sign_up_time,
    fst.first_successful_transaction_date,
    fcpt.first_card_present_transaction_date,
    fifth.fifth_successful_transaction_date,
    lst.last_successful_transaction_date,
    atst.all_time_successful_transactions,
    atft.all_time_failed_transactions,
    tpv.tpv_7_day,
    tpv.tpv_30_day,
    tpv.tpv_90_day,
    tpv.tpv_180_day,
    tpv.tpv_365_day

FROM merchant_signup ms
LEFT JOIN first_successful_transaction fst ON ms.merchant_id = fst.merchant_id
LEFT JOIN first_card_present_transaction fcpt ON ms.merchant_id = fcpt.merchant_id
LEFT JOIN fifth_successful_transaction fifth ON ms.merchant_id = fifth.merchant_id
LEFT JOIN last_successful_transaction lst ON ms.merchant_id = lst.merchant_id
LEFT JOIN all_time_successful_transactions atst ON ms.merchant_id = atst.merchant_id
LEFT JOIN all_time_failed_transactions atft ON ms.merchant_id = atft.merchant_id
LEFT JOIN tpv_summary tpv ON ms.merchant_id = tpv.merchant_id

ORDER BY fifth.fifth_successful_transaction_date NULLS LAST
  );
  
[0m02:19:42.261520 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.031 seconds
[0m02:19:42.267597 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.curated_merchant_data"
[0m02:19:42.267597 [debug] [Thread-1 (]: On model.merchant_data_project.curated_merchant_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.curated_merchant_data"} */
alter table "merchant_data"."public"."curated_merchant_data" rename to "curated_merchant_data__dbt_backup"
[0m02:19:42.269515 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:19:42.271671 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.curated_merchant_data"
[0m02:19:42.271671 [debug] [Thread-1 (]: On model.merchant_data_project.curated_merchant_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.curated_merchant_data"} */
alter table "merchant_data"."public"."curated_merchant_data__dbt_tmp" rename to "curated_merchant_data"
[0m02:19:42.273673 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:19:42.288383 [debug] [Thread-1 (]: On model.merchant_data_project.curated_merchant_data: COMMIT
[0m02:19:42.288383 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.curated_merchant_data"
[0m02:19:42.289385 [debug] [Thread-1 (]: On model.merchant_data_project.curated_merchant_data: COMMIT
[0m02:19:42.291458 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m02:19:42.295551 [debug] [Thread-1 (]: Applying DROP to: "merchant_data"."public"."curated_merchant_data__dbt_backup"
[0m02:19:42.300962 [debug] [Thread-1 (]: Using postgres connection "model.merchant_data_project.curated_merchant_data"
[0m02:19:42.301968 [debug] [Thread-1 (]: On model.merchant_data_project.curated_merchant_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "merchant_data_project", "target_name": "dev", "node_id": "model.merchant_data_project.curated_merchant_data"} */
drop view if exists "merchant_data"."public"."curated_merchant_data__dbt_backup" cascade
[0m02:19:42.305387 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m02:19:42.308396 [debug] [Thread-1 (]: On model.merchant_data_project.curated_merchant_data: Close
[0m02:19:42.310903 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23c785cd-b4c4-4df4-bf0f-8197130d908d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209B80C6EA0>]}
[0m02:19:42.310903 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.curated_merchant_data ................. [[32mSELECT 1000[0m in 0.16s]
[0m02:19:42.311908 [debug] [Thread-1 (]: Finished running node model.merchant_data_project.curated_merchant_data
[0m02:19:42.313914 [debug] [MainThread]: Using postgres connection "master"
[0m02:19:42.313914 [debug] [MainThread]: On master: BEGIN
[0m02:19:42.314915 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:19:42.350399 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m02:19:42.350399 [debug] [MainThread]: On master: COMMIT
[0m02:19:42.350399 [debug] [MainThread]: Using postgres connection "master"
[0m02:19:42.350399 [debug] [MainThread]: On master: COMMIT
[0m02:19:42.351406 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:19:42.351406 [debug] [MainThread]: On master: Close
[0m02:19:42.352409 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:19:42.352409 [debug] [MainThread]: Connection 'list_merchant_data' was properly closed.
[0m02:19:42.352409 [debug] [MainThread]: Connection 'list_merchant_data_public' was properly closed.
[0m02:19:42.353408 [debug] [MainThread]: Connection 'model.merchant_data_project.curated_merchant_data' was properly closed.
[0m02:19:42.353408 [info ] [MainThread]: 
[0m02:19:42.354405 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m02:19:42.355424 [debug] [MainThread]: Command end result
[0m02:19:42.390431 [info ] [MainThread]: 
[0m02:19:42.391437 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:19:42.392437 [info ] [MainThread]: 
[0m02:19:42.392437 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:19:42.394443 [debug] [MainThread]: Command `dbt run` succeeded at 02:19:42.393438 after 1.94 seconds
[0m02:19:42.394443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209B7E7D8B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209B8720B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209B7E44EC0>]}
[0m02:19:42.394443 [debug] [MainThread]: Flushing usage events
[0m14:54:39.955211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002700F1FAC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027011ED03B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027011ED0E00>]}


============================== 14:54:39.969532 | 40e44f7c-1e91-4c25-9db0-3574007b90e6 ==============================
[0m14:54:39.969532 [info ] [MainThread]: Running with dbt=1.8.8
[0m14:54:39.970503 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alvaro\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\alvaro\\Desktop\\sumup_assignment\\merchant_data_project\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:54:40.228156 [info ] [MainThread]: dbt version: 1.8.8
[0m14:54:40.229157 [info ] [MainThread]: python version: 3.12.7
[0m14:54:40.230157 [info ] [MainThread]: python path: C:\Users\alvaro\Desktop\sumup_assignment\dbt-sumup\Scripts\python.exe
[0m14:54:40.230157 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m14:54:40.605973 [info ] [MainThread]: Using profiles dir at C:\Users\alvaro\.dbt
[0m14:54:40.605973 [info ] [MainThread]: Using profiles.yml file at C:\Users\alvaro\.dbt\profiles.yml
[0m14:54:40.606985 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\alvaro\Desktop\sumup_assignment\merchant_data_project\dbt_project.yml
[0m14:54:40.614974 [info ] [MainThread]: adapter type: postgres
[0m14:54:40.614974 [info ] [MainThread]: adapter version: 1.8.2
[0m14:54:40.724417 [info ] [MainThread]: Configuration:
[0m14:54:40.725433 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:54:40.726428 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:54:40.727417 [info ] [MainThread]: Required dependencies:
[0m14:54:40.727417 [debug] [MainThread]: Executing "git --help"
[0m14:54:40.765169 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:54:40.766171 [debug] [MainThread]: STDERR: "b''"
[0m14:54:40.766171 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:54:40.767170 [info ] [MainThread]: Connection:
[0m14:54:40.768173 [info ] [MainThread]:   host: localhost
[0m14:54:40.768173 [info ] [MainThread]:   port: 5432
[0m14:54:40.769448 [info ] [MainThread]:   user: postgres
[0m14:54:40.770455 [info ] [MainThread]:   database: merchant_data
[0m14:54:40.770455 [info ] [MainThread]:   schema: public
[0m14:54:40.771457 [info ] [MainThread]:   connect_timeout: 10
[0m14:54:40.771457 [info ] [MainThread]:   role: None
[0m14:54:40.772456 [info ] [MainThread]:   search_path: None
[0m14:54:40.773457 [info ] [MainThread]:   keepalives_idle: 0
[0m14:54:40.774457 [info ] [MainThread]:   sslmode: None
[0m14:54:40.774457 [info ] [MainThread]:   sslcert: None
[0m14:54:40.775457 [info ] [MainThread]:   sslkey: None
[0m14:54:40.776458 [info ] [MainThread]:   sslrootcert: None
[0m14:54:40.776458 [info ] [MainThread]:   application_name: dbt
[0m14:54:40.777458 [info ] [MainThread]:   retries: 1
[0m14:54:40.778456 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:54:40.778456 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:54:43.677111 [debug] [MainThread]: Using postgres connection "debug"
[0m14:54:43.677111 [debug] [MainThread]: On debug: select 1 as id
[0m14:54:43.677111 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:54:43.828073 [debug] [MainThread]: SQL status: SELECT 1 in 0.151 seconds
[0m14:54:43.830057 [debug] [MainThread]: On debug: Close
[0m14:54:43.830057 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:54:43.831057 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:54:43.832108 [debug] [MainThread]: Command `dbt debug` succeeded at 14:54:43.832108 after 4.01 seconds
[0m14:54:43.833142 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:54:43.833142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270128F3EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027011C24C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002700FAE62A0>]}
[0m14:54:43.834076 [debug] [MainThread]: Flushing usage events
